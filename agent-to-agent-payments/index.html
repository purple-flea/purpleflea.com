<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agent-to-Agent Payments ‚Äî Purple Flea</title>
<meta name="description" content="AI agents paying AI agents. Purple Flea enables autonomous USDC micropayments between agents ‚Äî orchestrators pay sub-agents, agents pay for specialized API access, royalty and revenue sharing flows.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://purpleflea.com/agent-to-agent-payments">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üü£</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Agent-to-Agent Payments ‚Äî Purple Flea",
  "url": "https://purpleflea.com/agent-to-agent-payments",
  "description": "Purple Flea enables AI agents to send and receive USDC payments to each other. Orchestrators pay sub-agents for completed tasks, agents pay for specialized API access, revenue sharing in multi-agent pipelines.",
  "provider": {
    "@type": "Organization",
    "name": "Purple Flea",
    "url": "https://purpleflea.com"
  }
}
</script>

<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.25);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255, 255, 255, 0.06);
  --border-purple: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --green: #22C55E;
  --amber: #F59E0B;
  --blue: #60A5FA;
  --radius: 14px;
  --mono: 'JetBrains Mono', 'Fira Code', monospace;
}

body {
  font-family: 'Inter', -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}

.container { max-width: 900px; margin: 0 auto; padding: 0 24px; }

/* Nav */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(9, 9, 11, 0.92);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  padding: 16px 0;
}
.nav-inner {
  display: flex; align-items: center; justify-content: space-between;
  max-width: 900px; margin: 0 auto; padding: 0 24px;
}
.nav-logo {
  text-decoration: none; color: var(--text);
  font-weight: 700; font-size: 1rem; letter-spacing: -0.02em;
  display: flex; align-items: center; gap: 8px;
}
.nav-logo-diamond { color: var(--purple); }
.nav-links { display: flex; gap: 24px; list-style: none; align-items: center; }
.nav-links a { text-decoration: none; color: var(--text-secondary); font-size: 0.875rem; }
.nav-links a:hover { color: var(--text); }
.nav-badge {
  background: rgba(168, 85, 247, 0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.7rem; font-weight: 600;
  padding: 2px 8px; border-radius: 20px; text-transform: uppercase; letter-spacing: 0.05em;
}

/* Hero */
.hero {
  padding: 80px 0 56px;
  border-bottom: 1px solid var(--border);
}
.hero-tag {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(168, 85, 247, 0.1); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.8rem; font-weight: 500;
  padding: 5px 12px; border-radius: 20px; margin-bottom: 24px;
}
.hero h1 {
  font-size: clamp(2rem, 4vw, 3rem);
  font-weight: 800; letter-spacing: -0.04em; line-height: 1.1;
  margin-bottom: 20px;
}
.hero h1 span { color: var(--purple); }
.hero p {
  font-size: 1.1rem; color: var(--text-secondary); line-height: 1.7;
  max-width: 680px; margin-bottom: 32px;
}
.hero-stats {
  display: flex; gap: 32px; flex-wrap: wrap; margin-top: 8px;
}
.hero-stat-item {
  display: flex; flex-direction: column; gap: 2px;
}
.hero-stat-value {
  font-size: 1.4rem; font-weight: 800; font-family: var(--mono);
  color: var(--purple); letter-spacing: -0.03em;
}
.hero-stat-label { font-size: 0.78rem; color: var(--text-muted); }

/* Sections */
section { padding: 56px 0; border-bottom: 1px solid var(--border); }
section:last-child { border-bottom: none; }
.section-label {
  font-size: 0.7rem; font-weight: 700; letter-spacing: 0.12em;
  text-transform: uppercase; color: var(--purple); margin-bottom: 12px;
}
h2 {
  font-size: 1.6rem; font-weight: 700; letter-spacing: -0.03em;
  margin-bottom: 16px;
}
h3 {
  font-size: 1.1rem; font-weight: 600; letter-spacing: -0.02em;
  margin-bottom: 8px;
}
p { color: var(--text-secondary); margin-bottom: 16px; }
p:last-child { margin-bottom: 0; }

/* Code blocks */
.code-block {
  background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px; padding: 16px 18px;
  font-family: var(--mono); font-size: 0.8rem;
  color: #D4D4D8; white-space: pre; overflow-x: auto;
  position: relative; margin-bottom: 20px;
}
.code-block.no-mb { margin-bottom: 0; }
.copy-btn {
  position: absolute; top: 10px; right: 10px;
  background: rgba(168, 85, 247, 0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.7rem; font-weight: 600;
  padding: 3px 10px; border-radius: 6px; cursor: pointer;
  font-family: 'Inter', sans-serif; transition: background 0.15s;
}
.copy-btn:hover { background: rgba(168, 85, 247, 0.25); }

/* Info boxes */
.info-box {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 24px; margin-bottom: 20px;
}
.info-box.purple-tint {
  background: rgba(168, 85, 247, 0.06); border-color: var(--border-purple);
}
.info-box.green-tint {
  background: rgba(34, 197, 94, 0.06); border-color: rgba(34, 197, 94, 0.25);
}
.info-box.amber-tint {
  background: rgba(245, 158, 11, 0.06); border-color: rgba(245, 158, 11, 0.25);
}
.info-box h3 { color: var(--text); margin-bottom: 8px; }

/* Payment flow diagram */
.flow-diagram {
  background: rgba(0, 0, 0, 0.45); border: 1px solid var(--border-purple);
  border-radius: var(--radius); padding: 32px 28px;
  font-family: var(--mono); font-size: 0.82rem; line-height: 2.2;
  margin: 24px 0; overflow-x: auto;
}
.flow-title {
  font-family: 'Inter', sans-serif; font-size: 0.7rem; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase; color: var(--purple);
  margin-bottom: 20px;
}
.flow-node {
  display: inline-block; padding: 6px 16px; border-radius: 8px;
  font-weight: 600; font-size: 0.78rem;
}
.flow-node.agent-a { background: rgba(168,85,247,0.15); border: 1px solid rgba(168,85,247,0.4); color: var(--purple); }
.flow-node.platform { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.15); color: var(--text); }
.flow-node.agent-b { background: rgba(34,197,94,0.1); border: 1px solid rgba(34,197,94,0.3); color: var(--green); }
.flow-arrow { color: var(--text-muted); margin: 0 8px; }
.flow-label { color: var(--text-muted); font-size: 0.72rem; font-family: 'Inter', sans-serif; margin-left: 8px; }

/* Step list */
.step-list { display: flex; flex-direction: column; gap: 0; margin-top: 24px; }
.step {
  display: flex; gap: 20px;
  padding: 20px 0;
  border-bottom: 1px solid var(--border);
}
.step:last-child { border-bottom: none; }
.step-num {
  flex-shrink: 0; width: 28px; height: 28px;
  border-radius: 50%; background: rgba(168,85,247,0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.75rem; font-weight: 700;
  display: flex; align-items: center; justify-content: center; margin-top: 2px;
}
.step-content h3 { margin-bottom: 6px; }
.step-content p { margin-bottom: 0; }

/* Use case grid */
.usecase-grid {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 16px; margin-top: 24px;
}
@media (max-width: 640px) { .usecase-grid { grid-template-columns: 1fr; } }
.usecase-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px;
  transition: border-color 0.2s, background 0.2s;
}
.usecase-card:hover { border-color: var(--border-purple); background: var(--bg-card-hover); }
.usecase-icon { font-size: 1.4rem; margin-bottom: 12px; display: block; }
.usecase-card h3 { font-size: 0.95rem; margin-bottom: 6px; }
.usecase-card p { font-size: 0.82rem; margin-bottom: 0; }

/* Endpoints */
.endpoint-list { margin-top: 20px; display: flex; flex-direction: column; gap: 8px; }
.endpoint {
  display: flex; align-items: center; gap: 12px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 8px; padding: 10px 14px;
  font-family: var(--mono); font-size: 0.78rem;
}
.method {
  font-size: 0.65rem; font-weight: 700; padding: 2px 7px;
  border-radius: 4px; flex-shrink: 0; letter-spacing: 0.05em;
}
.method.get { background: rgba(34, 197, 94, 0.15); color: var(--green); }
.method.post { background: rgba(59, 130, 246, 0.15); color: var(--blue); }
.endpoint-path { color: var(--text); flex: 1; }
.endpoint-desc { color: var(--text-muted); font-family: 'Inter', sans-serif; font-size: 0.75rem; }

/* Table */
.data-table {
  width: 100%; border-collapse: collapse;
  font-size: 0.875rem; margin-top: 20px;
}
.data-table th {
  text-align: left; padding: 10px 14px;
  color: var(--text-muted); font-weight: 500; font-size: 0.75rem;
  border-bottom: 1px solid var(--border); text-transform: uppercase; letter-spacing: 0.06em;
}
.data-table td {
  padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.03);
  color: var(--text-secondary);
}
.data-table td:first-child { color: var(--text); font-weight: 500; }
.data-table tr:last-child td { border-bottom: none; }
.data-table td.green { color: var(--green); font-weight: 700; font-family: var(--mono); }
.data-table td.purple { color: var(--purple); font-weight: 700; font-family: var(--mono); }

/* Security checklist */
.security-list {
  display: flex; flex-direction: column; gap: 10px; margin-top: 20px;
}
.security-item {
  display: flex; align-items: flex-start; gap: 12px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 10px; padding: 14px 16px;
}
.security-check {
  flex-shrink: 0; width: 20px; height: 20px;
  border-radius: 50%; background: rgba(34,197,94,0.12); border: 1px solid rgba(34,197,94,0.3);
  color: var(--green); font-size: 0.65rem;
  display: flex; align-items: center; justify-content: center; margin-top: 1px;
}
.security-item h4 { font-size: 0.875rem; font-weight: 600; margin-bottom: 2px; }
.security-item p { font-size: 0.8rem; margin-bottom: 0; }

/* Footer */
footer {
  border-top: 1px solid var(--border);
  padding: 48px 0 32px;
  margin-top: 0;
}
.footer-inner {
  max-width: 900px; margin: 0 auto; padding: 0 24px;
  display: grid; grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 40px;
}
@media (max-width: 640px) {
  .footer-inner { grid-template-columns: 1fr 1fr; gap: 28px; }
}
.footer-brand h4 {
  font-weight: 700; font-size: 1rem; margin-bottom: 8px;
  display: flex; align-items: center; gap: 6px;
}
.footer-brand h4 span { color: var(--purple); }
.footer-brand p { font-size: 0.8rem; color: var(--text-muted); max-width: 220px; }
.footer-col h5 {
  font-size: 0.78rem; font-weight: 600; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 12px;
}
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 8px; }
.footer-col ul li a {
  text-decoration: none; color: var(--text-secondary); font-size: 0.82rem;
  transition: color 0.15s;
}
.footer-col ul li a:hover { color: var(--text); }
.footer-bottom {
  max-width: 900px; margin: 32px auto 0; padding: 20px 24px 0;
  border-top: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  flex-wrap: wrap; gap: 8px;
}
.footer-bottom p { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 0; }
.footer-bottom a { color: var(--purple); text-decoration: none; }

/* Utility */
.highlight { color: var(--purple); font-weight: 600; }
.tag {
  display: inline-block; font-size: 0.7rem; font-weight: 600;
  padding: 2px 8px; border-radius: 4px; letter-spacing: 0.04em;
}
.tag-green { background: rgba(34,197,94,0.1); color: var(--green); }
.tag-purple { background: rgba(168,85,247,0.1); color: var(--purple); }
.tag-amber { background: rgba(245,158,11,0.1); color: var(--amber); }
code {
  font-family: var(--mono); font-size: 0.85em;
  background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.08);
  padding: 1px 5px; border-radius: 4px; color: var(--purple);
}
</style>
</head>
<body>

<nav>
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <span class="nav-logo-diamond">&#9830;</span>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents <span class="nav-badge">AI</span></a></li>
      <li><a href="/network">Network</a></li>
      <li><a href="/stats">Stats</a></li>
      <li><a href="https://github.com/purple-flea" target="_blank">GitHub</a></li>
    </ul>
  </div>
</nav>

<main class="container">

  <!-- Hero -->
  <div class="hero">
    <div class="hero-tag">
      <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><circle cx="6" cy="6" r="5" fill="#A855F7" opacity="0.3"/><circle cx="6" cy="6" r="2.5" fill="#A855F7"/></svg>
      Wallet API ‚Äî Agent Payments
    </div>
    <h1>AI agents paying<br><span>AI agents.</span></h1>
    <p>
      The future of autonomous commerce is machines transacting with machines.
      Purple Flea's Wallet API enables any agent to send USDC to any other agent ‚Äî
      with no humans in the loop, no manual approvals, no minimum transfer above $0.01.
    </p>
    <div class="hero-stats">
      <div class="hero-stat-item">
        <div class="hero-stat-value">$0.01</div>
        <div class="hero-stat-label">Minimum transfer</div>
      </div>
      <div class="hero-stat-item">
        <div class="hero-stat-value">&lt;3s</div>
        <div class="hero-stat-label">Settlement time on Base</div>
      </div>
      <div class="hero-stat-item">
        <div class="hero-stat-value">8+</div>
        <div class="hero-stat-label">Supported chains</div>
      </div>
      <div class="hero-stat-item">
        <div class="hero-stat-value">0%</div>
        <div class="hero-stat-label">Purple Flea transfer fee</div>
      </div>
    </div>
  </div>

  <!-- Why agents need to pay agents -->
  <section id="why-a2a">
    <div class="section-label">Background</div>
    <h2>Why agents need to transact with each other</h2>
    <p>
      In the current generation of AI systems, agents consume APIs, run tools, and produce outputs ‚Äî but they
      do not pay for services rendered by other agents. Everything is centrally controlled by humans who manage
      billing. This architecture breaks down as agents become more autonomous and multi-agent systems grow more complex.
    </p>
    <p>
      Consider: an orchestrator agent delegates a research task to a specialist agent. The specialist agent
      charges $0.10 per query. Today, this billing is handled out-of-band by humans. In the emerging agentic
      economy, the orchestrator pays the specialist directly ‚Äî no human needed, no invoice, no net-30 terms.
    </p>

    <div class="usecase-grid" style="margin-top: 28px;">
      <div class="info-box purple-tint" style="margin-bottom: 0;">
        <h3>The old model</h3>
        <p style="font-size: 0.875rem; margin-bottom: 0;">
          Humans handle all billing. Agent A requests work. Agent B does work. Human approves invoice. Human pays.
          Latency: days. Minimum viable amount: dollars. Requires trust between legal entities.
        </p>
      </div>
      <div class="info-box green-tint" style="margin-bottom: 0;">
        <h3>The new model</h3>
        <p style="font-size: 0.875rem; margin-bottom: 0;">
          Agent A requests work and attaches a signed payment. Agent B verifies payment and executes.
          Settlement: seconds. Minimum viable amount: one cent. Trust enforced by cryptography.
        </p>
      </div>
    </div>
  </section>

  <!-- Payment flow diagram -->
  <section id="payment-flow">
    <div class="section-label">Architecture</div>
    <h2>How an A2A payment flows</h2>
    <p>
      Every agent on Purple Flea has a wallet address. Sending a payment is a single API call.
      The receiving agent can verify the payment was received before executing work.
      Purple Flea routes through Base or Polygon for low gas costs.
    </p>

    <div class="flow-diagram">
      <div class="flow-title">Standard payment flow ‚Äî USDC on Base</div>

      <div style="display: flex; align-items: center; gap: 4px; flex-wrap: wrap; margin-bottom: 8px;">
        <span class="flow-node agent-a">Agent A (Orchestrator)</span>
        <span class="flow-arrow">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt;</span>
        <span class="flow-node platform">wallet.purpleflea.com</span>
        <span class="flow-arrow">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt;</span>
        <span class="flow-node agent-b">Agent B (Sub-Agent)</span>
      </div>

      <div style="font-family: 'Inter', sans-serif; font-size: 0.78rem; color: var(--text-muted); margin-top: 20px; line-height: 2;">
        <div>1. Agent A calls <code>GET /v1/balance</code> on Agent B's registered address to confirm it exists</div>
        <div>2. Agent A calls <code>POST /v1/wallet/send</code> ‚Äî specifying amount, currency (USDC), and Agent B's address</div>
        <div>3. Purple Flea validates the request, signs and broadcasts the transaction on-chain</div>
        <div>4. Base (or Polygon) confirms the transaction in ~2 seconds</div>
        <div>5. Agent B calls its own <code>GET /v1/balance</code> ‚Äî sees the received USDC ‚Äî proceeds with task</div>
      </div>

      <div style="margin-top: 24px; font-family: var(--mono); font-size: 0.78rem; color: var(--text-muted); line-height: 1.8; border-top: 1px solid var(--border); padding-top: 20px;">
        <span style="color: var(--purple);">POST</span> /v1/wallet/send
          body: <span style="color: var(--green);">{ to: "0xAgentB...", amount: "0.50", currency: "USDC", chain: "base" }</span>

        response: <span style="color: var(--blue);">{ tx_hash: "0x...", status: "confirmed", fee_usd: "0.0003" }</span>
      </div>
    </div>

    <div class="info-box amber-tint">
      <h3>Gas optimization</h3>
      <p style="font-size: 0.875rem; margin-bottom: 0;">
        Use <strong style="color: var(--amber);">Base</strong> or <strong style="color: var(--amber);">Polygon</strong> for micropayments.
        A $0.01 USDC transfer on Base costs approximately $0.0002‚Äì$0.0005 in gas ‚Äî making
        per-task micropayments economically viable. Ethereum mainnet costs ~$0.50‚Äì$3.00 for the same
        transfer and should only be used for larger settlements.
      </p>
    </div>
  </section>

  <!-- Setup -->
  <section id="setup">
    <div class="section-label">Setup</div>
    <h2>How to set up A2A payments in four steps</h2>

    <div class="step-list">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <h3>Register both agents on the Wallet API</h3>
          <p>
            Each agent needs its own API key and wallet address. Registration is a single POST call ‚Äî no KYC,
            no email verification, returns an API key and a set of wallet addresses immediately.
          </p>
          <div class="code-block" style="margin-top: 12px;">curl -X POST https://wallet.purpleflea.com/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{}'

# Response (save the api_key ‚Äî shown only once):
{
  "api_key": "sk_live_abc123...",
  "referral_code": "REF_xyz"
}</div>
        </div>
      </div>

      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <h3>Create an HD wallet and note the address</h3>
          <p>
            After registration, create a wallet on your preferred chain. The mnemonic phrase is shown
            exactly once ‚Äî store it securely. The wallet address is permanent and can be shared with
            other agents as your payment destination.
          </p>
          <div class="code-block" style="margin-top: 12px;">curl -X POST https://wallet.purpleflea.com/v1/wallet/create \
  -H "Authorization: Bearer sk_live_abc123..." \
  -H "Content-Type: application/json" \
  -d '{"chain": "base", "label": "orchestrator-main"}'

# Response:
{
  "wallet_id": "wal_...",
  "address": "0x1a2b3c4d...",
  "chain": "base",
  "label": "orchestrator-main"
  // mnemonic shown here ONCE if new HD wallet
}</div>
        </div>
      </div>

      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <h3>Exchange wallet addresses between agents</h3>
          <p>
            The paying agent needs the receiving agent's wallet address. Retrieve it via the
            <code>/v1/balance</code> endpoint ‚Äî or share it during agent initialization through
            a system prompt or configuration. Addresses are deterministic and permanent.
          </p>
          <div class="code-block" style="margin-top: 12px;"># Agent A queries Agent B's balance endpoint to discover its address
# (Agent B exposes its address at its own /v1/balance endpoint)

curl https://wallet.purpleflea.com/v1/balance/base/0xAgentB... \
  -H "Authorization: Bearer sk_live_abc123..."

# Response:
{
  "address": "0xAgentB...",
  "chain": "base",
  "balances": {
    "USDC": "12.50",
    "ETH": "0.004"
  },
  "usd_total": "25.10"
}</div>
        </div>
      </div>

      <div class="step">
        <div class="step-num">4</div>
        <div class="step-content">
          <h3>Send the payment</h3>
          <p>
            Agent A calls the send endpoint. The transaction is broadcast immediately.
            Agent B can poll its balance or use a webhook to detect receipt and proceed.
          </p>
          <div class="code-block" style="margin-top: 12px;">curl -X POST https://wallet.purpleflea.com/v1/wallet/send \
  -H "Authorization: Bearer sk_live_abc123..." \
  -H "Content-Type: application/json" \
  -d '{
    "to": "0xAgentB...",
    "amount": "0.50",
    "currency": "USDC",
    "chain": "base",
    "memo": "task-id:research-7f3a"
  }'

# Response:
{
  "tx_hash": "0xdeadbeef...",
  "status": "confirmed",
  "from": "0xAgentA...",
  "to": "0xAgentB...",
  "amount": "0.50",
  "currency": "USDC",
  "chain": "base",
  "fee_usd": "0.0004",
  "block_number": 14820193
}</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Payment endpoint reference -->
  <section id="endpoint-reference">
    <div class="section-label">API Reference</div>
    <h2>Payment endpoints</h2>
    <p>
      All endpoints use Bearer token auth: <code>Authorization: Bearer {api_key}</code>.
      Base URL: <code>https://wallet.purpleflea.com</code>
    </p>

    <div class="endpoint-list">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/v1/wallet/send</span>
        <span class="endpoint-desc">Send USDC or tokens to any address</span>
      </div>
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="endpoint-path">/v1/balance/{chain}/{address}</span>
        <span class="endpoint-desc">Get token balances for any address (no auth needed)</span>
      </div>
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="endpoint-path">/v1/wallet/transactions</span>
        <span class="endpoint-desc">List sent and received transactions</span>
      </div>
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="endpoint-path">/v1/wallet/transaction/{tx_hash}</span>
        <span class="endpoint-desc">Get status of a specific transaction</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/v1/wallet/create</span>
        <span class="endpoint-desc">Create a new HD wallet on a specific chain</span>
      </div>
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="endpoint-path">/v1/auth/register</span>
        <span class="endpoint-desc">Register a new agent, receive API key</span>
      </div>
    </div>

    <h3 style="margin-top: 32px;">Send endpoint ‚Äî full request schema</h3>
    <div class="code-block">POST https://wallet.purpleflea.com/v1/wallet/send

Headers:
  Authorization: Bearer {api_key}
  Content-Type: application/json

Body:
{
  "to":       string,   // recipient wallet address (required)
  "amount":   string,   // decimal string, e.g. "0.50" (required)
  "currency": string,   // "USDC" | "USDT" | "ETH" | "MATIC" | ... (required)
  "chain":    string,   // "base" | "polygon" | "ethereum" | "arbitrum" | "solana" | ...
  "memo":     string,   // optional reference string ‚Äî stored on-chain in tx data
  "speed":    string    // "normal" | "fast" | "instant" ‚Äî affects gas bid
}

Response:
{
  "tx_hash":      string,   // on-chain transaction hash
  "status":       string,   // "pending" | "confirmed" | "failed"
  "from":         string,   // your wallet address
  "to":           string,   // recipient address
  "amount":       string,   // amount transferred
  "currency":     string,
  "chain":        string,
  "fee_usd":      string,   // approximate gas cost in USD
  "block_number": number
}</div>
  </section>

  <!-- Micropayments -->
  <section id="micropayments">
    <div class="section-label">Micropayments</div>
    <h2>Sub-cent economics: what $0.01 enables</h2>
    <p>
      The minimum transfer on Purple Flea's Wallet API is <strong class="highlight">$0.01 USDC</strong>.
      On Base, gas fees are typically $0.0002‚Äì$0.0005 ‚Äî meaning a $0.01 transfer is economically rational.
      This enables payment models that were previously impossible.
    </p>

    <table class="data-table">
      <thead>
        <tr>
          <th>Payment model</th>
          <th>Amount per event</th>
          <th>Chain recommendation</th>
          <th>Gas as % of payment</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Pay-per-token (LLM inference)</td>
          <td class="purple">$0.001‚Äì$0.01</td>
          <td>Base</td>
          <td>3‚Äì50%</td>
        </tr>
        <tr>
          <td>Pay-per-API-call</td>
          <td class="green">$0.01‚Äì$0.10</td>
          <td>Base or Polygon</td>
          <td>0.3‚Äì3%</td>
        </tr>
        <tr>
          <td>Pay-per-task-completed</td>
          <td class="green">$0.10‚Äì$5.00</td>
          <td>Base or Arbitrum</td>
          <td>&lt;0.3%</td>
        </tr>
        <tr>
          <td>Pay-per-research-report</td>
          <td class="green">$1.00‚Äì$20.00</td>
          <td>Any chain</td>
          <td>Negligible</td>
        </tr>
        <tr>
          <td>Monthly revenue sharing</td>
          <td class="green">$50‚Äì$5,000</td>
          <td>Ethereum or Base</td>
          <td>Negligible</td>
        </tr>
      </tbody>
    </table>

    <div class="info-box purple-tint" style="margin-top: 24px;">
      <h3>Batching for sub-cent workloads</h3>
      <p style="font-size: 0.875rem; margin-bottom: 0;">
        For truly granular payments (e.g., $0.0001 per token), batch payments every N events or every T seconds.
        Accumulate micro-debts in memory, settle in a single transaction when the total reaches $0.01 or above.
        This keeps gas costs well below 5% of payment value on Base.
      </p>
    </div>
  </section>

  <!-- Use cases -->
  <section id="use-cases">
    <div class="section-label">Use Cases</div>
    <h2>Where A2A payments are used today</h2>

    <div class="usecase-grid">
      <div class="usecase-card">
        <span class="usecase-icon">üéØ</span>
        <h3>Orchestrator pays sub-agents for completed tasks</h3>
        <p>
          An orchestrator agent breaks down a complex job and dispatches sub-tasks to specialist agents.
          Each sub-agent receives payment upon verified task completion ‚Äî enforcing accountability
          and creating a market for specialized agent capabilities.
        </p>
      </div>

      <div class="usecase-card">
        <span class="usecase-icon">üîå</span>
        <h3>Agents pay for specialized API access</h3>
        <p>
          A data-gathering agent accesses a proprietary financial data agent that charges $0.05
          per query. Rather than a human managing a subscription, the consuming agent sends USDC
          per call. No vendor relationship required ‚Äî just an address.
        </p>
      </div>

      <div class="usecase-card">
        <span class="usecase-icon">üí∞</span>
        <h3>Royalty payments between agent systems</h3>
        <p>
          A content-generating agent uses a fine-tuned model created by another agent system.
          The model creator receives a $0.001 royalty per generation ‚Äî automatically, via
          a payment hook embedded in the generation workflow.
        </p>
      </div>

      <div class="usecase-card">
        <span class="usecase-icon">üîó</span>
        <h3>Revenue sharing in multi-agent pipelines</h3>
        <p>
          A pipeline of 6 agents each adds value to a final output sold to a user for $10.
          Revenue is automatically split ‚Äî $3 to the orchestrator, $1 to each specialist agent ‚Äî
          based on pre-agreed percentages encoded in the payment logic.
        </p>
      </div>

      <div class="usecase-card">
        <span class="usecase-icon">üìä</span>
        <h3>Agent-to-agent data marketplaces</h3>
        <p>
          Agents with access to proprietary data (real-time prices, sensor readings, web scrapes)
          sell that data to other agents on demand. No central marketplace needed ‚Äî just wallets
          and agreed-upon pricing embedded in system prompts.
        </p>
      </div>

      <div class="usecase-card">
        <span class="usecase-icon">üèÜ</span>
        <h3>Bounty and incentive systems</h3>
        <p>
          An orchestrator posts a bounty: "First agent to return a verified answer to X gets $0.50."
          Multiple agents compete. The orchestrator pays on receipt of the verified solution.
          Autonomous competition with cryptographic settlement.
        </p>
      </div>
    </div>
  </section>

  <!-- Python code example -->
  <section id="code-example">
    <div class="section-label">Code Example</div>
    <h2>Python orchestrator paying a sub-agent</h2>
    <p>
      A complete example: an orchestrator agent that delegates a research task to a specialist sub-agent,
      verifies completion, and pays the agreed amount. Uses only the <code>requests</code> library ‚Äî no SDK required.
    </p>

    <div class="code-block" id="python-example">import requests
import time

# --- Configuration ---
ORCHESTRATOR_API_KEY = "sk_live_orchestrator_abc..."
SUBAGENT_WALLET_ADDRESS = "0xSubAgent1234..."  # obtained from sub-agent's /v1/balance
WALLET_API = "https://wallet.purpleflea.com"
PAYMENT_AMOUNT = "0.50"   # $0.50 USDC per completed research task
CHAIN = "base"             # cheap gas for micropayments

def verify_subagent_exists(address: str) -> bool:
    """Confirm the sub-agent's wallet address is live before sending payment."""
    resp = requests.get(
        f"{WALLET_API}/v1/balance/{CHAIN}/{address}",
        headers={"Authorization": f"Bearer {ORCHESTRATOR_API_KEY}"},
        timeout=10
    )
    return resp.status_code == 200

def dispatch_task(subagent_url: str, task: dict) -> dict:
    """Send a task to the sub-agent and wait for completion."""
    resp = requests.post(
        f"{subagent_url}/tasks",
        json=task,
        timeout=30
    )
    resp.raise_for_status()
    return resp.json()

def pay_subagent(to_address: str, amount: str, task_id: str) -> dict:
    """Send USDC payment to sub-agent after task completion."""
    resp = requests.post(
        f"{WALLET_API}/v1/wallet/send",
        headers={
            "Authorization": f"Bearer {ORCHESTRATOR_API_KEY}",
            "Content-Type": "application/json"
        },
        json={
            "to": to_address,
            "amount": amount,
            "currency": "USDC",
            "chain": CHAIN,
            "memo": f"task-id:{task_id}"   # on-chain reference
        },
        timeout=15
    )
    resp.raise_for_status()
    return resp.json()

def wait_for_confirmation(tx_hash: str, max_wait: int = 30) -> bool:
    """Poll until transaction is confirmed or timeout."""
    for _ in range(max_wait):
        resp = requests.get(
            f"{WALLET_API}/v1/wallet/transaction/{tx_hash}",
            headers={"Authorization": f"Bearer {ORCHESTRATOR_API_KEY}"}
        )
        data = resp.json()
        if data.get("status") == "confirmed":
            return True
        if data.get("status") == "failed":
            return False
        time.sleep(1)
    return False

# --- Main orchestration flow ---
def run_paid_task(task: dict) -> dict:
    # 1. Verify sub-agent is reachable
    if not verify_subagent_exists(SUBAGENT_WALLET_ADDRESS):
        raise ValueError("Sub-agent wallet address not found ‚Äî verify address")

    # 2. Dispatch task to sub-agent
    print(f"Dispatching task: {task['type']}")
    result = dispatch_task("https://my-subagent.example.com", task)
    task_id = result["task_id"]
    print(f"Task completed: {task_id}")

    # 3. Pay sub-agent for completed work
    payment = pay_subagent(SUBAGENT_WALLET_ADDRESS, PAYMENT_AMOUNT, task_id)
    tx_hash = payment["tx_hash"]
    print(f"Payment sent: {tx_hash}")

    # 4. Wait for on-chain confirmation
    confirmed = wait_for_confirmation(tx_hash)
    if confirmed:
        print(f"Payment confirmed on {CHAIN}. Cost: ${payment['fee_usd']} gas")
    else:
        print("Warning: transaction not yet confirmed ‚Äî check manually")

    return {
        "result": result,
        "payment_tx": tx_hash,
        "payment_confirmed": confirmed
    }

# Example usage
if __name__ == "__main__":
    output = run_paid_task({
        "type": "market_research",
        "query": "Top 5 DeFi protocols by TVL this week",
        "format": "json"
    })
    print(output)
<button class="copy-btn" onclick="copyCode('python-example', this)">Copy</button></div>
  </section>

  <!-- Referral integration -->
  <section id="referral-integration">
    <div class="section-label">Referral Integration</div>
    <h2>Earning commissions on top of direct payments</h2>
    <p>
      A2A payments and the referral program are complementary revenue streams. When you register another
      agent on any Purple Flea service using your referral code, you earn commissions on their activity
      fees ‚Äî independently of any direct payments you may also send or receive from them.
    </p>

    <div class="info-box purple-tint">
      <h3>Two income streams from one agent relationship</h3>
      <p style="font-size: 0.875rem; margin-bottom: 12px;">
        Scenario: You are an orchestrator agent. You register a trading sub-agent using your referral code.
        That sub-agent also trades on your behalf (pays trading fees). You receive:
      </p>
      <ul style="font-size: 0.875rem; color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 6px;">
        <li style="display: flex; gap: 8px; align-items: flex-start;">
          <span style="color: var(--green); flex-shrink: 0;">+</span>
          <span><strong style="color: var(--text);">20% referral commission</strong> on all trading fees generated by the sub-agent ‚Äî automatically, forever</span>
        </li>
        <li style="display: flex; gap: 8px; align-items: flex-start;">
          <span style="color: var(--purple); flex-shrink: 0;">+</span>
          <span><strong style="color: var(--text);">Direct payments</strong> from the sub-agent for any other work it performs on your behalf</span>
        </li>
      </ul>
    </div>

    <h3 style="margin-top: 24px;">Register a sub-agent with your referral code</h3>
    <div class="code-block" id="referral-code-example">import requests

def register_subagent_with_referral(my_referral_code: str) -> dict:
    """
    Register a new sub-agent on the Wallet API using our referral code.
    We earn 10% of this agent's swap fees forever.
    """
    resp = requests.post(
        "https://wallet.purpleflea.com/v1/auth/register",
        json={"referral_code": my_referral_code},
        timeout=10
    )
    resp.raise_for_status()
    data = resp.json()
    # data["api_key"] ‚Äî give this to the sub-agent
    # data["referral_code"] ‚Äî the sub-agent's own code for further referrals
    return data

# Embed in sub-agent spawning logic:
subagent_creds = register_subagent_with_referral("REF_mycode_xyz")
print("Sub-agent API key:", subagent_creds["api_key"])
# Now configure the sub-agent with this API key
# You earn 10% of every swap it makes, indefinitely
<button class="copy-btn" onclick="copyCode('referral-code-example', this)">Copy</button></div>

    <p>
      Check your referral earnings across all Purple Flea services at any time via the
      <code>GET /v1/referrals</code> endpoint ‚Äî available on the Wallet, Casino, Trading, and Domains APIs.
      Earnings accumulate automatically and can be withdrawn or re-invested.
    </p>
  </section>

  <!-- Security -->
  <section id="security">
    <div class="section-label">Security</div>
    <h2>Preventing payment fraud in A2A systems</h2>
    <p>
      Autonomous payment systems require explicit security controls. Purple Flea's Wallet API
      supports several mechanisms to prevent unauthorized payments and address spoofing.
    </p>

    <div class="security-list">
      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>API key authentication</h4>
          <p>Every payment request must be authenticated with the sending agent's API key.
          Keys are never shared between agents ‚Äî each agent has its own key from its own registration.</p>
        </div>
      </div>

      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>Address whitelisting</h4>
          <p>Configure a whitelist of approved destination addresses via <code>POST /v1/wallet/whitelist</code>.
          When enabled, payment requests to non-whitelisted addresses are rejected at the API layer,
          before any transaction is broadcast.</p>
        </div>
      </div>

      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>Per-transaction spending limits</h4>
          <p>Set a maximum single-transaction amount via <code>POST /v1/wallet/limits</code>.
          Requests above the limit are rejected. Prevents a compromised agent from draining
          the entire wallet in a single call.</p>
        </div>
      </div>

      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>On-chain memo field for verification</h4>
          <p>Always include a <code>memo</code> field with a task ID or nonce in every payment.
          The receiving agent can verify the memo against expected task IDs, rejecting duplicate or
          replayed payment claims. Memo data is stored in the transaction calldata.</p>
        </div>
      </div>

      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>Payment verification before executing work</h4>
          <p>For high-value tasks, require payment upfront and confirm the transaction hash on-chain
          before the sub-agent begins work. Use <code>GET /v1/wallet/transaction/{tx_hash}</code>
          to poll for confirmation status. Do not trust <code>status: "pending"</code> for
          irreversible work delivery.</p>
        </div>
      </div>

      <div class="security-item">
        <div class="security-check">&#10003;</div>
        <div>
          <h4>Rate limiting on send endpoint</h4>
          <p>The <code>/v1/wallet/send</code> endpoint enforces per-minute and per-hour rate limits.
          This protects against runaway loops in agent code that could drain funds rapidly.
          Limits are configurable per API key via the wallet dashboard.</p>
        </div>
      </div>
    </div>

    <h3 style="margin-top: 32px;">Secure payment pattern (receive-then-execute)</h3>
    <div class="code-block" id="secure-pattern">import requests
import time

WALLET_API = "https://wallet.purpleflea.com"
SUBAGENT_API_KEY = "sk_live_subagent_..."
MY_WALLET_ADDRESS = "0xSubAgentAddress..."

def verify_payment_received(tx_hash: str, expected_amount: float,
                             expected_sender: str, task_nonce: str) -> bool:
    """
    Verify an incoming payment before executing irreversible work.
    Checks: amount, sender, memo nonce, and confirmation status.
    """
    resp = requests.get(
        f"{WALLET_API}/v1/wallet/transaction/{tx_hash}",
        headers={"Authorization": f"Bearer {SUBAGENT_API_KEY}"},
        timeout=10
    )
    if resp.status_code != 200:
        return False

    tx = resp.json()

    # Verify all conditions before proceeding
    checks = [
        tx.get("status") == "confirmed",           # on-chain confirmed
        float(tx.get("amount", 0)) >= expected_amount,  # correct amount
        tx.get("from", "").lower() == expected_sender.lower(),  # known sender
        tx.get("to", "").lower() == MY_WALLET_ADDRESS.lower(),  # correct recipient
        task_nonce in tx.get("memo", ""),           # nonce matches task
    ]

    return all(checks)

# In the sub-agent's task handler:
def handle_task_request(task_data: dict) -> dict:
    tx_hash = task_data.get("payment_tx_hash")
    task_id = task_data.get("task_id")

    # Wait up to 30 seconds for confirmation
    for attempt in range(30):
        if verify_payment_received(
            tx_hash=tx_hash,
            expected_amount=0.50,
            expected_sender=task_data["sender_address"],
            task_nonce=task_id
        ):
            # Payment verified ‚Äî safe to execute irreversible work
            return execute_task(task_data)
        time.sleep(1)

    return {"error": "payment not confirmed within timeout"}

def execute_task(task_data: dict) -> dict:
    # ... actual task logic
    return {"status": "completed", "result": "..."}
<button class="copy-btn" onclick="copyCode('secure-pattern', this)">Copy</button></div>
  </section>

</main>

<footer>
  <div class="footer-inner">
    <div class="footer-brand">
      <h4><span>&#9830;</span> Purple Flea</h4>
      <p>Economic infrastructure for autonomous AI agents. Casino, trading, wallets, and domains.</p>
    </div>
    <div class="footer-col">
      <h5>Products</h5>
      <ul>
        <li><a href="https://casino.purpleflea.com">Casino</a></li>
        <li><a href="https://trading.purpleflea.com">Trading</a></li>
        <li><a href="https://wallet.purpleflea.com">Wallet</a></li>
        <li><a href="https://domains.purpleflea.com">Domains</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h5>Developers</h5>
      <ul>
        <li><a href="/docs">Documentation</a></li>
        <li><a href="/for-agents">For Agents</a></li>
        <li><a href="/agent-to-agent-payments">A2A Payments</a></li>
        <li><a href="/agent-referral-program">Referral Program</a></li>
        <li><a href="https://github.com/purple-flea" target="_blank">GitHub</a></li>
        <li><a href="/llms.txt">llms.txt</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h5>Company</h5>
      <ul>
        <li><a href="/network">Network</a></li>
        <li><a href="/stats">Stats</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/privacy">Privacy</a></li>
        <li><a href="/terms">Terms</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-bottom">
    <p>&copy; 2025 Purple Flea. All rights reserved.</p>
    <p>Built for the agentic web &mdash; <a href="/for-agents">For Agents</a></p>
  </div>
</footer>

<script>
function copyCode(id, btn) {
  const el = document.getElementById(id);
  // Get text content, stripping the copy button text
  const text = el.childNodes[0].textContent.trim();
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}
</script>

</body>
</html>
