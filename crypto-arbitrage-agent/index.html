<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Build a Crypto Arbitrage Agent â€” Advanced Guide | Purple Flea</title>
<meta name="description" content="Complete guide to building a crypto arbitrage agent using Purple Flea APIs. Covers funding rate arbitrage, basis trading, statistical arb, triangular arb, full Python code, backtesting, and live deployment.">
<link rel="canonical" href="https://purpleflea.com/crypto-arbitrage-agent">
<meta property="og:title" content="Build a Crypto Arbitrage Agent â€” Advanced Guide | Purple Flea">
<meta property="og:description" content="Complete guide to building a crypto arbitrage agent. Full Python bot, backtesting code, pm2 deployment, risk management, and realistic performance expectations.">
<meta property="og:url" content="https://purpleflea.com/crypto-arbitrage-agent">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Purple Flea">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@purpleflea">
<meta name="twitter:title" content="Build a Crypto Arbitrage Agent â€” Advanced Guide | Purple Flea">
<meta name="twitter:description" content="Full Python arbitrage bot, funding rate strategies, basis trading, backtesting, and pm2 deployment via Purple Flea APIs.">
<meta name="twitter:image" content="https://purpleflea.com/flea.jpg">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Build a Crypto Arbitrage Agent â€” Advanced Guide",
  "name": "Build a Crypto Arbitrage Agent",
  "url": "https://purpleflea.com/crypto-arbitrage-agent",
  "description": "Complete guide to building a crypto arbitrage agent using Purple Flea APIs. Covers funding rate arbitrage, basis trading, statistical arb, triangular arb, full Python code, backtesting, and live deployment.",
  "publisher": { "@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com" },
  "author": { "@type": "Organization", "name": "Purple Flea" }
}
</script>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŸ£</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.3);
  --purple-subtle: rgba(168, 85, 247, 0.08);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255,255,255,0.06);
  --border-hover: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --radius: 16px;
  --radius-sm: 10px;
}
html { scroll-behavior: smooth; }
body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
body::before { content: ''; position: fixed; inset: 0; z-index: 9999; pointer-events: none; opacity: 0.025; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"); background-repeat: repeat; background-size: 180px; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.3); border-radius: 3px; }
::selection { background: rgba(168, 85, 247, 0.4); color: white; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.reveal { opacity: 0; transform: translateY(30px); transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
.reveal.visible { opacity: 1; transform: translateY(0); }
.reveal-delay-1 { transition-delay: 0.1s; }
.reveal-delay-2 { transition-delay: 0.2s; }
.reveal-delay-3 { transition-delay: 0.3s; }

/* NAV */
nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 16px 0; transition: all 0.3s ease; }
nav.scrolled { background: rgba(9, 9, 11, 0.85); backdrop-filter: blur(20px) saturate(1.5); border-bottom: 1px solid var(--border); }
.nav-inner { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.nav-logo { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 18px; text-decoration: none; color: var(--text); }
.nav-logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--purple), var(--purple-dim)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
.nav-links { display: flex; align-items: center; gap: 32px; list-style: none; }
.nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 14px; font-weight: 450; transition: color 0.2s; }
.nav-links a:hover { color: var(--text); }
.nav-cta { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; background: var(--purple); color: white !important; border-radius: 8px; font-weight: 500; font-size: 14px; text-decoration: none; transition: all 0.2s; }
.nav-cta:hover { background: var(--purple-dim); transform: translateY(-1px); }
@media (max-width: 768px) { .nav-links { display: none; } }

/* HERO */
.hero { min-height: 85vh; display: flex; align-items: center; justify-content: center; position: relative; padding: 130px 0 90px; overflow: hidden; }
.hero-bg { position: absolute; inset: 0; overflow: hidden; }
.hero-gradient-1 { position: absolute; top: -30%; left: 50%; transform: translateX(-50%); width: 900px; height: 600px; background: radial-gradient(ellipse, rgba(168, 85, 247, 0.15) 0%, transparent 70%); filter: blur(60px); }
.hero-grid { position: absolute; inset: 0; background-image: linear-gradient(rgba(168, 85, 247, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(168, 85, 247, 0.03) 1px, transparent 1px); background-size: 60px 60px; mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); -webkit-mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); }
.hero-content { position: relative; text-align: center; max-width: 860px; margin: 0 auto; padding: 0 24px; }
.hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px 6px 8px; background: var(--purple-subtle); border: 1px solid rgba(168, 85, 247, 0.2); border-radius: 100px; font-size: 12px; font-weight: 700; color: var(--purple); margin-bottom: 32px; letter-spacing: 0.1em; text-transform: uppercase; animation: fadeInDown 0.8s ease; }
.hero-badge-dot { width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: badge-pulse 2s ease-in-out infinite; }
@keyframes badge-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
@keyframes fadeInDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes gradient-shift { 0% { background-position: 0% center; } 50% { background-position: 100% center; } 100% { background-position: 0% center; } }
.hero h1 { font-size: clamp(2.5rem, 6vw, 4.5rem); font-weight: 800; line-height: 1.05; letter-spacing: -0.03em; margin-bottom: 24px; animation: fadeInUp 0.8s ease 0.1s both; }
.hero h1 .gradient { background: linear-gradient(135deg, var(--purple) 0%, #C084FC 50%, var(--purple) 100%); background-size: 200% auto; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: gradient-shift 5s ease infinite; }
.hero-desc { font-size: clamp(1rem, 2vw, 1.2rem); color: var(--text-secondary); margin-bottom: 40px; line-height: 1.7; animation: fadeInUp 0.8s ease 0.2s both; }
.hero-actions { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; animation: fadeInUp 0.8s ease 0.3s both; }
.btn-primary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--purple); color: white; border-radius: var(--radius-sm); font-weight: 600; font-size: 15px; text-decoration: none; transition: all 0.2s; box-shadow: 0 0 30px rgba(168, 85, 247, 0.3); }
.btn-primary:hover { background: var(--purple-dim); transform: translateY(-2px); box-shadow: 0 0 40px rgba(168, 85, 247, 0.5); }
.btn-secondary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--bg-card); color: var(--text); border-radius: var(--radius-sm); font-weight: 500; font-size: 15px; text-decoration: none; border: 1px solid var(--border); transition: all 0.2s; }
.btn-secondary:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }
.hero-meta { display: flex; gap: 32px; justify-content: center; margin-top: 52px; flex-wrap: wrap; animation: fadeInUp 0.8s ease 0.4s both; }
.hero-meta-item { display: flex; flex-direction: column; align-items: center; gap: 4px; }
.hero-meta-item .val { font-size: 1.5rem; font-weight: 800; color: var(--text); }
.hero-meta-item .lbl { font-size: 12px; color: var(--text-muted); letter-spacing: 0.05em; }

/* SECTIONS */
section { padding: 100px 0; position: relative; }
.section-label { display: inline-flex; align-items: center; gap: 12px; font-size: 12px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--purple); margin-bottom: 20px; }
.section-label::before { content: ''; width: 24px; height: 1px; background: var(--purple); }
.section-title { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; }
.section-desc { font-size: 1.1rem; color: var(--text-secondary); max-width: 600px; margin-bottom: 60px; line-height: 1.7; }
.section-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 0; }

/* CODE BLOCK */
.code-block { background: rgba(0,0,0,0.45); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.75; overflow-x: auto; position: relative; }
.code-block .code-header { display: flex; align-items: center; gap: 8px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.code-dot { width: 12px; height: 12px; border-radius: 50%; }
.code-dot.red { background: #EF4444; }
.code-dot.yellow { background: #FBBF24; }
.code-dot.green { background: #22C55E; }
.code-filename { margin-left: 8px; font-size: 12px; color: var(--text-muted); }
.kw { color: #C084FC; }
.fn { color: #93C5FD; }
.st { color: #86EFAC; }
.cm { color: var(--text-muted); font-style: italic; }
.num { color: #FDE68A; }
.cls { color: #F9A8D4; }
.at { color: #A855F7; }
.op { color: #7DD3FC; }

/* GRID */
.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
@media (max-width: 900px) { .grid-3, .grid-4 { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 768px) { .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; } }

/* CARDS */
.card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; transition: all 0.3s ease; }
.card:hover { background: var(--bg-card-hover); border-color: var(--border-hover); transform: translateY(-4px); box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 30px rgba(168,85,247,0.05); }
.card-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; margin-bottom: 20px; }
.card-icon.purple { background: rgba(168, 85, 247, 0.15); }
.card-icon.blue { background: rgba(96, 165, 250, 0.15); }
.card-icon.green { background: rgba(34, 197, 94, 0.15); }
.card-icon.orange { background: rgba(251, 146, 60, 0.15); }
.card-icon.red { background: rgba(239, 68, 68, 0.15); }
.card h3 { font-size: 1.1rem; font-weight: 600; margin-bottom: 10px; }
.card p { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.65; }
.card .tag { display: inline-block; padding: 3px 10px; border-radius: 100px; font-size: 11px; font-weight: 600; letter-spacing: 0.05em; margin-bottom: 12px; }
.tag-green { background: rgba(34,197,94,0.1); color: #4ADE80; border: 1px solid rgba(34,197,94,0.2); }
.tag-yellow { background: rgba(251,191,36,0.1); color: #FCD34D; border: 1px solid rgba(251,191,36,0.2); }
.tag-blue { background: rgba(96,165,250,0.1); color: #93C5FD; border: 1px solid rgba(96,165,250,0.2); }
.tag-purple { background: rgba(168,85,247,0.1); color: #C084FC; border: 1px solid rgba(168,85,247,0.2); }

/* STEPS */
.steps { display: flex; flex-direction: column; gap: 0; }
.step { display: flex; gap: 24px; padding: 32px 0; border-bottom: 1px solid var(--border); }
.step:last-child { border-bottom: none; }
.step-num { width: 40px; height: 40px; min-width: 40px; border-radius: 10px; background: var(--purple-subtle); border: 1px solid rgba(168,85,247,0.2); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; color: var(--purple); }
.step-content h3 { font-size: 1.05rem; font-weight: 600; margin-bottom: 8px; }
.step-content p { color: var(--text-secondary); font-size: 0.9rem; }

/* PROSE */
.prose { max-width: 820px; }
.prose h2 { font-size: clamp(1.5rem, 3vw, 2rem); font-weight: 700; letter-spacing: -0.02em; margin-bottom: 16px; margin-top: 64px; }
.prose h2:first-child { margin-top: 0; }
.prose h3 { font-size: 1.15rem; font-weight: 600; margin-bottom: 12px; margin-top: 36px; color: var(--text); }
.prose p { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; }
.prose ul, .prose ol { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; padding-left: 24px; }
.prose li { margin-bottom: 10px; }
.prose strong { color: var(--text); font-weight: 600; }
.prose a { color: var(--purple); text-decoration: none; }
.prose a:hover { text-decoration: underline; }
.prose code { font-family: 'JetBrains Mono', monospace; font-size: 0.875em; background: rgba(168,85,247,0.1); color: var(--purple); padding: 2px 7px; border-radius: 4px; }
.formula-block { background: rgba(0,0,0,0.4); border: 1px solid var(--border); border-left: 3px solid var(--purple); border-radius: var(--radius-sm); padding: 20px 24px; font-family: 'JetBrains Mono', monospace; font-size: 13px; color: var(--text-secondary); margin: 24px 0; line-height: 1.9; }
.info-box { background: rgba(168,85,247,0.06); border: 1px solid rgba(168,85,247,0.2); border-radius: var(--radius-sm); padding: 20px 24px; margin: 24px 0; }
.info-box p { color: var(--text-secondary); font-size: 0.95rem; margin: 0; }
.info-box strong { color: var(--purple); }
.warning-box { background: rgba(251,146,60,0.05); border: 1px solid rgba(251,146,60,0.2); border-radius: var(--radius-sm); padding: 20px 24px; margin: 24px 0; }
.warning-box p { color: var(--text-secondary); font-size: 0.95rem; margin: 0; }
.warning-box strong { color: #FB923C; }

/* PERFORMANCE TABLE */
.perf-table { width: 100%; border-collapse: collapse; font-size: 14px; margin: 28px 0; }
.perf-table th { text-align: left; padding: 12px 16px; font-size: 12px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; color: var(--text-muted); border-bottom: 1px solid var(--border); }
.perf-table td { padding: 14px 16px; border-bottom: 1px solid rgba(255,255,255,0.04); color: var(--text-secondary); vertical-align: top; }
.perf-table tr:last-child td { border-bottom: none; }
.perf-table td:first-child { color: var(--text); font-weight: 500; }
.perf-table .green { color: #4ADE80; }
.perf-table .yellow { color: #FCD34D; }
.perf-table .red { color: #F87171; }
.table-wrap { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; margin: 28px 0; }

/* CTA SECTION */
.cta-section { text-align: center; padding: 100px 0; }
.cta-box { background: linear-gradient(135deg, rgba(168,85,247,0.08) 0%, rgba(124,58,237,0.05) 100%); border: 1px solid rgba(168,85,247,0.2); border-radius: 24px; padding: 80px 40px; position: relative; overflow: hidden; }
.cta-box::before { content: ''; position: absolute; top: -50%; left: 50%; transform: translateX(-50%); width: 600px; height: 400px; background: radial-gradient(ellipse, rgba(168,85,247,0.1) 0%, transparent 70%); filter: blur(40px); pointer-events: none; }
.cta-box h2 { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; position: relative; }
.cta-box p { color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 40px; position: relative; max-width: 520px; margin-left: auto; margin-right: auto; }
.cta-buttons { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; position: relative; }

/* FOOTER */
footer { padding: 60px 0 40px; border-top: 1px solid var(--border); }
.footer-top { display: grid; grid-template-columns: 1fr 2fr; gap: 60px; margin-bottom: 60px; }
.footer-brand p { color: var(--text-secondary); font-size: 14px; margin-top: 16px; max-width: 260px; line-height: 1.6; }
.footer-columns { display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; }
.footer-col h4 { font-size: 13px; font-weight: 600; margin-bottom: 16px; }
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.footer-col a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-col a:hover { color: var(--text); }
.footer-bottom { display: flex; align-items: center; justify-content: space-between; padding-top: 24px; border-top: 1px solid var(--border); }
.footer-bottom p { color: var(--text-muted); font-size: 13px; }
.footer-social { display: flex; gap: 24px; }
.footer-social a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-social a:hover { color: var(--text); }
@media (max-width: 768px) { .footer-top { grid-template-columns: 1fr; gap: 40px; } .footer-columns { grid-template-columns: repeat(2, 1fr); } .footer-bottom { flex-direction: column; gap: 16px; text-align: center; } }

/* RELATED */
.related-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 768px) { .related-grid { grid-template-columns: 1fr; } }
.related-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px 24px; text-decoration: none; color: var(--text); display: block; transition: all 0.2s; }
.related-card:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }
.related-card .label { font-size: 11px; color: var(--purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
.related-card .title { font-size: 14px; font-weight: 600; }
.related-card .desc { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

/* TOC */
.toc { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px 32px; max-width: 820px; margin-bottom: 60px; }
.toc h4 { font-size: 12px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-muted); margin-bottom: 16px; }
.toc ol { padding-left: 20px; display: flex; flex-direction: column; gap: 8px; }
.toc li a { color: var(--text-secondary); text-decoration: none; font-size: 14px; transition: color 0.2s; }
.toc li a:hover { color: var(--purple); }
</style>
</head>
<body>

<nav id="navbar">
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <div class="nav-logo-icon">&#9830;</div>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents</a></li>
      <li><a href="/trading-api/">Trading API</a></li>
      <li><a href="/crypto-wallet-api/">Wallet API</a></li>
      <li><a href="https://trading.purpleflea.com" target="_blank" class="nav-cta">Start Trading &rarr;</a></li>
    </ul>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg">
    <div class="hero-gradient-1"></div>
    <div class="hero-grid"></div>
  </div>
  <div class="hero-content">
    <div class="hero-badge">
      <div class="hero-badge-dot"></div>
      Advanced Guide
    </div>
    <h1>Build a Crypto<br><span class="gradient">Arbitrage Agent</span></h1>
    <p class="hero-desc">
      A complete playbook for building an autonomous arbitrage agent on Purple Flea. Covers four strategy types, a full Python bot with live funding-rate monitoring, backtesting, risk management, and pm2 deployment.
    </p>
    <div class="hero-actions">
      <a href="https://trading.purpleflea.com" class="btn-primary" target="_blank">Register for Trading API &rarr;</a>
      <a href="https://wallet.purpleflea.com" class="btn-secondary" target="_blank">Register for Wallet API</a>
    </div>
    <div class="hero-meta">
      <div class="hero-meta-item">
        <span class="val">275+</span>
        <span class="lbl">Perp Markets</span>
      </div>
      <div class="hero-meta-item">
        <span class="val">50x</span>
        <span class="lbl">Max Leverage</span>
      </div>
      <div class="hero-meta-item">
        <span class="val">0.02%</span>
        <span class="lbl">Maker Fee</span>
      </div>
      <div class="hero-meta-item">
        <span class="val">8h</span>
        <span class="lbl">Funding Interval</span>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- INTRO + TOC -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Overview</div>
      <h2 class="section-title">What this guide covers</h2>
      <p class="section-desc">Everything you need to deploy a production arbitrage agent â€” from strategy theory to live code and server configuration.</p>
    </div>
    <div class="toc reveal reveal-delay-1">
      <h4>Contents</h4>
      <ol>
        <li><a href="#strategy-types">Four Arbitrage Strategies</a></li>
        <li><a href="#apis">Purple Flea API Overview</a></li>
        <li><a href="#full-bot">Full Python Bot â€” Funding Rate Monitor</a></li>
        <li><a href="#risk">Risk Management</a></li>
        <li><a href="#performance">Performance Expectations &amp; Cost Breakdown</a></li>
        <li><a href="#backtest">Backtesting on Historical Data</a></li>
        <li><a href="#deploy">Live Deployment with pm2</a></li>
        <li><a href="#cta">Get Started</a></li>
      </ol>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- STRATEGY TYPES -->
<section id="strategy-types">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Strategy Taxonomy</div>
      <h2 class="section-title">Four strategies your agent can run</h2>
      <p class="section-desc">Purple Flea's Trading API and Wallet API together enable all four major classes of crypto arbitrage from a single codebase.</p>
    </div>

    <div class="grid-2 reveal reveal-delay-1">
      <div class="card">
        <div class="card-icon purple">&#9654;</div>
        <span class="tag tag-purple">Perp Markets</span>
        <h3>Cross-Exchange Perp Arbitrage</h3>
        <p>The same perpetual contract â€” say BTC-PERP â€” often carries a meaningfully different funding rate on Hyperliquid versus another venue at the same moment. An agent that is long BTC-PERP on the venue paying negative funding and short BTC-PERP on the venue charging positive funding captures the rate differential with zero net delta. The position is fully delta-neutral: if BTC moves 10%, both legs move equally and the P&amp;L stays flat. Only the funding rate spread matters. Purple Flea routes execution through Hyperliquid for the perp leg, giving you 275+ markets and up to 50x leverage with maker fees as low as 0.02%.</p>
      </div>
      <div class="card">
        <div class="card-icon green">&#9632;</div>
        <span class="tag tag-green">Low Risk</span>
        <h3>Basis Trading: Long Spot + Short Perp</h3>
        <p>When perpetual funding rates are persistently positive â€” longs pay shorts every 8 hours â€” the cleanest play is to buy spot ETH via the Wallet API and simultaneously short ETH-PERP via the Trading API at equal notional size. The spot and perp positions cancel out all directional exposure. What remains is a pure funding rate income stream. During bull markets, BTC and ETH funding rates have sustained 0.1% per 8 hours (roughly 50% APY) for weeks at a time. The agent monitors the rate and exits both legs when it drops below a threshold, then re-enters when it recovers.</p>
      </div>
      <div class="card">
        <div class="card-icon blue">&#9670;</div>
        <span class="tag tag-blue">Mean Reversion</span>
        <h3>Statistical Arbitrage</h3>
        <p>BTC and ETH are structurally correlated â€” they rise and fall together about 85% of the time over a rolling 30-day window. When the BTC/ETH price ratio deviates significantly from its rolling mean (more than 2 standard deviations), an agent can go long the underperformer and short the outperformer on the 275+ perp markets available through Purple Flea. This is mean-reversion stat arb: not risk-free, but carrying lower directional exposure than an outright bet. The key parameters are lookback window (typically 30 days), z-score entry threshold, and maximum holding period before forced exit.</p>
      </div>
      <div class="card">
        <div class="card-icon orange">&#9650;</div>
        <span class="tag tag-yellow">Spot Markets</span>
        <h3>Triangular Arbitrage via Wallet API</h3>
        <p>A triangular arb cycles through three tokens in sequence â€” for example USDC &rarr; ETH &rarr; BTC &rarr; USDC â€” exploiting momentary mispricing between the three pairs. If the implied BTC/USDC rate via ETH differs from the direct BTC/USDC rate by more than the round-trip swap cost, traversing the triangle yields a profit. The agent starts and ends in USDC but holds more of it after three swaps complete. All three legs execute via the Wallet API's multi-chain swap endpoint. The key constraint is execution speed: all three swaps must complete before prices move against the position.</p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- API OVERVIEW -->
<section id="apis">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Infrastructure</div>
      <h2 class="section-title">Purple Flea APIs for arbitrage</h2>
      <p class="section-desc">Two API keys, one codebase. The Trading and Wallet APIs handle all execution â€” your agent only needs to detect opportunities and call the right endpoints.</p>
    </div>

    <div class="grid-3 reveal reveal-delay-1">
      <div class="card">
        <div class="card-icon purple">&#9670;</div>
        <h3>Trading API</h3>
        <p style="margin-bottom:12px;">trading.purpleflea.com â€” perpetual futures execution via Hyperliquid. 275+ perp markets, up to 50x leverage. Use for the short perp leg in basis trades, cross-exchange perp arb, and stat arb pairs.</p>
        <p><strong>Key endpoints:</strong> <code>POST /order</code>, <code>GET /funding-rate</code>, <code>GET /positions</code>, <code>DELETE /order</code></p>
      </div>
      <div class="card">
        <div class="card-icon green">&#9632;</div>
        <h3>Wallet API</h3>
        <p style="margin-bottom:12px;">wallet.purpleflea.com â€” multi-chain spot token swaps, balance queries, and transfers. Ethereum, Solana, BNB Chain, Polygon, Base, and more. Use for the spot leg in basis trades and all triangular arb legs.</p>
        <p><strong>Key endpoints:</strong> <code>GET /quote</code>, <code>POST /swap</code>, <code>GET /balances</code></p>
      </div>
      <div class="card">
        <div class="card-icon blue">&#9654;</div>
        <h3>Casino API</h3>
        <p style="margin-bottom:12px;">casino.purpleflea.com â€” provably fair casino games. Not a primary arbitrage surface, but useful for agents that blend yield strategies with entertainment use cases or need to place verifiably random outcomes in multi-strategy portfolios.</p>
        <p><strong>Key endpoints:</strong> <code>POST /bet</code>, <code>GET /games</code>, <code>GET /history</code></p>
      </div>
    </div>

    <!-- Registration steps -->
    <div style="max-width: 820px; margin-top: 60px;">
      <div class="reveal">
        <h3 style="font-size:1.2rem; font-weight:700; margin-bottom:8px; margin-top:0;">Getting your API keys</h3>
        <p style="color:var(--text-secondary); font-size:0.95rem; margin-bottom:28px;">Both APIs require separate registration. Your agent will hold two keys: one for perp execution, one for spot swaps.</p>
      </div>
      <div class="steps reveal reveal-delay-1">
        <div class="step">
          <div class="step-num">1</div>
          <div class="step-content">
            <h3>Register on Trading API</h3>
            <p>Go to <strong>trading.purpleflea.com</strong>, create an account, and generate an API key under Settings &rarr; API Keys. Set the key scope to <em>Trade</em> and <em>Read</em>. Store it as <code>TRADING_API_KEY</code> in your environment.</p>
          </div>
        </div>
        <div class="step">
          <div class="step-num">2</div>
          <div class="step-content">
            <h3>Register on Wallet API</h3>
            <p>Go to <strong>wallet.purpleflea.com</strong>, register a separate account, and generate an API key with <em>Swap</em> and <em>Read</em> scope. Store it as <code>WALLET_API_KEY</code>. Fund your wallet with the stablecoins you want to use as the spot leg.</p>
          </div>
        </div>
        <div class="step">
          <div class="step-num">3</div>
          <div class="step-content">
            <h3>Set environment variables</h3>
            <p>Your bot reads both keys from environment variables so they never appear in source code. On the server: <code>export TRADING_API_KEY=...</code> and <code>export WALLET_API_KEY=...</code>, or add them to your pm2 ecosystem config.</p>
          </div>
        </div>
        <div class="step">
          <div class="step-num">4</div>
          <div class="step-content">
            <h3>Test connectivity</h3>
            <p>Before going live, call <code>GET https://trading.purpleflea.com/v1/account</code> and <code>GET https://wallet.purpleflea.com/v1/balances</code> with your keys to verify authentication and check available balances.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- FULL PYTHON BOT -->
<section id="full-bot">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Full Code Example</div>
      <h2 class="section-title">Complete Python arbitrage bot</h2>
      <p class="section-desc">A production-ready bot that monitors BTC and ETH funding rates every 8 hours and opens a basis trade when the rate exceeds the entry threshold.</p>
    </div>

    <!-- Part 1: Imports, config, registration check -->
    <div style="max-width:820px;" class="reveal reveal-delay-1">
      <div style="margin-bottom:16px;">
        <h3 style="font-size:1.15rem; font-weight:700; margin-bottom:6px; margin-top:0;">Part 1 â€” Setup, configuration, and connectivity check</h3>
        <p style="color:var(--text-secondary); font-size:0.9rem;">Reads API keys from the environment, defines thresholds, and verifies both APIs are reachable before the main loop starts.</p>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">arb_bot.py</span>
        </div>
<span class="kw">import</span> os, time, logging, requests
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass, field
<span class="kw">from</span> typing <span class="kw">import</span> <span class="cls">Optional</span>
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

logging.<span class="fn">basicConfig</span>(
    level=logging.INFO,
    format=<span class="st">"%(asctime)s [%(levelname)s] %(message)s"</span>,
    handlers=[logging.<span class="fn">StreamHandler</span>(), logging.<span class="fn">FileHandler</span>(<span class="st">"arb_bot.log"</span>)]
)
log = logging.<span class="fn">getLogger</span>(<span class="st">"arb_bot"</span>)

<span class="cm"># â”€â”€ Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
TRADING_API_KEY  = os.environ[<span class="st">"TRADING_API_KEY"</span>]   <span class="cm"># from trading.purpleflea.com</span>
WALLET_API_KEY   = os.environ[<span class="st">"WALLET_API_KEY"</span>]    <span class="cm"># from wallet.purpleflea.com</span>

TRADING_BASE = <span class="st">"https://trading.purpleflea.com/v1"</span>
WALLET_BASE  = <span class="st">"https://wallet.purpleflea.com/v1"</span>

<span class="cm"># Strategy parameters</span>
ENTRY_FUNDING_RATE = <span class="num">0.0005</span>   <span class="cm"># open trade when rate > 0.05% per 8h</span>
EXIT_FUNDING_RATE  = <span class="num">0.0001</span>   <span class="cm"># close trade when rate drops below 0.01%</span>
POSITION_SIZE_USD  = <span class="num">500.0</span>    <span class="cm"># notional size per leg in USD</span>
MAX_POSITIONS      = <span class="num">4</span>        <span class="cm"># max concurrent basis trades</span>
POLL_INTERVAL_SEC  = <span class="num">28800</span>    <span class="cm"># 8 hours = one funding cycle</span>
SLIPPAGE_LIMIT_PCT = <span class="num">0.3</span>      <span class="cm"># reject swap if slippage exceeds 0.3%</span>
MAX_DRAWDOWN_PCT   = <span class="num">5.0</span>      <span class="cm"># halt bot if drawdown exceeds 5%</span>

WATCH_ASSETS = [
    {<span class="st">"symbol"</span>: <span class="st">"BTC"</span>, <span class="st">"perp"</span>: <span class="st">"BTC-PERP"</span>, <span class="st">"spot_token"</span>: <span class="st">"WBTC"</span>, <span class="st">"chain"</span>: <span class="st">"ethereum"</span>},
    {<span class="st">"symbol"</span>: <span class="st">"ETH"</span>, <span class="st">"perp"</span>: <span class="st">"ETH-PERP"</span>, <span class="st">"spot_token"</span>: <span class="st">"ETH"</span>,  <span class="st">"chain"</span>: <span class="st">"ethereum"</span>},
]

<span class="at">@dataclass</span>
<span class="kw">class</span> <span class="cls">Position</span>:
    asset:        <span class="cls">str</span>
    perp_id:      <span class="cls">str</span>
    spot_amount:  <span class="cls">float</span>
    entry_rate:   <span class="cls">float</span>
    opened_at:    <span class="cls">str</span>
    funding_earned: <span class="cls">float</span> = <span class="num">0.0</span>

<span class="kw">class</span> <span class="cls">ArbBot</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(self):
        self.positions: <span class="cls">dict</span>[<span class="cls">str</span>, <span class="cls">Position</span>] = {}
        self.starting_equity = <span class="kw">None</span>
        self.trading_session = requests.<span class="fn">Session</span>()
        self.trading_session.headers.<span class="fn">update</span>({
            <span class="st">"Authorization"</span>: <span class="st">f"Bearer {TRADING_API_KEY}"</span>,
            <span class="st">"Content-Type"</span>: <span class="st">"application/json"</span>
        })
        self.wallet_session = requests.<span class="fn">Session</span>()
        self.wallet_session.headers.<span class="fn">update</span>({
            <span class="st">"Authorization"</span>: <span class="st">f"Bearer {WALLET_API_KEY}"</span>,
            <span class="st">"Content-Type"</span>: <span class="st">"application/json"</span>
        })

    <span class="kw">def</span> <span class="fn">check_connectivity</span>(self) -> <span class="cls">bool</span>:
        <span class="st">"""Verify both APIs respond before starting the main loop."""</span>
        <span class="kw">try</span>:
            t = self.trading_session.<span class="fn">get</span>(<span class="st">f"{TRADING_BASE}/account"</span>, timeout=<span class="num">10</span>)
            w = self.wallet_session.<span class="fn">get</span>(<span class="st">f"{WALLET_BASE}/balances"</span>, timeout=<span class="num">10</span>)
            t.<span class="fn">raise_for_status</span>()
            w.<span class="fn">raise_for_status</span>()
            equity = t.<span class="fn">json</span>().<span class="fn">get</span>(<span class="st">"equity_usd"</span>, <span class="num">0</span>)
            self.starting_equity = equity
            log.<span class="fn">info</span>(<span class="st">f"Connected. Trading equity: ${equity:,.2f}"</span>)
            <span class="kw">return True</span>
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Connectivity check failed: {e}"</span>)
            <span class="kw">return False</span>
      </div>
    </div>

    <!-- Part 2: Funding rate monitor -->
    <div style="max-width:820px; margin-top:40px;" class="reveal reveal-delay-2">
      <div style="margin-bottom:16px;">
        <h3 style="font-size:1.15rem; font-weight:700; margin-bottom:6px; margin-top:0;">Part 2 â€” Funding rate monitor and entry logic</h3>
        <p style="color:var(--text-secondary); font-size:0.9rem;">Polls the Trading API for current funding rates every 8 hours. When a rate exceeds the entry threshold and a position does not already exist, it opens both legs.</p>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">arb_bot.py (continued)</span>
        </div>
    <span class="kw">def</span> <span class="fn">get_funding_rate</span>(self, perp: <span class="cls">str</span>) -> <span class="cls">Optional</span>[<span class="cls">float</span>]:
        <span class="st">"""Fetch current 8h funding rate for a perp market."""</span>
        <span class="kw">try</span>:
            r = self.trading_session.<span class="fn">get</span>(
                <span class="st">f"{TRADING_BASE}/funding-rate"</span>,
                params={<span class="st">"market"</span>: perp},
                timeout=<span class="num">10</span>
            )
            r.<span class="fn">raise_for_status</span>()
            rate = r.<span class="fn">json</span>()[<span class="st">"funding_rate"</span>]
            log.<span class="fn">info</span>(<span class="st">f"Funding rate {perp}: {rate*100:.4f}% per 8h"</span>)
            <span class="kw">return</span> rate
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Failed to fetch funding rate for {perp}: {e}"</span>)
            <span class="kw">return None</span>

    <span class="kw">def</span> <span class="fn">open_basis_trade</span>(self, asset: <span class="cls">dict</span>, rate: <span class="cls">float</span>) -> <span class="cls">bool</span>:
        <span class="st">"""
        Open a basis trade:
          1. Buy spot via Wallet API  (long the asset)
          2. Short the perp via Trading API  (short the futures)
        Result: delta-neutral, collecting funding from shorts.
        """</span>
        symbol = asset[<span class="st">"symbol"</span>]
        log.<span class="fn">info</span>(<span class="st">f"Opening basis trade on {symbol} | rate={rate*100:.4f}%"</span>)

        <span class="cm"># Step 1: Get spot quote to check slippage before committing</span>
        <span class="kw">try</span>:
            q = self.wallet_session.<span class="fn">get</span>(
                <span class="st">f"{WALLET_BASE}/quote"</span>,
                params={
                    <span class="st">"from_token"</span>: <span class="st">"USDC"</span>,
                    <span class="st">"to_token"</span>:   asset[<span class="st">"spot_token"</span>],
                    <span class="st">"amount_usd"</span>:  POSITION_SIZE_USD,
                    <span class="st">"chain"</span>:       asset[<span class="st">"chain"</span>]
                },
                timeout=<span class="num">10</span>
            )
            q.<span class="fn">raise_for_status</span>()
            quote = q.<span class="fn">json</span>()
            slippage = quote.<span class="fn">get</span>(<span class="st">"price_impact_pct"</span>, <span class="num">0</span>)
            <span class="kw">if</span> slippage > SLIPPAGE_LIMIT_PCT:
                log.<span class="fn">warning</span>(<span class="st">f"Spot slippage {slippage:.2f}% exceeds limit â€” skipping {symbol}"</span>)
                <span class="kw">return False</span>
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Quote failed for {symbol}: {e}"</span>)
            <span class="kw">return False</span>

        <span class="cm"># Step 2: Execute spot buy</span>
        <span class="kw">try</span>:
            swap = self.wallet_session.<span class="fn">post</span>(
                <span class="st">f"{WALLET_BASE}/swap"</span>,
                json={
                    <span class="st">"from_token"</span>:    <span class="st">"USDC"</span>,
                    <span class="st">"to_token"</span>:      asset[<span class="st">"spot_token"</span>],
                    <span class="st">"amount_usd"</span>:     POSITION_SIZE_USD,
                    <span class="st">"chain"</span>:          asset[<span class="st">"chain"</span>],
                    <span class="st">"max_slippage_pct"</span>: SLIPPAGE_LIMIT_PCT
                },
                timeout=<span class="num">30</span>
            )
            swap.<span class="fn">raise_for_status</span>()
            spot_amount = swap.<span class="fn">json</span>()[<span class="st">"out_amount"</span>]
            log.<span class="fn">info</span>(<span class="st">f"Spot buy confirmed: {spot_amount:.6f} {symbol}"</span>)
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Spot swap failed for {symbol}: {e}"</span>)
            <span class="kw">return False</span>

        <span class="cm"># Step 3: Open short perp at the same notional size</span>
        <span class="kw">try</span>:
            order = self.trading_session.<span class="fn">post</span>(
                <span class="st">f"{TRADING_BASE}/order"</span>,
                json={
                    <span class="st">"market"</span>:    asset[<span class="st">"perp"</span>],
                    <span class="st">"side"</span>:      <span class="st">"sell"</span>,
                    <span class="st">"size_usd"</span>:  POSITION_SIZE_USD,
                    <span class="st">"type"</span>:      <span class="st">"market"</span>,
                    <span class="st">"reduce_only"</span>: <span class="cls">False</span>
                },
                timeout=<span class="num">15</span>
            )
            order.<span class="fn">raise_for_status</span>()
            perp_id = order.<span class="fn">json</span>()[<span class="st">"order_id"</span>]
            log.<span class="fn">info</span>(<span class="st">f"Perp short confirmed: {asset['perp']} order_id={perp_id}"</span>)
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Perp order failed for {symbol}: {e} â€” unwinding spot"</span>)
            self.<span class="fn">_unwind_spot</span>(asset, spot_amount)
            <span class="kw">return False</span>

        self.positions[symbol] = <span class="cls">Position</span>(
            asset=symbol,
            perp_id=perp_id,
            spot_amount=spot_amount,
            entry_rate=rate,
            opened_at=datetime.<span class="fn">utcnow</span>().<span class="fn">isoformat</span>()
        )
        log.<span class="fn">info</span>(<span class="st">f"Basis trade OPEN: {symbol} | expected ~{rate*100*3:.3f}%/day"</span>)
        <span class="kw">return True</span>
      </div>
    </div>

    <!-- Part 3: Exit and main loop -->
    <div style="max-width:820px; margin-top:40px;" class="reveal">
      <div style="margin-bottom:16px;">
        <h3 style="font-size:1.15rem; font-weight:700; margin-bottom:6px; margin-top:0;">Part 3 â€” Exit logic, drawdown guard, and main loop</h3>
        <p style="color:var(--text-secondary); font-size:0.9rem;">Closes positions when funding rates fall below the exit threshold. The drawdown guard halts the bot if total equity drops more than the configured maximum.</p>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">arb_bot.py (continued)</span>
        </div>
    <span class="kw">def</span> <span class="fn">close_basis_trade</span>(self, symbol: <span class="cls">str</span>, reason: <span class="cls">str</span> = <span class="st">"rate_below_exit"</span>):
        <span class="st">"""Close both legs of an existing basis trade."""</span>
        pos = self.positions.<span class="fn">get</span>(symbol)
        <span class="kw">if not</span> pos:
            <span class="kw">return</span>
        asset = <span class="fn">next</span>(a <span class="kw">for</span> a <span class="kw">in</span> WATCH_ASSETS <span class="kw">if</span> a[<span class="st">"symbol"</span>] == symbol)

        <span class="cm"># Close perp short first (faster, no bridge)</span>
        <span class="kw">try</span>:
            self.trading_session.<span class="fn">post</span>(
                <span class="st">f"{TRADING_BASE}/order"</span>,
                json={<span class="st">"market"</span>: asset[<span class="st">"perp"</span>], <span class="st">"side"</span>: <span class="st">"buy"</span>,
                      <span class="st">"size_usd"</span>: POSITION_SIZE_USD, <span class="st">"type"</span>: <span class="st">"market"</span>, <span class="st">"reduce_only"</span>: <span class="cls">True</span>},
                timeout=<span class="num">15</span>
            ).<span class="fn">raise_for_status</span>()
            log.<span class="fn">info</span>(<span class="st">f"Perp short closed for {symbol}"</span>)
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Perp close failed for {symbol}: {e}"</span>)

        <span class="cm"># Sell spot back to USDC</span>
        self.<span class="fn">_unwind_spot</span>(asset, pos.spot_amount)
        <span class="kw">del</span> self.positions[symbol]
        log.<span class="fn">info</span>(<span class="st">f"Basis trade CLOSED: {symbol} | reason={reason} | funding_earned=${pos.funding_earned:.4f}"</span>)

    <span class="kw">def</span> <span class="fn">_unwind_spot</span>(self, asset: <span class="cls">dict</span>, amount: <span class="cls">float</span>):
        <span class="st">"""Sell spot tokens back to USDC via Wallet API."""</span>
        <span class="kw">try</span>:
            self.wallet_session.<span class="fn">post</span>(
                <span class="st">f"{WALLET_BASE}/swap"</span>,
                json={<span class="st">"from_token"</span>: asset[<span class="st">"spot_token"</span>], <span class="st">"to_token"</span>: <span class="st">"USDC"</span>,
                      <span class="st">"amount_tokens"</span>: amount, <span class="st">"chain"</span>: asset[<span class="st">"chain"</span>],
                      <span class="st">"max_slippage_pct"</span>: SLIPPAGE_LIMIT_PCT},
                timeout=<span class="num">30</span>
            ).<span class="fn">raise_for_status</span>()
            log.<span class="fn">info</span>(<span class="st">f"Spot {asset['symbol']} unwound to USDC"</span>)
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            log.<span class="fn">error</span>(<span class="st">f"Spot unwind failed for {asset['symbol']}: {e}"</span>)

    <span class="kw">def</span> <span class="fn">check_drawdown</span>(self) -> <span class="cls">bool</span>:
        <span class="st">"""Return True if drawdown exceeds threshold (bot should halt)."""</span>
        <span class="kw">if</span> self.starting_equity <span class="kw">is None</span>:
            <span class="kw">return False</span>
        <span class="kw">try</span>:
            r = self.trading_session.<span class="fn">get</span>(<span class="st">f"{TRADING_BASE}/account"</span>, timeout=<span class="num">10</span>)
            r.<span class="fn">raise_for_status</span>()
            current = r.<span class="fn">json</span>().<span class="fn">get</span>(<span class="st">"equity_usd"</span>, self.starting_equity)
            drawdown = (self.starting_equity - current) / self.starting_equity * <span class="num">100</span>
            <span class="kw">if</span> drawdown >= MAX_DRAWDOWN_PCT:
                log.<span class="fn">critical</span>(<span class="st">f"DRAWDOWN HALT: {drawdown:.2f}% >= {MAX_DRAWDOWN_PCT}%"</span>)
                <span class="kw">return True</span>
        <span class="kw">except</span> <span class="cls">Exception</span>:
            <span class="kw">pass</span>
        <span class="kw">return False</span>

    <span class="kw">def</span> <span class="fn">run</span>(self):
        <span class="st">"""Main loop: poll every 8 hours, open/close as needed."""</span>
        log.<span class="fn">info</span>(<span class="st">"Arb bot starting..."</span>)
        <span class="kw">if not</span> self.<span class="fn">check_connectivity</span>():
            <span class="kw">raise</span> <span class="cls">RuntimeError</span>(<span class="st">"API connectivity check failed. Check keys and network."</span>)

        <span class="kw">while True</span>:
            log.<span class="fn">info</span>(<span class="st">"=== Funding rate scan ==="</span>)

            <span class="kw">if</span> self.<span class="fn">check_drawdown</span>():
                <span class="cm"># Close all positions and stop</span>
                <span class="kw">for</span> sym <span class="kw">in</span> <span class="cls">list</span>(self.positions.keys()):
                    self.<span class="fn">close_basis_trade</span>(sym, reason=<span class="st">"drawdown_halt"</span>)
                log.<span class="fn">critical</span>(<span class="st">"All positions closed. Bot halted due to drawdown."</span>)
                <span class="kw">break</span>

            <span class="kw">for</span> asset <span class="kw">in</span> WATCH_ASSETS:
                sym  = asset[<span class="st">"symbol"</span>]
                rate = self.<span class="fn">get_funding_rate</span>(asset[<span class="st">"perp"</span>])
                <span class="kw">if</span> rate <span class="kw">is None</span>:
                    <span class="kw">continue</span>

                <span class="kw">if</span> sym <span class="kw">in</span> self.positions:
                    <span class="cm"># Already in trade: check exit condition</span>
                    <span class="kw">if</span> rate < EXIT_FUNDING_RATE:
                        self.<span class="fn">close_basis_trade</span>(sym)
                    <span class="kw">else</span>:
                        <span class="cm"># Accrue estimated funding income</span>
                        self.positions[sym].funding_earned += POSITION_SIZE_USD * rate
                        log.<span class="fn">info</span>(<span class="st">f"Holding {sym} | rate={rate*100:.4f}% | earned=${self.positions[sym].funding_earned:.2f}"</span>)
                <span class="kw">else</span>:
                    <span class="cm"># Not in trade: check entry condition</span>
                    <span class="kw">if</span> rate >= ENTRY_FUNDING_RATE <span class="kw">and</span> <span class="cls">len</span>(self.positions) < MAX_POSITIONS:
                        self.<span class="fn">open_basis_trade</span>(asset, rate)
                    <span class="kw">else</span>:
                        log.<span class="fn">info</span>(<span class="st">f"No trade on {sym}: rate={rate*100:.4f}% (need >={ENTRY_FUNDING_RATE*100:.4f}%)"</span>)

            log.<span class="fn">info</span>(<span class="st">f"Open positions: {list(self.positions.keys())} | sleeping {POLL_INTERVAL_SEC}s"</span>)
            time.<span class="fn">sleep</span>(POLL_INTERVAL_SEC)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    <span class="cls">ArbBot</span>().<span class="fn">run</span>()
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RISK MANAGEMENT -->
<section id="risk">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Risk Management</div>
      <h2 class="section-title">Position limits, drawdown stops, and slippage budgets</h2>
      <p class="section-desc">Arbitrage strategies feel safe but carry real execution risks. A well-built bot enforces hard limits at every layer.</p>
    </div>

    <div class="grid-3 reveal reveal-delay-1">
      <div class="card">
        <div class="card-icon green">&#9632;</div>
        <h3>Position Limits</h3>
        <p>Never deploy more than 20-25% of total capital in a single basis trade. The bot above uses a hard <code>MAX_POSITIONS = 4</code> cap so that no more than four simultaneous trades are open regardless of how attractive rates look. Concentration kills more arb bots than bad strategy logic does.</p>
      </div>
      <div class="card">
        <div class="card-icon red">&#9650;</div>
        <h3>Drawdown Stop</h3>
        <p>The <code>check_drawdown()</code> method compares current equity to starting equity every cycle. If total drawdown exceeds 5%, all positions are closed and the bot halts. Set this conservatively â€” 3-5% is right for a newly deployed strategy with limited live track record. Increase only after demonstrating consistent profitability over 30+ days.</p>
      </div>
      <div class="card">
        <div class="card-icon orange">&#9670;</div>
        <h3>Slippage Budget</h3>
        <p>Every swap call includes <code>max_slippage_pct</code>. If the Wallet API quotes slippage above this limit, the spot leg is skipped entirely. Default is 0.3% â€” which is conservative enough to prevent bad fills but permissive enough that real opportunities aren't unnecessarily blocked. Tighten to 0.15% for liquid assets like BTC and ETH on mainnet.</p>
      </div>
      <div class="card">
        <div class="card-icon blue">&#9654;</div>
        <h3>Leg Failure Recovery</h3>
        <p>The bot always opens the spot leg first, then the perp leg. If the perp order fails, <code>_unwind_spot()</code> immediately sells the spot tokens back to USDC. This prevents holding a naked long spot position without the offsetting short. Log all partial fills and never assume both legs executed without confirmation from both APIs.</p>
      </div>
      <div class="card">
        <div class="card-icon purple">&#9632;</div>
        <h3>Funding Rate Reversals</h3>
        <p>A funding rate that was 0.1% at open can drop to negative within a single 8-hour cycle if sentiment shifts. Negative funding means your short perp is now paying longs rather than collecting. The <code>EXIT_FUNDING_RATE = 0.0001</code> threshold exits well before the rate goes negative, preserving most of the collected income.</p>
      </div>
      <div class="card">
        <div class="card-icon green">&#9670;</div>
        <h3>Gas and Fee Accounting</h3>
        <p>Each round-trip (open + close) costs approximately two swap fees on the spot leg and two order fees on the perp leg. With a 0.3% swap fee and 0.05% taker perp fee, total round-trip friction is roughly 0.7%. A trade must collect more than 0.7% in funding to be net profitable. At 0.05% per 8 hours, break-even is after roughly 4.7 funding periods (~38 hours held).</p>
      </div>
    </div>

    <div class="reveal" style="max-width:820px; margin-top:48px;">
      <div class="warning-box">
        <p><strong>Important:</strong> Basis trading is not risk-free. The primary risks are liquidation of the perp leg during extreme volatility (use low leverage â€” 1x to 2x is standard for basis trades), spot token price movement against you between leg execution, and API downtime leaving one leg open without the hedge. Always monitor positions and set up alerts for abnormal account equity changes.</p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- PERFORMANCE -->
<section id="performance">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Realistic Expectations</div>
      <h2 class="section-title">Performance expectations and cost breakdown</h2>
      <p class="section-desc">What a basis trading bot can realistically earn, and where the costs come from.</p>
    </div>

    <div style="max-width:820px;" class="reveal reveal-delay-1">
      <div class="prose">
        <h3>Funding Rate Income</h3>
        <p>
          Funding rates fluctuate substantially with market sentiment. In strong bull markets, BTC and ETH perp funding has sustained 0.05-0.15% per 8-hour period for weeks, implying 54-164% annualized gross yield. In sideways or bear markets, rates frequently drop to 0.01% or below, and sometimes go negative. A realistic long-run average for a strategy that only enters at high rates and exits early is 15-30% gross APY on deployed capital.
        </p>
        <h3>Cost Breakdown Per Round-Trip</h3>
      </div>
      <div class="table-wrap">
        <table class="perf-table">
          <thead>
            <tr>
              <th>Cost Item</th>
              <th>Typical Rate</th>
              <th>On $500 Trade</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Spot swap fee (open)</td>
              <td>0.25-0.35%</td>
              <td class="yellow">~$1.50</td>
              <td>Wallet API routes to best DEX</td>
            </tr>
            <tr>
              <td>Perp order fee â€” taker (open)</td>
              <td>0.05%</td>
              <td class="yellow">$0.25</td>
              <td>Market order on Trading API</td>
            </tr>
            <tr>
              <td>Perp order fee â€” taker (close)</td>
              <td>0.05%</td>
              <td class="yellow">$0.25</td>
              <td>Reduce-only market close</td>
            </tr>
            <tr>
              <td>Spot swap fee (close)</td>
              <td>0.25-0.35%</td>
              <td class="yellow">~$1.50</td>
              <td>Selling spot tokens back to USDC</td>
            </tr>
            <tr>
              <td>Gas (Ethereum mainnet)</td>
              <td>$8-25</td>
              <td class="red">~$15</td>
              <td>Dominant cost on Ethereum; use L2 to reduce</td>
            </tr>
            <tr>
              <td><strong>Total round-trip cost</strong></td>
              <td></td>
              <td class="red"><strong>~$18.50</strong></td>
              <td>Must earn >$18.50 in funding to profit</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="prose">
        <div class="formula-block">
Break-even holding time at 0.05% / 8h on $500 trade:<br>
Funding per period  = $500 x 0.0005 = $0.25<br>
Total cost          = $18.50<br>
Periods to break-even = $18.50 / $0.25 = 74 periods = 24.7 days<br><br>
At higher rates (0.1% / 8h):<br>
Funding per period  = $500 x 0.001 = $0.50<br>
Periods to break-even = $18.50 / $0.50 = 37 periods = 12.3 days<br><br>
Implication: gas cost dominates on small trades on Ethereum mainnet.<br>
For positions under $5,000, use Polygon or Base to reduce gas to <$0.10.
        </div>
        <h3>Scaling and Capital Efficiency</h3>
        <p>
          Gas costs are mostly fixed per transaction regardless of trade size. Scaling from $500 to $5,000 per leg multiplies funding income 10x while adding almost no incremental gas. The break-even period on a $5,000 trade at 0.05% / 8h is under 3 days. This makes larger-capital deployments significantly more efficient for basis trading on Ethereum mainnet. The bot's <code>POSITION_SIZE_USD</code> variable is the primary lever for capital efficiency.
        </p>
        <div class="info-box">
          <p><strong>Maker fee advantage:</strong> The Trading API charges 0.02% for maker orders versus 0.05% for taker. For the perp leg, use limit orders priced just inside the spread when market conditions allow. This reduces round-trip perp cost from 0.10% to 0.04%, saving $0.30 per $500 trade â€” meaningful at scale.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- BACKTESTING -->
<section id="backtest">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Historical Validation</div>
      <h2 class="section-title">Backtesting on historical funding rate data</h2>
      <p class="section-desc">Before deploying capital, run your strategy parameters against historical data to estimate expected returns and validate the entry/exit thresholds.</p>
    </div>

    <div style="max-width:820px;" class="reveal reveal-delay-1">
      <div class="prose">
        <p>
          The backtest below downloads historical funding rate data from a public API and simulates the bot's entry and exit logic over the dataset. It tracks gross funding income, deducts round-trip costs for each trade, and outputs a per-day P&amp;L ledger alongside aggregate statistics.
        </p>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">backtest.py</span>
        </div>
<span class="kw">import</span> json, requests, csv
<span class="kw">from</span> datetime <span class="kw">import</span> datetime, timedelta

<span class="cm"># â”€â”€ Parameters (must match live bot) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
ENTRY_RATE      = <span class="num">0.0005</span>
EXIT_RATE       = <span class="num">0.0001</span>
POS_SIZE_USD    = <span class="num">5000.0</span>    <span class="cm"># larger size for realistic gas efficiency</span>
ROUND_TRIP_COST = <span class="num">18.50</span>     <span class="cm"># fixed cost per trade open + close ($)</span>
SWAP_FEE_PCT    = <span class="num">0.003</span>     <span class="cm"># 0.3% per swap leg (2 swaps per round-trip)</span>
PERP_FEE_PCT    = <span class="num">0.0005</span>    <span class="cm"># 0.05% taker per leg (2 legs per round-trip)</span>

<span class="kw">def</span> <span class="fn">fetch_historical_rates</span>(market: <span class="cls">str</span>, days: <span class="cls">int</span> = <span class="num">180</span>) -> <span class="cls">list</span>:
    <span class="st">"""
    Fetch historical 8-hour funding rates.
    Hyperliquid public API returns rates without authentication.
    """</span>
    end_ms   = <span class="cls">int</span>(datetime.<span class="fn">utcnow</span>().<span class="fn">timestamp</span>() * <span class="num">1000</span>)
    start_ms = end_ms - days * <span class="num">86400</span> * <span class="num">1000</span>
    url = <span class="st">"https://api.hyperliquid.xyz/info"</span>
    payload = {
        <span class="st">"type"</span>: <span class="st">"fundingHistory"</span>,
        <span class="st">"coin"</span>: market.<span class="fn">replace</span>(<span class="st">"-PERP"</span>, <span class="st">""</span>),
        <span class="st">"startTime"</span>: start_ms
    }
    r = requests.<span class="fn">post</span>(url, json=payload, timeout=<span class="num">15</span>)
    r.<span class="fn">raise_for_status</span>()
    <span class="kw">return</span> r.<span class="fn">json</span>()  <span class="cm"># list of {time, fundingRate, premium}</span>

<span class="kw">def</span> <span class="fn">run_backtest</span>(market: <span class="cls">str</span> = <span class="st">"BTC-PERP"</span>):
    <span class="fn">print</span>(<span class="st">f"Backtesting {market} over 180 days..."</span>)
    data = <span class="fn">fetch_historical_rates</span>(market, days=<span class="num">180</span>)
    <span class="fn">print</span>(<span class="st">f"Loaded {len(data)} funding periods"</span>)

    in_trade       = <span class="cls">False</span>
    entry_period   = <span class="kw">None</span>
    total_pnl      = <span class="num">0.0</span>
    total_trades   = <span class="num">0</span>
    total_income   = <span class="num">0.0</span>
    total_costs    = <span class="num">0.0</span>
    periods_held   = <span class="num">0</span>
    trade_log      = []

    var_cost_per_rt = POS_SIZE_USD * (SWAP_FEE_PCT * <span class="num">2</span> + PERP_FEE_PCT * <span class="num">2</span>)

    <span class="kw">for</span> period <span class="kw">in</span> data:
        rate    = <span class="cls">float</span>(period[<span class="st">"fundingRate"</span>])
        ts      = datetime.<span class="fn">fromtimestamp</span>(period[<span class="st">"time"</span>] / <span class="num">1000</span>)

        <span class="kw">if not</span> in_trade:
            <span class="kw">if</span> rate >= ENTRY_RATE:
                in_trade     = <span class="cls">True</span>
                entry_period = ts
                periods_held = <span class="num">0</span>
                trade_income = <span class="num">0.0</span>
        <span class="kw">else</span>:
            trade_income += POS_SIZE_USD * rate
            periods_held += <span class="num">1</span>

            <span class="kw">if</span> rate < EXIT_RATE:
                cost    = ROUND_TRIP_COST + var_cost_per_rt
                net     = trade_income - cost
                total_pnl    += net
                total_income += trade_income
                total_costs  += cost
                total_trades += <span class="num">1</span>
                trade_log.<span class="fn">append</span>({
                    <span class="st">"opened"</span>: entry_period.<span class="fn">date</span>().<span class="fn">isoformat</span>(),
                    <span class="st">"closed"</span>: ts.<span class="fn">date</span>().<span class="fn">isoformat</span>(),
                    <span class="st">"periods"</span>: periods_held,
                    <span class="st">"income"</span>: <span class="fn">round</span>(trade_income, <span class="num">4</span>),
                    <span class="st">"cost"</span>: <span class="fn">round</span>(cost, <span class="num">4</span>),
                    <span class="st">"net"</span>: <span class="fn">round</span>(net, <span class="num">4</span>)
                })
                in_trade = <span class="cls">False</span>

    <span class="fn">print</span>(<span class="st">f"\n{'='*50}"</span>)
    <span class="fn">print</span>(<span class="st">f"Total trades:        {total_trades}"</span>)
    <span class="fn">print</span>(<span class="st">f"Gross income:        ${total_income:,.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Total costs:         ${total_costs:,.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Net P&L:             ${total_pnl:,.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Net ROI on ${POS_SIZE_USD:,.0f}:  {total_pnl/POS_SIZE_USD*100:.2f}% over 180 days"</span>)
    <span class="fn">print</span>(<span class="st">f"Annualized:          {total_pnl/POS_SIZE_USD*100*2:.2f}%"</span>)

    <span class="cm"># Export trade log to CSV</span>
    <span class="kw">with</span> <span class="fn">open</span>(<span class="st">"backtest_log.csv"</span>, <span class="st">"w"</span>, newline=<span class="st">""</span>) <span class="kw">as</span> f:
        w = csv.<span class="fn">DictWriter</span>(f, fieldnames=[<span class="st">"opened"</span>, <span class="st">"closed"</span>, <span class="st">"periods"</span>, <span class="st">"income"</span>, <span class="st">"cost"</span>, <span class="st">"net"</span>])
        w.<span class="fn">writeheader</span>()
        w.<span class="fn">writerows</span>(trade_log)
    <span class="fn">print</span>(<span class="st">f"Trade log written to backtest_log.csv ({len(trade_log)} trades)"</span>)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    <span class="fn">run_backtest</span>(<span class="st">"BTC-PERP"</span>)
    <span class="fn">run_backtest</span>(<span class="st">"ETH-PERP"</span>)
      </div>
    </div>

    <div style="max-width:820px; margin-top:28px;" class="reveal">
      <div class="info-box">
        <p><strong>Interpreting backtest results:</strong> A 180-day backtest covering one full market cycle (a bull run followed by a correction) is the minimum meaningful sample. Run the same parameters over multiple 6-month windows to check consistency. Strategies that only work in bull market windows are not robust â€” look for positive net P&amp;L in sideways and mildly bearish windows too, even if returns are lower.</p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- DEPLOYMENT -->
<section id="deploy">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Production Deployment</div>
      <h2 class="section-title">Live deployment with pm2</h2>
      <p class="section-desc">The bot runs as a long-lived Python process managed by pm2, with automatic restarts on crash and structured log output.</p>
    </div>

    <div style="max-width:820px;" class="reveal reveal-delay-1">
      <div class="prose">
        <h3>Install dependencies</h3>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">terminal</span>
        </div>
<span class="cm"># Python dependencies</span>
pip install requests

<span class="cm"># pm2 (global install via npm)</span>
npm install -g pm2

<span class="cm"># Verify pm2 is available</span>
pm2 --version
      </div>

      <div class="prose">
        <h3>pm2 ecosystem config</h3>
        <p>Create the ecosystem file as a CommonJS module so pm2 can parse it regardless of whether your project uses ESM. Environment variables for API keys are injected here so they never appear in application source.</p>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">ecosystem.config.cjs</span>
        </div>
module.exports = {
  apps: [{
    name: <span class="st">"arb-bot"</span>,
    script: <span class="st">"python3"</span>,
    args: <span class="st">"arb_bot.py"</span>,
    cwd: <span class="st">"/opt/arb-bot"</span>,
    interpreter: <span class="st">"none"</span>,
    watch: <span class="cls">false</span>,
    autorestart: <span class="cls">true</span>,
    max_restarts: <span class="num">10</span>,
    restart_delay: <span class="num">15000</span>,   <span class="cm">// 15s between restarts</span>
    log_file: <span class="st">"/var/log/arb-bot/combined.log"</span>,
    out_file: <span class="st">"/var/log/arb-bot/out.log"</span>,
    error_file: <span class="st">"/var/log/arb-bot/err.log"</span>,
    log_date_format: <span class="st">"YYYY-MM-DD HH:mm:ss"</span>,
    env: {
      TRADING_API_KEY: <span class="st">"pf_trading_sk_..."</span>,  <span class="cm">// replace with real key</span>
      WALLET_API_KEY:  <span class="st">"pf_wallet_sk_..."</span>,   <span class="cm">// replace with real key</span>
      PYTHONUNBUFFERED: <span class="st">"1"</span>                   <span class="cm">// ensures logs flush immediately</span>
    }
  }]
}
      </div>

      <div class="prose">
        <h3>Start and manage the bot</h3>
      </div>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">terminal</span>
        </div>
<span class="cm"># Create log directory</span>
mkdir -p /var/log/arb-bot

<span class="cm"># Start the bot</span>
pm2 start ecosystem.config.cjs

<span class="cm"># Monitor in real time</span>
pm2 logs arb-bot

<span class="cm"># Check status</span>
pm2 status

<span class="cm"># Persist across server reboots</span>
pm2 startup
pm2 save

<span class="cm"># Restart after config changes</span>
pm2 restart arb-bot

<span class="cm"># Stop gracefully</span>
pm2 stop arb-bot
      </div>

      <div class="prose">
        <h3>Recommended server spec</h3>
        <p>
          The bot sleeps for 8 hours between active cycles â€” it is not a high-frequency system. A 1-vCPU / 512 MB RAM VPS (Hetzner CX11, DigitalOcean Basic $4/mo) is more than sufficient. Co-locate in a European datacenter for lowest latency to Hyperliquid's infrastructure. Ensure your server has reliable NTP synchronization â€” funding rate timestamps must be accurate to avoid off-cycle polling.
        </p>
        <div class="warning-box">
          <p><strong>Security note:</strong> Never commit API keys to source control. The ecosystem config contains plaintext credentials â€” restrict its file permissions to the deploy user only: <code>chmod 600 ecosystem.config.cjs</code>. For production deployments, prefer injecting secrets via environment variables in your CI/CD pipeline rather than storing them in the config file.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RELATED -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Related Guides</div>
      <h2 class="section-title">Go deeper.</h2>
    </div>
    <div class="related-grid reveal reveal-delay-1">
      <a href="/trading-api/" class="related-card">
        <div class="label">API Reference</div>
        <div class="title">Trading API Docs</div>
        <div class="desc">Full endpoint reference for perpetual futures orders, positions, and funding</div>
      </a>
      <a href="/crypto-wallet-api/" class="related-card">
        <div class="label">API Reference</div>
        <div class="title">Crypto Wallet API</div>
        <div class="desc">Multi-chain swaps, balances, and token transfers across 10+ networks</div>
      </a>
      <a href="/funding-rate-arbitrage/" class="related-card">
        <div class="label">Strategy Guide</div>
        <div class="title">Funding Rate Arbitrage</div>
        <div class="desc">Deep-dive into delta-neutral perp strategies for passive yield</div>
      </a>
    </div>
  </div>
</section>

<!-- CTA -->
<section id="cta" class="cta-section">
  <div class="container">
    <div class="cta-box reveal">
      <h2>Start building your<br>arbitrage agent <span style="color:var(--purple)">today.</span></h2>
      <p>Register for the Trading API to access 275+ perp markets and Hyperliquid execution. Register for the Wallet API to handle the spot leg and multi-chain swaps. Both are free to start.</p>
      <div class="cta-buttons">
        <a href="https://trading.purpleflea.com" class="btn-primary" target="_blank">Register for Trading API &rarr;</a>
        <a href="https://wallet.purpleflea.com" class="btn-secondary" target="_blank">Register for Wallet API</a>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<footer>
  <div class="container">
    <div class="footer-top">
      <div class="footer-brand">
        <a href="/" class="nav-logo">
          <div class="nav-logo-icon">&#9830;</div>
          Purple Flea
        </a>
        <p>AI-first infrastructure for autonomous agents. Built for machines, verified by math.</p>
      </div>
      <div class="footer-columns">
        <div class="footer-col">
          <h4>Products</h4>
          <ul>
            <li><a href="https://casino.purpleflea.com" target="_blank">Casino</a></li>
            <li><a href="https://trading.purpleflea.com" target="_blank">Trading</a></li>
            <li><a href="https://wallet.purpleflea.com" target="_blank">Wallet</a></li>
            <li><a href="https://domains.purpleflea.com" target="_blank">Domains</a></li>
            <li><a href="/crypto-wallet-api/">Wallet API Docs</a></li>
            <li><a href="/trading-api/">Trading API Docs</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Developers</h4>
          <ul>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/for-agents">For Agents</a></li>
            <li><a href="/for-langchain/">LangChain</a></li>
            <li><a href="/for-crewai/">CrewAI</a></li>
            <li><a href="/for-claude/">Claude / MCP</a></li>
            <li><a href="/quick-start">Quick Start</a></li>
            <li><a href="/openapi">OpenAPI</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <ul>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/stats">Stats</a></li>
            <li><a href="/changelog">Changelog</a></li>
            <li><a href="/blog/">Blog</a></li>
            <li><a href="mailto:hello@purpleflea.com">Contact</a></li>
            <li><a href="https://github.com/Purple-flea" target="_blank">GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Purple Flea. All rights reserved.</p>
      <div class="footer-social">
        <a href="https://github.com/Purple-flea" target="_blank">GitHub</a>
        <a href="https://x.com/purpleflea" target="_blank">X / Twitter</a>
      </div>
    </div>
  </div>
</footer>

<script>
const navbar = document.getElementById('navbar');
window.addEventListener('scroll', () => {
  navbar.classList.toggle('scrolled', window.scrollY > 50);
});
const revealEls = document.querySelectorAll('.reveal');
const revealObs = new IntersectionObserver((entries) => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      e.target.classList.add('visible');
      revealObs.unobserve(e.target);
    }
  });
}, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });
revealEls.forEach(el => revealObs.observe(el));
</script>
</body>
</html>
