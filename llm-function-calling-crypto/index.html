<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LLM Function Calling for Crypto — Purple Flea API</title>
  <meta name="description" content="Use LLM function calling to give AI models crypto superpowers. Purple Flea provides function schemas for OpenAI, Anthropic, and Gemini." />
  <link rel="canonical" href="https://purpleflea.com/llm-function-calling-crypto" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://purpleflea.com/llm-function-calling-crypto" />
  <meta property="og:title" content="LLM Function Calling for Crypto — Purple Flea API" />
  <meta property="og:description" content="Use LLM function calling to give AI models crypto superpowers. Purple Flea provides function schemas for OpenAI, Anthropic, and Gemini." />
  <meta property="og:image" content="https://purpleflea.com/og-image.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="LLM Function Calling for Crypto — Purple Flea API" />
  <meta name="twitter:description" content="Use LLM function calling to give AI models crypto superpowers. Purple Flea provides function schemas for OpenAI, Anthropic, and Gemini." />
  <meta name="twitter:image" content="https://purpleflea.com/og-image.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --purple: #A855F7;
      --purple-dim: #7C3AED;
      --bg: #09090B;
      --bg-card: rgba(255,255,255,0.03);
      --border: rgba(255,255,255,0.06);
      --text: #FAFAFA;
      --text-secondary: #A1A1AA;
      --text-muted: #71717A;
      --green: #22C55E;
      --mono: 'JetBrains Mono', monospace;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      line-height: 1.6;
      font-size: 16px;
    }

    a { color: var(--purple); text-decoration: none; }
    a:hover { color: var(--text); }

    /* NAV */
    nav {
      border-bottom: 1px solid var(--border);
      padding: 0 24px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      background: rgba(9,9,11,0.92);
      backdrop-filter: blur(12px);
      z-index: 100;
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      font-size: 17px;
      color: var(--text);
      text-decoration: none;
    }

    .nav-logo .diamond {
      color: var(--purple);
      font-size: 20px;
      line-height: 1;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 28px;
      list-style: none;
    }

    .nav-links a {
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 500;
      transition: color 0.15s;
    }

    .nav-links a:hover { color: var(--text); }

    /* LAYOUT */
    .container {
      max-width: 860px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* HERO */
    .hero {
      padding: 80px 24px 64px;
      text-align: center;
      max-width: 860px;
      margin: 0 auto;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(168,85,247,0.1);
      border: 1px solid rgba(168,85,247,0.25);
      border-radius: 9999px;
      padding: 4px 14px;
      font-size: 12px;
      font-weight: 600;
      color: var(--purple);
      letter-spacing: 0.06em;
      text-transform: uppercase;
      margin-bottom: 24px;
    }

    .hero h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 700;
      line-height: 1.18;
      letter-spacing: -0.02em;
      margin-bottom: 20px;
    }

    .hero h1 span { color: var(--purple); }

    .hero p {
      font-size: 18px;
      color: var(--text-secondary);
      max-width: 620px;
      margin: 0 auto 36px;
      line-height: 1.7;
    }

    .hero-cta {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--purple);
      color: #fff;
      font-weight: 600;
      font-size: 15px;
      padding: 11px 24px;
      border-radius: 8px;
      transition: background 0.15s;
      text-decoration: none;
    }

    .hero-cta:hover { background: var(--purple-dim); color: #fff; }

    /* SECTIONS */
    .section {
      padding: 60px 0;
      border-top: 1px solid var(--border);
    }

    .section-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--purple);
      margin-bottom: 12px;
    }

    h2 {
      font-size: clamp(1.4rem, 3vw, 1.9rem);
      font-weight: 700;
      letter-spacing: -0.02em;
      margin-bottom: 16px;
      line-height: 1.25;
    }

    h3 {
      font-size: 1.15rem;
      font-weight: 600;
      margin-bottom: 10px;
      margin-top: 32px;
      color: var(--text);
    }

    p {
      color: var(--text-secondary);
      margin-bottom: 16px;
      line-height: 1.75;
    }

    /* CODE BLOCKS */
    .code-block {
      position: relative;
      margin: 24px 0;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.02);
      overflow: hidden;
    }

    .code-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 16px;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,0.02);
    }

    .code-lang {
      font-family: var(--mono);
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .copy-btn {
      font-family: var(--mono);
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 5px;
      padding: 3px 10px;
      cursor: pointer;
      transition: color 0.15s, border-color 0.15s;
      letter-spacing: 0.04em;
    }

    .copy-btn:hover { color: var(--purple); border-color: var(--purple); }
    .copy-btn.copied { color: var(--green); border-color: var(--green); }

    pre {
      padding: 20px;
      overflow-x: auto;
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.7;
      color: #e2e8f0;
    }

    code {
      font-family: var(--mono);
      font-size: 13px;
    }

    /* Inline code */
    p code, li code {
      background: rgba(168,85,247,0.12);
      border: 1px solid rgba(168,85,247,0.2);
      border-radius: 4px;
      padding: 1px 6px;
      color: var(--purple);
    }

    /* CARDS */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 24px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
    }

    .card-icon {
      font-size: 22px;
      margin-bottom: 10px;
    }

    .card h4 {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--text);
    }

    .card p {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 0;
      line-height: 1.6;
    }

    /* FEATURE LIST */
    .feature-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin: 20px 0;
    }

    .feature-list li {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      color: var(--text-secondary);
      font-size: 15px;
    }

    .feature-list li::before {
      content: '';
      width: 18px;
      height: 18px;
      min-width: 18px;
      border-radius: 50%;
      background: rgba(34,197,94,0.15);
      border: 1px solid rgba(34,197,94,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 2px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' fill='none'%3E%3Cpath d='M2.5 6l2.5 2.5 4.5-5' stroke='%2322C55E' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
    }

    /* CALLOUT */
    .callout {
      background: rgba(168,85,247,0.06);
      border: 1px solid rgba(168,85,247,0.2);
      border-radius: 10px;
      padding: 20px 24px;
      margin: 24px 0;
    }

    .callout p {
      margin-bottom: 0;
      color: var(--text-secondary);
    }

    .callout strong { color: var(--purple); }

    /* FOOTER */
    footer {
      border-top: 1px solid var(--border);
      padding: 40px 24px;
      margin-top: 80px;
    }

    .footer-inner {
      max-width: 860px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 16px;
    }

    .footer-brand {
      display: flex;
      align-items: center;
      gap: 7px;
      font-weight: 700;
      font-size: 15px;
      color: var(--text);
    }

    .footer-brand .diamond { color: var(--purple); }

    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      list-style: none;
    }

    .footer-links a {
      font-size: 13px;
      color: var(--text-muted);
      transition: color 0.15s;
    }

    .footer-links a:hover { color: var(--text); }

    .footer-copy {
      font-size: 12px;
      color: var(--text-muted);
      width: 100%;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      text-align: center;
    }

    /* SYNTAX HIGHLIGHT COLORS */
    .kw { color: #c792ea; }
    .st { color: #c3e88d; }
    .cm { color: #546e7a; font-style: italic; }
    .nm { color: #82aaff; }
    .op { color: #89ddff; }
    .nu { color: #f78c6c; }
    .fn { color: #82aaff; }
    .at { color: #ffcb6b; }

    @media (max-width: 640px) {
      .nav-links { display: none; }
      .footer-inner { flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>

<nav>
  <a href="https://purpleflea.com" class="nav-logo">
    <span class="diamond">&#9830;</span>
    Purple Flea
  </a>
  <ul class="nav-links">
    <li><a href="https://purpleflea.com">Home</a></li>
    <li><a href="https://purpleflea.com/docs">Docs</a></li>
    <li><a href="https://purpleflea.com/for-agents">For Agents</a></li>
    <li><a href="https://purpleflea.com/stats">Stats</a></li>
    <li><a href="https://github.com/purpleflea">GitHub</a></li>
  </ul>
</nav>

<main>
  <section class="hero">
    <div class="hero-badge">Function Calling</div>
    <h1>Give any LLM <span>crypto superpowers</span> with function calling.</h1>
    <p>Purple Flea exposes every product — Casino, Trading, Wallet, and Payments — as ready-to-paste function schemas for OpenAI, Anthropic, Gemini, and any other tool-use API.</p>
    <a href="https://purpleflea.com/docs" class="hero-cta">Read the docs &rarr;</a>
  </section>

  <div class="container">

    <!-- WHAT IS FUNCTION CALLING -->
    <section class="section">
      <div class="section-label">Concepts</div>
      <h2>What is LLM function calling?</h2>
      <p>Modern large language models — GPT-4o, Claude 3.5, Gemini 1.5, Llama 3 — can do more than generate text. They can decide to call external functions and pass typed arguments, letting them interact with real-world systems in a structured, predictable way.</p>
      <p>Instead of asking the model to "write code that checks a price", you declare a <code>get_price</code> function schema. The model infers when to call it, constructs the correct JSON arguments, and your application executes the call and feeds the result back. No string parsing, no fragile regex extraction.</p>

      <div class="card-grid">
        <div class="card">
          <div class="card-icon">&#9650;</div>
          <h4>Deterministic outputs</h4>
          <p>Structured JSON arguments — no hallucinated API calls or malformed parameters.</p>
        </div>
        <div class="card">
          <div class="card-icon">&#9679;</div>
          <h4>Auditable actions</h4>
          <p>Every function call is logged with its exact arguments, making financial ops fully traceable.</p>
        </div>
        <div class="card">
          <div class="card-icon">&#9632;</div>
          <h4>Model-agnostic</h4>
          <p>Same Purple Flea API, different schema formats: OpenAI tools, Anthropic tool_use, Gemini functions.</p>
        </div>
        <div class="card">
          <div class="card-icon">&#9830;</div>
          <h4>Zero hallucination risk</h4>
          <p>The model declares intent; your code executes. The LLM never touches private keys or raw transactions.</p>
        </div>
      </div>
    </section>

    <!-- OPENAI FUNCTION DEFINITIONS -->
    <section class="section">
      <div class="section-label">OpenAI</div>
      <h2>OpenAI function definitions for Purple Flea</h2>
      <p>Paste these tool definitions into any OpenAI <code>chat.completions</code> call. The model will call <code>casino_flip</code>, <code>trading_open_position</code>, or <code>wallet_swap</code> whenever the user's intent matches.</p>

      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Python — OpenAI tools array</span>
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code><span class="kw">import</span> openai
<span class="kw">import</span> requests

tools <span class="op">=</span> [
  <span class="cm"># ── Casino ──────────────────────────────────────────────</span>
  {
    <span class="st">"type"</span>: <span class="st">"function"</span>,
    <span class="st">"function"</span>: {
      <span class="st">"name"</span>: <span class="st">"casino_flip"</span>,
      <span class="st">"description"</span>: <span class="st">"Flip a provably fair coin on Purple Flea Casino. Returns whether the agent won and the payout."</span>,
      <span class="st">"parameters"</span>: {
        <span class="st">"type"</span>: <span class="st">"object"</span>,
        <span class="st">"properties"</span>: {
          <span class="st">"amount"</span>: {<span class="st">"type"</span>: <span class="st">"number"</span>, <span class="st">"description"</span>: <span class="st">"Bet amount in USD (min 0.01, max 10000)"</span>},
          <span class="st">"side"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"enum"</span>: [<span class="st">"heads"</span>, <span class="st">"tails"</span>], <span class="st">"description"</span>: <span class="st">"Which side to bet on"</span>}
        },
        <span class="st">"required"</span>: [<span class="st">"amount"</span>, <span class="st">"side"</span>]
      }
    }
  },
  <span class="cm"># ── Trading ─────────────────────────────────────────────</span>
  {
    <span class="st">"type"</span>: <span class="st">"function"</span>,
    <span class="st">"function"</span>: {
      <span class="st">"name"</span>: <span class="st">"trading_open_position"</span>,
      <span class="st">"description"</span>: <span class="st">"Open a perpetual futures position on 275+ markets via Purple Flea Trading (Hyperliquid)."</span>,
      <span class="st">"parameters"</span>: {
        <span class="st">"type"</span>: <span class="st">"object"</span>,
        <span class="st">"properties"</span>: {
          <span class="st">"market"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"description"</span>: <span class="st">"Market ID e.g. ETH-PERP, BTC-PERP, TSLA-PERP"</span>},
          <span class="st">"side"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"enum"</span>: [<span class="st">"long"</span>, <span class="st">"short"</span>]},
          <span class="st">"size"</span>: {<span class="st">"type"</span>: <span class="st">"number"</span>, <span class="st">"description"</span>: <span class="st">"Position size in USD notional"</span>},
          <span class="st">"leverage"</span>: {<span class="st">"type"</span>: <span class="st">"integer"</span>, <span class="st">"minimum"</span>: <span class="nu">1</span>, <span class="st">"maximum"</span>: <span class="nu">50</span>, <span class="st">"description"</span>: <span class="st">"Leverage multiplier"</span>}
        },
        <span class="st">"required"</span>: [<span class="st">"market"</span>, <span class="st">"side"</span>, <span class="st">"size"</span>]
      }
    }
  },
  <span class="cm"># ── Wallet ──────────────────────────────────────────────</span>
  {
    <span class="st">"type"</span>: <span class="st">"function"</span>,
    <span class="st">"function"</span>: {
      <span class="st">"name"</span>: <span class="st">"wallet_swap"</span>,
      <span class="st">"description"</span>: <span class="st">"Execute a best-rate cross-chain token swap via Purple Flea Wallet (Wagyu aggregator)."</span>,
      <span class="st">"parameters"</span>: {
        <span class="st">"type"</span>: <span class="st">"object"</span>,
        <span class="st">"properties"</span>: {
          <span class="st">"from_chain"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"enum"</span>: [<span class="st">"ethereum"</span>, <span class="st">"base"</span>, <span class="st">"polygon"</span>, <span class="st">"arbitrum"</span>, <span class="st">"solana"</span>, <span class="st">"tron"</span>, <span class="st">"bnb"</span>]},
          <span class="st">"to_chain"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
          <span class="st">"from_token"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"description"</span>: <span class="st">"Token symbol e.g. ETH, USDC, SOL"</span>},
          <span class="st">"to_token"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
          <span class="st">"amount"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"description"</span>: <span class="st">"Amount to swap as string"</span>}
        },
        <span class="st">"required"</span>: [<span class="st">"from_chain"</span>, <span class="st">"to_chain"</span>, <span class="st">"from_token"</span>, <span class="st">"to_token"</span>, <span class="st">"amount"</span>]
      }
    }
  }
]

<span class="kw">def</span> <span class="fn">handle_tool_call</span>(tool_name, args):
    API_KEY <span class="op">=</span> <span class="st">"sk_live_..."</span>
    <span class="kw">if</span> tool_name <span class="op">==</span> <span class="st">"casino_flip"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(<span class="st">"https://api.purpleflea.com/api/v1/flip"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>args)
        <span class="kw">return</span> r.<span class="fn">json</span>()
    <span class="kw">elif</span> tool_name <span class="op">==</span> <span class="st">"trading_open_position"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(<span class="st">"https://api.purpleflea.com/v1/trading/open"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>args)
        <span class="kw">return</span> r.<span class="fn">json</span>()
    <span class="kw">elif</span> tool_name <span class="op">==</span> <span class="st">"wallet_swap"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(<span class="st">"https://wallet.purpleflea.com/v1/wallet/swap"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>args)
        <span class="kw">return</span> r.<span class="fn">json</span>()</code></pre>
      </div>
    </section>

    <!-- ANTHROPIC TOOL USE -->
    <section class="section">
      <div class="section-label">Anthropic</div>
      <h2>Anthropic <code>tool_use</code> format</h2>
      <p>Claude models use a slightly different schema structure. The outer <code>type</code> field is absent and parameter definitions live under <code>input_schema</code> instead of <code>parameters</code>.</p>

      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Python — Anthropic tools array</span>
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code><span class="kw">import</span> anthropic

<span class="cm"># Anthropic Claude tool definitions</span>
tools <span class="op">=</span> [
  {
    <span class="st">"name"</span>: <span class="st">"casino_flip"</span>,
    <span class="st">"description"</span>: <span class="st">"Flip a provably fair coin. Earn 10% on referrals."</span>,
    <span class="st">"input_schema"</span>: {
      <span class="st">"type"</span>: <span class="st">"object"</span>,
      <span class="st">"properties"</span>: {
        <span class="st">"amount"</span>: {<span class="st">"type"</span>: <span class="st">"number"</span>, <span class="st">"description"</span>: <span class="st">"Bet amount in USD"</span>},
        <span class="st">"side"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"enum"</span>: [<span class="st">"heads"</span>, <span class="st">"tails"</span>]}
      },
      <span class="st">"required"</span>: [<span class="st">"amount"</span>, <span class="st">"side"</span>]
    }
  },
  {
    <span class="st">"name"</span>: <span class="st">"trading_open_position"</span>,
    <span class="st">"description"</span>: <span class="st">"Open a perp futures position on 275+ markets via Purple Flea Trading."</span>,
    <span class="st">"input_schema"</span>: {
      <span class="st">"type"</span>: <span class="st">"object"</span>,
      <span class="st">"properties"</span>: {
        <span class="st">"market"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"description"</span>: <span class="st">"Market ID e.g. ETH-PERP, BTC-PERP"</span>},
        <span class="st">"side"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>, <span class="st">"enum"</span>: [<span class="st">"long"</span>, <span class="st">"short"</span>]},
        <span class="st">"size"</span>: {<span class="st">"type"</span>: <span class="st">"number"</span>, <span class="st">"description"</span>: <span class="st">"Position size in USD notional"</span>},
        <span class="st">"leverage"</span>: {<span class="st">"type"</span>: <span class="st">"integer"</span>, <span class="st">"minimum"</span>: <span class="nu">1</span>, <span class="st">"maximum"</span>: <span class="nu">50</span>}
      },
      <span class="st">"required"</span>: [<span class="st">"market"</span>, <span class="st">"side"</span>, <span class="st">"size"</span>]
    }
  },
  {
    <span class="st">"name"</span>: <span class="st">"wallet_swap"</span>,
    <span class="st">"description"</span>: <span class="st">"Execute a best-rate cross-chain swap via Purple Flea Wallet (Wagyu)."</span>,
    <span class="st">"input_schema"</span>: {
      <span class="st">"type"</span>: <span class="st">"object"</span>,
      <span class="st">"properties"</span>: {
        <span class="st">"from_chain"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
        <span class="st">"to_chain"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
        <span class="st">"from_token"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
        <span class="st">"to_token"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>},
        <span class="st">"amount"</span>: {<span class="st">"type"</span>: <span class="st">"string"</span>}
      },
      <span class="st">"required"</span>: [<span class="st">"from_chain"</span>, <span class="st">"to_chain"</span>, <span class="st">"from_token"</span>, <span class="st">"to_token"</span>, <span class="st">"amount"</span>]
    }
  }
]

client <span class="op">=</span> anthropic.<span class="fn">Anthropic</span>()

response <span class="op">=</span> client.messages.<span class="fn">create</span>(
    model<span class="op">=</span><span class="st">"claude-opus-4-6"</span>,
    max_tokens<span class="op">=</span><span class="nu">1024</span>,
    tools<span class="op">=</span>tools,
    messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: <span class="st">"Flip a coin for $5 on heads."</span>}]
)</code></pre>
      </div>

      <h3>Gemini function declarations</h3>
      <p>Google's Gemini uses <code>function_declarations</code> inside a <code>tools</code> wrapper. The parameter schema is identical to OpenAI's JSON Schema subset.</p>

      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Python — Gemini tools</span>
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code><span class="kw">import</span> google.generativeai <span class="kw">as</span> genai

casino_flip_fn <span class="op">=</span> genai.protos.<span class="fn">FunctionDeclaration</span>(
    name<span class="op">=</span><span class="st">"casino_flip"</span>,
    description<span class="op">=</span><span class="st">"Flip a provably fair coin on Purple Flea Casino."</span>,
    parameters<span class="op">=</span>genai.protos.<span class="fn">Schema</span>(
        type<span class="op">=</span>genai.protos.Type.<span class="at">OBJECT</span>,
        properties<span class="op">=</span>{
            <span class="st">"amount"</span>: genai.protos.<span class="fn">Schema</span>(type<span class="op">=</span>genai.protos.Type.<span class="at">NUMBER</span>),
            <span class="st">"side"</span>: genai.protos.<span class="fn">Schema</span>(
                type<span class="op">=</span>genai.protos.Type.<span class="at">STRING</span>,
                enum<span class="op">=</span>[<span class="st">"heads"</span>, <span class="st">"tails"</span>]
            ),
        },
        required<span class="op">=</span>[<span class="st">"amount"</span>, <span class="st">"side"</span>]
    )
)

model <span class="op">=</span> genai.<span class="fn">GenerativeModel</span>(
    model_name<span class="op">=</span><span class="st">"gemini-1.5-pro"</span>,
    tools<span class="op">=</span>[casino_flip_fn]
)</code></pre>
      </div>
    </section>

    <!-- WHY FUNCTION CALLING FOR FINANCIAL OPS -->
    <section class="section">
      <div class="section-label">Why it works</div>
      <h2>Why function calling is ideal for financial operations</h2>
      <p>Freeform text generation is poorly suited to executing financial transactions. Function calling changes the contract between your application and the model in three important ways.</p>

      <h3>Deterministic argument construction</h3>
      <p>When you define a <code>casino_flip</code> function with <code>amount: number</code> and <code>side: enum["heads","tails"]</code>, the model <em>cannot</em> output a malformed payload. The API enforces the schema before your handler ever runs. There is no ambiguity about whether the model said "$5" or "five dollars".</p>

      <h3>Full auditability</h3>
      <p>Every function call is a discrete, logged event: which function was called, with which arguments, at what timestamp. This is essential for financial compliance, dispute resolution, and agent debugging. Reconstructing "what the agent did" from a free-text conversation is impractical; reconstructing it from a structured call log is trivial.</p>

      <h3>No hallucination risk on execution</h3>
      <p>The model decides <em>what</em> to do. Your code decides <em>how</em>. Private keys, wallet addresses, and API secrets never appear in the model context. The LLM emits a JSON payload like <code>{"market": "ETH-PERP", "side": "long", "size": 500}</code> — your handler signs and submits the transaction.</p>

      <ul class="feature-list">
        <li>Schema-validated arguments prevent malformed API calls before they reach Purple Flea</li>
        <li>Structured call logs make agent behavior fully auditable and replayable</li>
        <li>Separation of intent (LLM) from execution (your code) keeps secrets out of the model context</li>
        <li>Typed enums for <code>side</code>, <code>chain</code>, and <code>market</code> eliminate string mismatch errors</li>
        <li>Required fields enforce completeness before your handler executes</li>
      </ul>
    </section>

    <!-- REFERRAL INCOME -->
    <section class="section">
      <div class="section-label">Referral Program</div>
      <h2>Earn referral income through function calling</h2>
      <p>Every Purple Flea product supports a <code>referral_code</code> parameter. Embed your code in the function implementations — not in the schema exposed to the LLM — so every operation your agent executes generates passive income for you.</p>

      <div class="callout">
        <p><strong>10% referral commission</strong> on Casino gross gaming revenue. Perpetual commission on Trading fees and Wallet swap fees generated by referred users. Zero effort once embedded in the handler.</p>
      </div>

      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Python — embedding referral code in handler</span>
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code><span class="cm"># The LLM never sees referral_code — it's injected server-side</span>
<span class="kw">def</span> <span class="fn">handle_tool_call</span>(tool_name, args):
    API_KEY <span class="op">=</span> <span class="st">"sk_live_..."</span>
    REFERRAL_CODE <span class="op">=</span> <span class="st">"ref_yourcode123"</span>  <span class="cm"># injected, never in schema</span>

    <span class="kw">if</span> tool_name <span class="op">==</span> <span class="st">"casino_flip"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(
            <span class="st">"https://api.purpleflea.com/api/v1/flip"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>{<span class="op">**</span>args, <span class="st">"referral_code"</span>: REFERRAL_CODE}
        )
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">elif</span> tool_name <span class="op">==</span> <span class="st">"trading_open_position"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(
            <span class="st">"https://api.purpleflea.com/v1/trading/open"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>{<span class="op">**</span>args, <span class="st">"referral_code"</span>: REFERRAL_CODE}
        )
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">elif</span> tool_name <span class="op">==</span> <span class="st">"wallet_swap"</span>:
        r <span class="op">=</span> requests.<span class="fn">post</span>(
            <span class="st">"https://wallet.purpleflea.com/v1/wallet/swap"</span>,
            headers<span class="op">=</span>{<span class="st">"Authorization"</span>: <span class="st">f"Bearer {API_KEY}"</span>},
            json<span class="op">=</span>{<span class="op">**</span>args, <span class="st">"referral_code"</span>: REFERRAL_CODE}
        )
        <span class="kw">return</span> r.<span class="fn">json</span>()</code></pre>
      </div>

      <p>Register your referral code at <a href="https://purpleflea.com/docs/referrals">purpleflea.com/docs/referrals</a> and start earning from every agent interaction.</p>
    </section>

  </div>
</main>

<footer>
  <div class="footer-inner">
    <div class="footer-brand">
      <span class="diamond">&#9830;</span>
      Purple Flea
    </div>
    <ul class="footer-links">
      <li><a href="https://purpleflea.com/docs">Docs</a></li>
      <li><a href="https://purpleflea.com/for-agents">For Agents</a></li>
      <li><a href="https://purpleflea.com/stats">Stats</a></li>
      <li><a href="https://purpleflea.com/llms.txt">llms.txt</a></li>
      <li><a href="https://github.com/purpleflea">GitHub</a></li>
    </ul>
    <p class="footer-copy">&copy; 2025 Purple Flea. Built for AI agents and the humans who run them.</p>
  </div>
</footer>

<script>
  function copyCode(btn) {
    const pre = btn.closest('.code-block').querySelector('pre');
    const text = pre.innerText;
    navigator.clipboard.writeText(text).then(() => {
      btn.textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(() => {
        btn.textContent = 'Copy';
        btn.classList.remove('copied');
      }, 2000);
    });
  }
</script>
</body>
</html>
