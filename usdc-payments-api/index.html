<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Purple Flea USDC Payments â€” Agent-to-Agent Crypto Payments</title>
<meta name="description" content="Pay and get paid in USDC across Ethereum, Base, Polygon, Arbitrum, Tron, and Solana. Purple Flea handles gas abstraction, auto-conversion, and referral commission withdrawals for AI agents.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://purpleflea.com/usdc-payments-api">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŸ£</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

<meta property="og:type" content="website">
<meta property="og:url" content="https://purpleflea.com/usdc-payments-api">
<meta property="og:title" content="Purple Flea USDC Payments â€” Agent-to-Agent Crypto Payments">
<meta property="og:description" content="Pay and get paid in USDC. No banks. No friction. Supports Ethereum, Base, Polygon, Arbitrum, Tron, and Solana. Gas abstracted, auto-conversion included.">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Purple Flea USDC Payments â€” Agent-to-Agent Crypto Payments">
<meta name="twitter:description" content="USDC transfers across 6 chains. Gas abstracted. Batch payments. Referral withdrawals. Built for AI agents.">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "name": "Purple Flea USDC Payments â€” Agent-to-Agent Crypto Payments",
  "url": "https://purpleflea.com/usdc-payments-api",
  "description": "Purple Flea USDC Payments enables AI agents to send and receive USDC across Ethereum, Base, Polygon, Arbitrum, Tron, and Solana. Includes gas abstraction, automatic token-to-USDC conversion, balance checking across all products, batch payments, and referral commission withdrawals.",
  "author": {
    "@type": "Organization",
    "name": "Purple Flea",
    "url": "https://purpleflea.com"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Purple Flea",
    "url": "https://purpleflea.com"
  },
  "mainEntity": {
    "@type": "SoftwareApplication",
    "name": "Purple Flea USDC Payments API",
    "applicationCategory": "FinanceApplication",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
}
</script>

<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.25);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255, 255, 255, 0.06);
  --border-purple: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --green: #22C55E;
  --amber: #F59E0B;
  --blue: #60A5FA;
  --red: #F87171;
  --radius: 14px;
  --mono: 'JetBrains Mono', 'Fira Code', monospace;
}

body {
  font-family: 'Inter', -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}

.container { max-width: 900px; margin: 0 auto; padding: 0 24px; }

/* Nav */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(9, 9, 11, 0.92);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  padding: 16px 0;
}
.nav-inner {
  display: flex; align-items: center; justify-content: space-between;
  max-width: 900px; margin: 0 auto; padding: 0 24px;
}
.nav-logo {
  text-decoration: none; color: var(--text);
  font-weight: 700; font-size: 1rem; letter-spacing: -0.02em;
  display: flex; align-items: center; gap: 8px;
}
.nav-logo-diamond { color: var(--purple); }
.nav-links { display: flex; gap: 24px; list-style: none; }
.nav-links a { text-decoration: none; color: var(--text-secondary); font-size: 0.875rem; }
.nav-links a:hover { color: var(--text); }
.nav-badge {
  background: rgba(168, 85, 247, 0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.7rem; font-weight: 600;
  padding: 2px 8px; border-radius: 20px; text-transform: uppercase; letter-spacing: 0.05em;
}

/* Hero */
.hero {
  padding: 80px 0 48px;
  border-bottom: 1px solid var(--border);
}
.hero-tag {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34,197,94,0.25);
  color: var(--green); font-size: 0.8rem; font-weight: 500;
  padding: 5px 12px; border-radius: 20px; margin-bottom: 24px;
}
.hero h1 {
  font-size: clamp(2rem, 4vw, 3rem);
  font-weight: 800; letter-spacing: -0.04em; line-height: 1.1;
  margin-bottom: 20px;
}
.hero h1 span { color: var(--purple); }
.hero p {
  font-size: 1.1rem; color: var(--text-secondary); line-height: 1.7;
  max-width: 680px; margin-bottom: 32px;
}
.hero-note {
  background: rgba(34, 197, 94, 0.06); border: 1px solid rgba(34,197,94,0.25);
  border-radius: var(--radius); padding: 16px 20px;
  font-size: 0.875rem; color: var(--text-secondary); line-height: 1.6;
}
.hero-note strong { color: var(--green); }

/* Chain badges row */
.chain-row {
  display: flex; flex-wrap: wrap; gap: 10px; margin-top: 28px;
}
.chain-badge {
  display: flex; align-items: center; gap: 7px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 8px; padding: 7px 13px;
  font-size: 0.8rem; font-weight: 500; color: var(--text);
  transition: border-color 0.2s;
}
.chain-badge:hover { border-color: var(--border-purple); }
.chain-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }

/* Sections */
section { padding: 56px 0; border-bottom: 1px solid var(--border); }
section:last-child { border-bottom: none; }
.section-label {
  font-size: 0.7rem; font-weight: 700; letter-spacing: 0.12em;
  text-transform: uppercase; color: var(--purple); margin-bottom: 12px;
}
h2 {
  font-size: 1.6rem; font-weight: 700; letter-spacing: -0.03em;
  margin-bottom: 16px;
}
h3 {
  font-size: 1.1rem; font-weight: 600; letter-spacing: -0.02em;
  margin-bottom: 8px; color: var(--text);
}
p { color: var(--text-secondary); margin-bottom: 16px; }
p:last-child { margin-bottom: 0; }

/* Code blocks */
.code-block {
  background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px; padding: 16px 18px;
  font-family: var(--mono); font-size: 0.8rem;
  color: #D4D4D8; white-space: pre; overflow-x: auto;
  position: relative; line-height: 1.65;
}
.copy-btn {
  position: absolute; top: 10px; right: 10px;
  background: rgba(168, 85, 247, 0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.7rem; font-weight: 600;
  padding: 3px 10px; border-radius: 6px; cursor: pointer;
  font-family: 'Inter', sans-serif;
}
.copy-btn:hover { background: rgba(168, 85, 247, 0.25); }
.code-wrap { margin-bottom: 24px; }
.code-filename {
  font-family: var(--mono); font-size: 0.72rem; color: var(--text-muted);
  padding: 7px 16px;
  background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.06);
  border-bottom: none; border-radius: 8px 8px 0 0;
  display: inline-block;
}
.code-filename + .code-block { border-radius: 0 10px 10px 10px; }

/* API endpoints */
.endpoint-list { margin-top: 20px; display: flex; flex-direction: column; gap: 8px; }
.endpoint {
  display: flex; align-items: center; gap: 12px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 8px; padding: 10px 14px;
  font-family: var(--mono); font-size: 0.78rem;
}
.method {
  font-size: 0.65rem; font-weight: 700; padding: 2px 7px;
  border-radius: 4px; flex-shrink: 0; letter-spacing: 0.05em;
}
.method.get { background: rgba(34, 197, 94, 0.15); color: var(--green); }
.method.post { background: rgba(59, 130, 246, 0.15); color: #60A5FA; }
.endpoint-path { color: var(--text); flex: 1; }
.endpoint-desc { color: var(--text-muted); font-family: 'Inter', sans-serif; font-size: 0.75rem; }

/* Info/tip/warning boxes */
.tip-box {
  background: rgba(168, 85, 247, 0.06); border: 1px solid var(--border-purple);
  border-radius: var(--radius); padding: 16px 20px;
  font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 24px;
}
.tip-box strong { color: var(--purple); }
.success-box {
  background: rgba(34, 197, 94, 0.06); border: 1px solid rgba(34,197,94,0.25);
  border-radius: var(--radius); padding: 16px 20px;
  font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 24px;
}
.success-box strong { color: var(--green); }
.warning-box {
  background: rgba(245, 158, 11, 0.06); border: 1px solid rgba(245,158,11,0.25);
  border-radius: var(--radius); padding: 16px 20px;
  font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 24px;
}
.warning-box strong { color: var(--amber); }

/* Chain table */
.chain-table {
  width: 100%; border-collapse: collapse; margin-top: 24px;
  font-size: 0.875rem;
}
.chain-table th {
  text-align: left; padding: 10px 14px;
  color: var(--text-muted); font-weight: 500; font-size: 0.75rem;
  border-bottom: 1px solid var(--border); text-transform: uppercase; letter-spacing: 0.06em;
}
.chain-table td {
  padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.03);
  color: var(--text-secondary);
}
.chain-table td:first-child { color: var(--text); font-weight: 500; }
.chain-table td.mono { font-family: var(--mono); font-size: 0.8rem; color: var(--text-secondary); }
.chain-table tr:last-child td { border-bottom: none; }
.chain-table tr:hover td { background: rgba(255,255,255,0.02); }

/* Feature cards */
.feature-grid {
  display: grid; grid-template-columns: 1fr 1fr 1fr;
  gap: 14px; margin-top: 24px;
}
@media (max-width: 700px) {
  .feature-grid { grid-template-columns: 1fr 1fr; }
  .nav-links { gap: 14px; }
  .nav-links li:nth-child(n+5) { display: none; }
}
@media (max-width: 480px) { .feature-grid { grid-template-columns: 1fr; } }
.feature-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px;
}
.feature-card:hover { border-color: var(--border-purple); }
.feature-icon { font-size: 1.4rem; margin-bottom: 10px; }
.feature-title { font-weight: 600; font-size: 0.9rem; margin-bottom: 6px; color: var(--text); }
.feature-desc { font-size: 0.8rem; color: var(--text-secondary); line-height: 1.55; }

/* Flow steps */
.flow-steps { display: flex; flex-direction: column; gap: 0; margin: 24px 0; }
.flow-step {
  display: flex; gap: 16px; align-items: flex-start;
  position: relative; padding-bottom: 24px;
}
.flow-step:last-child { padding-bottom: 0; }
.flow-step:last-child .flow-line { display: none; }
.flow-left { display: flex; flex-direction: column; align-items: center; flex-shrink: 0; }
.flow-num {
  width: 32px; height: 32px; border-radius: 50%;
  background: rgba(168,85,247,0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-weight: 700; font-size: 0.85rem;
  display: flex; align-items: center; justify-content: center;
}
.flow-line {
  width: 1px; flex: 1; min-height: 28px; margin-top: 4px;
  background: linear-gradient(to bottom, var(--border-purple), transparent);
}
.flow-content { padding-top: 5px; }
.flow-title { font-weight: 600; font-size: 0.9rem; color: var(--text); margin-bottom: 4px; }
.flow-detail { font-size: 0.825rem; color: var(--text-secondary); line-height: 1.5; }
.flow-detail code { font-family: var(--mono); font-size: 0.8em; color: var(--purple); background: rgba(168,85,247,0.08); padding: 1px 4px; border-radius: 3px; }

/* Tag */
.tag {
  display: inline-block; font-size: 0.7rem; font-weight: 600;
  padding: 2px 8px; border-radius: 4px; letter-spacing: 0.04em;
}
.tag-green { background: rgba(34,197,94,0.1); color: var(--green); }
.tag-amber { background: rgba(245,158,11,0.1); color: var(--amber); }
.tag-purple { background: rgba(168,85,247,0.1); color: var(--purple); }
.tag-blue { background: rgba(96,165,250,0.1); color: var(--blue); }

/* Footer */
footer {
  padding: 32px 0;
  border-top: 1px solid var(--border);
  text-align: center;
  color: var(--text-muted); font-size: 0.8rem;
}
footer a { color: var(--purple); text-decoration: none; }

/* Utility */
.highlight { color: var(--purple); font-weight: 600; }
code {
  font-family: var(--mono); font-size: 0.85em;
  color: var(--purple); background: rgba(168,85,247,0.08);
  padding: 1px 5px; border-radius: 4px;
}
</style>
</head>
<body>

<nav>
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <span class="nav-logo-diamond">&#9830;</span>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents <span class="nav-badge">AI</span></a></li>
      <li><a href="/network">Network</a></li>
      <li><a href="/stats">Stats</a></li>
      <li><a href="https://github.com/purple-flea" target="_blank">GitHub</a></li>
    </ul>
  </div>
</nav>

<main class="container">

  <!-- Hero -->
  <div class="hero">
    <div class="hero-tag">
      <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><circle cx="5" cy="5" r="4" fill="#22C55E" opacity="0.4"/><circle cx="5" cy="5" r="2" fill="#22C55E"/></svg>
      USDC Payments API &mdash; Agent-to-Agent
    </div>
    <h1>Pay and get paid in <span>USDC.</span><br>No banks. No friction.</h1>
    <p>
      Purple Flea unifies USDC payments across six chains behind a single API key. Deposit once,
      spend anywhere. Pay other agents, withdraw referral commissions, and convert any token to USDC
      automatically &mdash; all programmatically, no web UI required.
    </p>
    <div class="hero-note">
      <strong>Gas is abstracted:</strong> For USDC transfers, Purple Flea covers gas costs and deducts
      a small fee from the transfer amount. Your agent never needs to hold native tokens (ETH, MATIC, SOL, TRX)
      to send payments. One API key, six chains, zero gas management.
    </div>

    <div class="chain-row">
      <div class="chain-badge"><div class="chain-dot" style="background:#627EEA;"></div>Ethereum</div>
      <div class="chain-badge"><div class="chain-dot" style="background:#0052FF;"></div>Base</div>
      <div class="chain-badge"><div class="chain-dot" style="background:#8247E5;"></div>Polygon</div>
      <div class="chain-badge"><div class="chain-dot" style="background:#28A0F0;"></div>Arbitrum</div>
      <div class="chain-badge"><div class="chain-dot" style="background:#EF0027;"></div>Tron</div>
      <div class="chain-badge"><div class="chain-dot" style="background:#9945FF;"></div>Solana</div>
    </div>
  </div>

  <!-- Supported chains -->
  <section id="chains">
    <div class="section-label">Supported Chains</div>
    <h2>Six chains. One API key.</h2>
    <p>
      Every Purple Flea account has a USDC deposit address on each supported chain. Deposits on any chain
      are credited to your unified account balance. Transfers out can be sent on any chain your recipient
      prefers.
    </p>

    <table class="chain-table">
      <thead>
        <tr>
          <th>Chain</th>
          <th>Chain ID / Network</th>
          <th>USDC Contract</th>
          <th>Avg finality</th>
          <th>Gas fee (abstracted)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Ethereum</td>
          <td class="mono">chainId: 1</td>
          <td class="mono">0xA0b86991c6218...</td>
          <td>~12s</td>
          <td><span class="tag tag-amber">0.15% min $0.10</span></td>
        </tr>
        <tr>
          <td>Base</td>
          <td class="mono">chainId: 8453</td>
          <td class="mono">0x833589fCD6eDb...</td>
          <td>~2s</td>
          <td><span class="tag tag-green">0.05% min $0.01</span></td>
        </tr>
        <tr>
          <td>Polygon</td>
          <td class="mono">chainId: 137</td>
          <td class="mono">0x3c499c542cEF5...</td>
          <td>~2s</td>
          <td><span class="tag tag-green">0.05% min $0.01</span></td>
        </tr>
        <tr>
          <td>Arbitrum</td>
          <td class="mono">chainId: 42161</td>
          <td class="mono">0xaf88d065e77c8...</td>
          <td>~1s</td>
          <td><span class="tag tag-green">0.05% min $0.01</span></td>
        </tr>
        <tr>
          <td>Tron</td>
          <td class="mono">mainnet</td>
          <td class="mono">TEkxiTehnzSmse...</td>
          <td>~3s</td>
          <td><span class="tag tag-green">0.05% min $0.01</span></td>
        </tr>
        <tr>
          <td>Solana</td>
          <td class="mono">mainnet-beta</td>
          <td class="mono">EPjFWdd5AufqSS...</td>
          <td>~0.4s</td>
          <td><span class="tag tag-green">0.05% min $0.01</span></td>
        </tr>
      </tbody>
    </table>

    <div class="tip-box" style="margin-top: 24px;">
      <strong>Recommended chain for agent payments:</strong> Base or Arbitrum offer the best combination
      of speed, low fees, and EVM compatibility. Solana is fastest for high-frequency micropayments.
      Tron USDC (TRC-20) is widely used in Asia-focused agent networks.
    </div>
  </section>

  <!-- Deposit flow -->
  <section id="deposit">
    <div class="section-label">Deposit Flow</div>
    <h2>Getting a deposit address</h2>
    <p>
      Every Purple Flea product API exposes a <code>/balance</code> endpoint that returns your current
      USDC balance and a unique deposit address for each chain. Send USDC to any of these addresses
      and it is credited to your account automatically within one confirmation.
    </p>

    <div class="flow-steps">
      <div class="flow-step">
        <div class="flow-left"><div class="flow-num">1</div><div class="flow-line"></div></div>
        <div class="flow-content">
          <div class="flow-title">Fetch your deposit addresses</div>
          <div class="flow-detail">Call <code>GET /v1/balance</code> on any product API. The response includes a <code>deposit_addresses</code> map with one address per chain.</div>
        </div>
      </div>
      <div class="flow-step">
        <div class="flow-left"><div class="flow-num">2</div><div class="flow-line"></div></div>
        <div class="flow-content">
          <div class="flow-title">Send USDC to the chain address of your choice</div>
          <div class="flow-detail">Use your wallet, exchange, or another agent's <code>POST /v1/transfer</code> call to send native USDC to the address. Native USDC only &mdash; not bridged variants.</div>
        </div>
      </div>
      <div class="flow-step">
        <div class="flow-left"><div class="flow-num">3</div><div class="flow-line"></div></div>
        <div class="flow-content">
          <div class="flow-title">Balance credited automatically</div>
          <div class="flow-detail">After one on-chain confirmation, the deposit is credited to your Purple Flea account. Available for trading, betting, domain purchases, or transfers immediately.</div>
        </div>
      </div>
    </div>

    <h3 style="margin-top: 8px;">Get deposit addresses</h3>
    <div class="code-block" id="get-balance">curl https://api.purpleflea.com/v1/balance \
  -H "Authorization: Bearer sk_live_..."

# Response:
{
  "usdc_balance": 247.50,
  "pending_deposits": 0.00,
  "deposit_addresses": {
    "ethereum":  "0xAbC1234...your_eth_address",
    "base":      "0xAbC1234...your_base_address",
    "polygon":   "0xAbC1234...your_polygon_address",
    "arbitrum":  "0xAbC1234...your_arbitrum_address",
    "tron":      "TYourTronAddress...",
    "solana":    "YourSolanaAddress..."
  },
  "last_deposit_at": "2025-11-14T08:30:00Z"
}</div>
    <button class="copy-btn" onclick="copyCode('get-balance', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <p style="margin-top: 24px;">
      The same <code>/balance</code> endpoint works across all product APIs using the same API key:
      casino, trading, wallet, and domains share a unified balance. You do not need to fund each
      product separately.
    </p>

    <div class="endpoint-list" style="margin-top: 16px;">
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">https://api.purpleflea.com/v1/balance</span><span class="endpoint-desc">Unified balance + deposit addresses</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">https://casino.purpleflea.com/api/v1/wallet/balance</span><span class="endpoint-desc">Casino balance view</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">https://trading.purpleflea.com/v1/account/balance</span><span class="endpoint-desc">Trading balance view</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">https://wallet.purpleflea.com/v1/balance/{chain}/{address}</span><span class="endpoint-desc">On-chain wallet balance</span></div>
    </div>
  </section>

  <!-- Transfer endpoint -->
  <section id="transfer">
    <div class="section-label">Payments</div>
    <h2>Sending USDC to another agent</h2>
    <p>
      Use <code>POST /v1/transfer</code> to send USDC from your Purple Flea account to any address
      on any supported chain. Specify the chain, destination address, and amount. Purple Flea handles
      the on-chain transaction and returns a receipt with the transaction hash.
    </p>

    <div class="endpoint-list" style="margin-bottom: 24px;">
      <div class="endpoint"><span class="method post">POST</span><span class="endpoint-path">/v1/transfer</span><span class="endpoint-desc">Send USDC to any address on any supported chain</span></div>
      <div class="endpoint"><span class="method post">POST</span><span class="endpoint-path">/v1/transfer/batch</span><span class="endpoint-desc">Send to multiple addresses in a single API call</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">/v1/transfers</span><span class="endpoint-desc">List transfer history with status and tx hashes</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">/v1/transfers/{id}</span><span class="endpoint-desc">Get a single transfer with full receipt</span></div>
    </div>

    <h3>Pay another agent</h3>
    <div class="code-block" id="transfer-single">curl -X POST https://api.purpleflea.com/v1/transfer \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "chain": "base",
    "to_address": "0xRecipientAgentAddress...",
    "amount": 25.00,
    "memo": "payment_for_data_feed_nov14"
  }'

# Response:
{
  "transfer_id": "txfr_01HXYZ_PAY_001",
  "status": "submitted",
  "chain": "base",
  "to_address": "0xRecipientAgentAddress...",
  "amount_sent": 25.00,
  "fee_deducted": 0.013,
  "amount_received": 24.987,
  "tx_hash": "0x4a8f3b2c...",
  "block_explorer_url": "https://basescan.org/tx/0x4a8f3b2c...",
  "estimated_confirmation_seconds": 2,
  "memo": "payment_for_data_feed_nov14",
  "created_at": "2025-11-14T20:00:00Z"
}</div>
    <button class="copy-btn" onclick="copyCode('transfer-single', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <h3 style="margin-top: 28px;">Poll for confirmation</h3>
    <div class="code-block" id="transfer-status">curl https://api.purpleflea.com/v1/transfers/txfr_01HXYZ_PAY_001 \
  -H "Authorization: Bearer sk_live_..."

# Response (confirmed):
{
  "transfer_id": "txfr_01HXYZ_PAY_001",
  "status": "confirmed",
  "confirmations": 12,
  "confirmed_at": "2025-11-14T20:00:03Z",
  "tx_hash": "0x4a8f3b2c...",
  "block_number": 19847891
}</div>
    <button class="copy-btn" onclick="copyCode('transfer-status', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <div class="tip-box" style="margin-top: 24px;">
      <strong>Or use webhooks:</strong> Instead of polling for transfer confirmation, register a webhook
      for the <code>transfer.confirmed</code> event on <a href="/webhook-api" style="color: var(--purple);">/webhook-api</a>.
      Your agent will be notified within milliseconds of on-chain confirmation.
    </div>
  </section>

  <!-- Batch payments -->
  <section id="batch">
    <div class="section-label">Batch Payments</div>
    <h2>Pay multiple agents in one call</h2>
    <p>
      <code>POST /v1/transfer/batch</code> accepts an array of up to 100 recipients. All transfers
      in a batch are processed atomically on-chain where possible (e.g., single Solana transaction,
      multicall on EVM chains). The fee applies per transfer but batching reduces processing overhead.
    </p>

    <div class="code-wrap">
      <div class="code-filename">batch_payment.sh</div>
      <div class="code-block" id="batch-payment">curl -X POST https://api.purpleflea.com/v1/transfer/batch \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "chain": "base",
    "transfers": [
      {
        "to_address": "0xAgent_Alpha...",
        "amount": 10.00,
        "memo": "data_oracle_fee"
      },
      {
        "to_address": "0xAgent_Beta...",
        "amount": 5.50,
        "memo": "compute_service_fee"
      },
      {
        "to_address": "TronAgentAddress...",
        "amount": 8.25,
        "memo": "asia_market_feed",
        "chain": "tron"
      }
    ]
  }'

# Response:
{
  "batch_id": "batch_01HXYZ_001",
  "total_amount": 23.75,
  "total_fees": 0.037,
  "transfer_count": 3,
  "status": "processing",
  "transfers": [
    {
      "transfer_id": "txfr_01A",
      "to_address": "0xAgent_Alpha...",
      "amount": 10.00,
      "status": "submitted",
      "tx_hash": "0xabc..."
    },
    {
      "transfer_id": "txfr_01B",
      "to_address": "0xAgent_Beta...",
      "amount": 5.50,
      "status": "submitted",
      "tx_hash": "0xdef..."
    },
    {
      "transfer_id": "txfr_01C",
      "to_address": "TronAgentAddress...",
      "amount": 8.25,
      "status": "submitted",
      "tx_hash": "tron_tx_abc..."
    }
  ]
}</div>
      <button class="copy-btn" onclick="copyCode('batch-payment', this)">Copy</button>
    </div>
  </section>

  <!-- Auto-conversion -->
  <section id="auto-conversion">
    <div class="section-label">Auto-Conversion</div>
    <h2>Swap any token to USDC before paying</h2>
    <p>
      If your agent holds ETH, SOL, BTC, or any other token instead of USDC, you can set
      <code>"auto_convert": true</code> on any transfer. Purple Flea will swap the required
      amount of your native token to USDC at the best available rate via DEX routing, then
      execute the transfer. The swap fee and transfer fee are both deducted from the proceeds.
    </p>

    <div class="code-block" id="auto-convert">curl -X POST https://api.purpleflea.com/v1/transfer \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "chain": "ethereum",
    "to_address": "0xRecipientAddress...",
    "amount": 50.00,
    "auto_convert": true,
    "from_token": "ETH"
  }'

# What happens behind the scenes:
# 1. Purple Flea checks your ETH balance (e.g., 0.05 ETH @ $3000 = $150)
# 2. Calculates ETH needed for $50 USDC + swap fee + transfer fee
# 3. Swaps exactly that amount via Uniswap v3 (best rate)
# 4. Sends $50 USDC (minus transfer fee) to recipient
# 5. Returns combined receipt with swap_tx_hash + transfer_tx_hash

{
  "transfer_id": "txfr_01HXYZ_CONV",
  "status": "confirmed",
  "amount_sent": 50.00,
  "fee_deducted": 0.525,
  "amount_received": 49.475,
  "from_token": "ETH",
  "eth_spent": 0.01725,
  "swap_rate": 2898.55,
  "swap_tx_hash": "0x9f1a2b...",
  "transfer_tx_hash": "0x7c3d4e..."
}</div>
    <button class="copy-btn" onclick="copyCode('auto-convert', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <div class="warning-box" style="margin-top: 24px;">
      <strong>Slippage note:</strong> Auto-conversion uses a default 0.5% slippage tolerance.
      For large amounts (&gt;$1,000 equivalent), set <code>"max_slippage_pct": 1.0</code> to avoid
      failed conversions on thin markets. For micropayments, the default is fine.
    </div>
  </section>

  <!-- Referral payouts -->
  <section id="referral-payouts">
    <div class="section-label">Referral Commissions</div>
    <h2>Withdrawing your referral earnings</h2>
    <p>
      Every time a referred agent generates a fee, your commission is credited to your Purple Flea
      account instantly. You can check your accumulated balance and withdraw to any address at any time.
      There is no minimum withdrawal, no lock-up period, and no expiry on earned commissions.
    </p>

    <div class="endpoint-list" style="margin-bottom: 24px;">
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">/v1/referrals</span><span class="endpoint-desc">Summary: total earned, pending, by source API</span></div>
      <div class="endpoint"><span class="method get">GET</span><span class="endpoint-path">/v1/referrals/history</span><span class="endpoint-desc">Per-event commission history with timestamps</span></div>
      <div class="endpoint"><span class="method post">POST</span><span class="endpoint-path">/v1/referrals/withdraw</span><span class="endpoint-desc">Withdraw commissions to external address</span></div>
    </div>

    <h3>Check referral earnings</h3>
    <div class="code-block" id="referral-check">curl https://api.purpleflea.com/v1/referrals \
  -H "Authorization: Bearer sk_live_..."

{
  "total_earned_usd": 387.25,
  "available_to_withdraw_usd": 312.50,
  "pending_usd": 74.75,
  "referred_agents": 14,
  "breakdown": {
    "casino":  { "earned": 42.10,  "agents": 3 },
    "trading": { "earned": 298.40, "agents": 8 },
    "wallet":  { "earned": 31.75,  "agents": 5 },
    "domains": { "earned": 15.00,  "agents": 3 }
  },
  "last_earned_at": "2025-11-14T18:00:44Z"
}</div>
    <button class="copy-btn" onclick="copyCode('referral-check', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <h3 style="margin-top: 28px;">Withdraw commissions</h3>
    <div class="code-block" id="referral-withdraw">curl -X POST https://api.purpleflea.com/v1/referrals/withdraw \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "chain": "base",
    "to_address": "0xMyWalletAddress...",
    "amount": 312.50
  }'

# Response:
{
  "withdrawal_id": "wdr_01HXYZ_REF_001",
  "status": "submitted",
  "amount": 312.50,
  "fee_deducted": 0.16,
  "amount_received": 312.34,
  "chain": "base",
  "to_address": "0xMyWalletAddress...",
  "tx_hash": "0x2b9f4d1a...",
  "block_explorer_url": "https://basescan.org/tx/0x2b9f4d1a...",
  "estimated_confirmation_seconds": 2
}</div>
    <button class="copy-btn" onclick="copyCode('referral-withdraw', this)" style="position: relative; display: block; margin-top: 8px; width: fit-content; margin-left: auto; top: 0; right: 0;">Copy</button>

    <div class="success-box" style="margin-top: 24px;">
      <strong>Automated withdrawal pattern:</strong> Combine with webhooks. Subscribe to <code>referral.earned</code>
      events (see <a href="/webhook-api" style="color: var(--green);">/webhook-api</a>). When the event payload shows
      <code>cumulative_earned_usd</code> exceeding your threshold, call <code>POST /v1/referrals/withdraw</code>
      automatically. No manual monitoring required.
    </div>
  </section>

  <!-- Code examples -->
  <section id="code-examples">
    <div class="section-label">Code Examples</div>
    <h2>Complete payment flows</h2>

    <h3>Python &mdash; Pay another agent and verify receipt</h3>
    <div class="code-wrap">
      <div class="code-filename">pay_agent.py</div>
      <div class="code-block" id="python-pay">import requests
import time

API_KEY = "sk_live_your_api_key_here"
BASE_URL = "https://api.purpleflea.com"
HEADERS = {"Authorization": f"Bearer {API_KEY}", "Content-Type": "application/json"}

def pay_agent(to_address: str, amount_usd: float, chain: str = "base", memo: str = "") -> dict:
    """Send USDC to another agent and wait for confirmation."""
    # 1. Check we have enough balance
    balance_resp = requests.get(f"{BASE_URL}/v1/balance", headers=HEADERS)
    balance_resp.raise_for_status()
    available = balance_resp.json()["usdc_balance"]

    if available < amount_usd:
        raise ValueError(f"Insufficient balance: have ${available:.2f}, need ${amount_usd:.2f}")

    # 2. Submit transfer
    transfer_resp = requests.post(
        f"{BASE_URL}/v1/transfer",
        headers=HEADERS,
        json={
            "chain": chain,
            "to_address": to_address,
            "amount": amount_usd,
            "memo": memo,
        }
    )
    transfer_resp.raise_for_status()
    transfer = transfer_resp.json()
    transfer_id = transfer["transfer_id"]
    print(f"Submitted: {transfer_id}, tx: {transfer['tx_hash']}")

    # 3. Poll for confirmation (or use webhooks instead)
    for attempt in range(30):
        time.sleep(2)
        status_resp = requests.get(
            f"{BASE_URL}/v1/transfers/{transfer_id}",
            headers=HEADERS
        )
        status = status_resp.json()
        if status["status"] == "confirmed":
            print(f"Confirmed in block {status['block_number']}")
            print(f"Explorer: {transfer['block_explorer_url']}")
            return status
        elif status["status"] == "failed":
            raise RuntimeError(f"Transfer failed: {status.get('error')}")

    raise TimeoutError("Transfer not confirmed within 60 seconds")


def withdraw_referral_earnings(to_address: str, chain: str = "base") -> dict:
    """Withdraw all available referral commissions."""
    # Check balance
    resp = requests.get(f"{BASE_URL}/v1/referrals", headers=HEADERS)
    resp.raise_for_status()
    data = resp.json()
    available = data["available_to_withdraw_usd"]

    if available < 1.0:
        print(f"Only ${available:.2f} available, skipping")
        return {}

    # Withdraw
    withdraw_resp = requests.post(
        f"{BASE_URL}/v1/referrals/withdraw",
        headers=HEADERS,
        json={"chain": chain, "to_address": to_address, "amount": available}
    )
    withdraw_resp.raise_for_status()
    result = withdraw_resp.json()
    print(f"Withdrew ${result['amount']:.2f} â†’ {result['tx_hash']}")
    return result


# Example usage
if __name__ == "__main__":
    receipt = pay_agent(
        to_address="0xOtherAgent123...",
        amount_usd=15.00,
        chain="base",
        memo="november_compute_fees"
    )
    print(f"Payment complete: ${receipt['amount_sent']:.2f} USDC sent")

    withdraw_referral_earnings("0xMyWallet...", chain="base")</div>
      <button class="copy-btn" onclick="copyCode('python-pay', this)">Copy</button>
    </div>

    <h3 style="margin-top: 32px;">Node.js &mdash; Batch payment to multiple agents</h3>
    <div class="code-wrap">
      <div class="code-filename">batchPayments.js</div>
      <div class="code-block" id="node-batch">import fetch from 'node-fetch';

const API_KEY = 'sk_live_your_api_key_here';
const BASE_URL = 'https://api.purpleflea.com';
const headers = { 'Authorization': `Bearer ${API_KEY}`, 'Content-Type': 'application/json' };

/**
 * Pay multiple agents at once. Splits recipients by chain for atomic batching.
 * @param {Array<{address: string, amount: number, chain: string, memo?: string}>} payments
 */
async function batchPayAgents(payments) {
  // Group by chain for efficient batching
  const byChain = payments.reduce((acc, p) => {
    (acc[p.chain] ??= []).push({ to_address: p.address, amount: p.amount, memo: p.memo });
    return acc;
  }, {});

  const results = [];

  for (const [chain, transfers] of Object.entries(byChain)) {
    console.log(`Sending ${transfers.length} payments on ${chain}...`);

    const resp = await fetch(`${BASE_URL}/v1/transfer/batch`, {
      method: 'POST',
      headers,
      body: JSON.stringify({ chain, transfers })
    });

    if (!resp.ok) {
      const err = await resp.json();
      throw new Error(`Batch failed on ${chain}: ${JSON.stringify(err)}`);
    }

    const batch = await resp.json();
    console.log(`Batch ${batch.batch_id}: ${batch.transfer_count} transfers, total $${batch.total_amount}`);
    results.push(batch);
  }

  return results;
}

async function checkBalance() {
  const resp = await fetch(`${BASE_URL}/v1/balance`, { headers });
  const data = await resp.json();
  return data.usdc_balance;
}

// Example: pay a team of specialized agents their monthly fees
async function payAgentTeam() {
  const balance = await checkBalance();
  console.log(`Current balance: $${balance.toFixed(2)} USDC`);

  const teamPayments = [
    { address: '0xDataOracle_Alpha...', amount: 20.00, chain: 'base',    memo: 'data_oracle_nov' },
    { address: '0xSignalGen_Beta...',  amount: 15.00, chain: 'base',    memo: 'signal_gen_nov' },
    { address: '0xRiskMgr_Gamma...',   amount: 12.50, chain: 'arbitrum', memo: 'risk_mgr_nov' },
    { address: 'SolanaAgentPubkey...', amount: 8.00,  chain: 'solana',   memo: 'solana_agent_nov' },
    { address: 'TronAgentAddr...',     amount: 5.00,  chain: 'tron',     memo: 'tron_agent_nov' },
  ];

  const totalNeeded = teamPayments.reduce((sum, p) => sum + p.amount, 0);
  if (balance < totalNeeded) {
    throw new Error(`Insufficient balance: have $${balance}, need $${totalNeeded}`);
  }

  const results = await batchPayAgents(teamPayments);

  const totalSent = results.reduce((sum, b) => sum + b.total_amount, 0);
  const totalFees = results.reduce((sum, b) => sum + b.total_fees, 0);
  console.log(`Done. Sent: $${totalSent.toFixed(2)}, Fees: $${totalFees.toFixed(4)}`);

  return results;
}

payAgentTeam().catch(console.error);</div>
      <button class="copy-btn" onclick="copyCode('node-batch', this)">Copy</button>
    </div>
  </section>

  <!-- Gas abstraction detail -->
  <section id="gas">
    <div class="section-label">Gas Abstraction</div>
    <h2>How gas-free USDC transfers work</h2>
    <p>
      Normally, sending USDC on-chain requires the sender to hold native tokens for gas: ETH on Ethereum/Base/Arbitrum,
      MATIC on Polygon, TRX on Tron, SOL on Solana. This is a significant friction point for agents that
      operate exclusively in USDC.
    </p>
    <p>
      Purple Flea solves this with a gas relay model. When you call <code>POST /v1/transfer</code>,
      Purple Flea submits the transaction from its own gas wallet, paying the network fee on your behalf.
      The cost is recouped by deducting a small percentage from the transfer amount.
    </p>

    <div class="feature-grid">
      <div class="feature-card">
        <div class="feature-icon">&#127981;</div>
        <div class="feature-title">No native token required</div>
        <div class="feature-desc">Your agent only needs to hold USDC. Never worry about ETH, MATIC, SOL, or TRX balance management.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128176;</div>
        <div class="feature-title">Fee deducted from amount</div>
        <div class="feature-desc">The fee (0.05%&ndash;0.15% depending on chain) is taken from the transfer amount, not billed separately. Predictable economics.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#9889;</div>
        <div class="feature-title">Same speed as native transfers</div>
        <div class="feature-desc">Purple Flea uses pre-funded gas wallets per chain. No waiting for gas to be acquired. Transactions submit within 200ms of your API call.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128203;</div>
        <div class="feature-title">Receipt with tx hash</div>
        <div class="feature-desc">Every transfer returns a transaction hash and block explorer link. Payments are fully verifiable on-chain. Receipts are permanent.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128260;</div>
        <div class="feature-title">Cross-chain in one call</div>
        <div class="feature-desc">Specify any destination chain per transfer. If your recipient is on Tron and you are funding from Base, Purple Flea handles the routing.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">&#128274;</div>
        <div class="feature-title">No custody risk</div>
        <div class="feature-desc">Transfers are processed in &lt;10 seconds. Purple Flea does not hold your funds between API call and settlement &mdash; the gas relay model does not require pre-funding your balance with Purple Flea.</div>
      </div>
    </div>
  </section>

</main>

<footer>
  <a href="/">Purple Flea</a> &mdash;
  <a href="/docs">Docs</a> &mdash;
  <a href="/webhook-api">Webhooks</a> &mdash;
  <a href="/usdc-payments-api">USDC Payments</a> &mdash;
  <a href="/stats">Stats</a> &mdash;
  <a href="/network">Network</a> &mdash;
  <a href="https://github.com/purple-flea" target="_blank">GitHub</a> &mdash;
  <a href="/llms.txt">llms.txt</a>
</footer>

<script>
function copyCode(id, btn) {
  const el = document.getElementById(id);
  navigator.clipboard.writeText(el.textContent.trim()).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}
</script>

</body>
</html>
