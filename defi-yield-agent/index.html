<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeFi Yield Farming Agent â€” Autonomous Yield Optimization API</title>
<meta name="description" content="Build an autonomous DeFi yield farming agent using Purple Flea. Monitor APYs across protocols, auto-rebalance, compound rewards. Multi-chain: ETH, SOL, BNB, Polygon.">
<link rel="canonical" href="https://purpleflea.com/defi-yield-agent/">
<meta property="og:title" content="DeFi Yield Farming Agent â€” Autonomous Yield Optimization API">
<meta property="og:description" content="Build an autonomous DeFi yield farming agent using Purple Flea. Monitor APYs across protocols, auto-rebalance, compound rewards. Multi-chain: ETH, SOL, BNB, Polygon.">
<meta property="og:url" content="https://purpleflea.com/defi-yield-agent/">
<meta property="og:type" content="website">
<meta property="og:site_name" content="Purple Flea">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@purpleflea">
<meta name="twitter:title" content="DeFi Yield Farming Agent">
<meta name="twitter:description" content="Autonomous yield optimization across Aave, Compound, Kamino, and more. Purple Flea handles cross-chain swaps between protocols.">
<meta name="twitter:image" content="https://purpleflea.com/flea.jpg">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "DeFi Yield Farming Agent â€” Autonomous Yield Optimization",
  "url": "https://purpleflea.com/defi-yield-agent/",
  "description": "Build an autonomous DeFi yield farming agent using Purple Flea. Monitor APYs across protocols, auto-rebalance, compound rewards. Multi-chain.",
  "publisher": {"@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com"}
}
</script>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŸ£</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.3);
  --purple-subtle: rgba(168, 85, 247, 0.08);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255, 255, 255, 0.06);
  --border-hover: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --radius: 16px;
  --radius-sm: 10px;
}
html { scroll-behavior: smooth; }
body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
body::before { content: ''; position: fixed; inset: 0; z-index: 9999; pointer-events: none; opacity: 0.025; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"); background-repeat: repeat; background-size: 180px; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.3); border-radius: 3px; }
::selection { background: rgba(168, 85, 247, 0.4); color: white; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.reveal { opacity: 0; transform: translateY(30px); transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
.reveal.visible { opacity: 1; transform: translateY(0); }
.reveal-delay-1 { transition-delay: 0.1s; }
.reveal-delay-2 { transition-delay: 0.2s; }
.reveal-delay-3 { transition-delay: 0.3s; }

/* NAV */
nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 16px 0; transition: all 0.3s ease; }
nav.scrolled { background: rgba(9, 9, 11, 0.8); backdrop-filter: blur(20px) saturate(1.5); border-bottom: 1px solid var(--border); }
.nav-inner { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.nav-logo { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 18px; text-decoration: none; color: var(--text); }
.nav-logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--purple), var(--purple-dim)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
.nav-links { display: flex; align-items: center; gap: 32px; list-style: none; }
.nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 14px; font-weight: 450; transition: color 0.2s; }
.nav-links a:hover { color: var(--text); }
.nav-cta { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; background: var(--purple); color: white !important; border-radius: 8px; font-weight: 500; font-size: 14px; text-decoration: none; transition: all 0.2s; }
.nav-cta:hover { background: var(--purple-dim); transform: translateY(-1px); }
@media (max-width: 768px) { .nav-links { display: none; } }

/* HERO */
.hero { min-height: 80vh; display: flex; align-items: center; justify-content: center; position: relative; padding: 120px 0 80px; overflow: hidden; }
.hero-bg { position: absolute; inset: 0; overflow: hidden; }
.hero-gradient-1 { position: absolute; top: -30%; left: 50%; transform: translateX(-50%); width: 900px; height: 600px; background: radial-gradient(ellipse, rgba(168, 85, 247, 0.15) 0%, transparent 70%); filter: blur(60px); }
.hero-grid { position: absolute; inset: 0; background-image: linear-gradient(rgba(168, 85, 247, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(168, 85, 247, 0.03) 1px, transparent 1px); background-size: 60px 60px; mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); -webkit-mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); }
.hero-content { position: relative; text-align: center; max-width: 860px; margin: 0 auto; padding: 0 24px; }
.hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px 6px 8px; background: var(--purple-subtle); border: 1px solid rgba(168, 85, 247, 0.15); border-radius: 100px; font-size: 13px; font-weight: 500; color: var(--purple); margin-bottom: 32px; animation: fadeInDown 0.8s ease; }
.hero-badge-dot { width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: badge-pulse 2s ease-in-out infinite; }
@keyframes badge-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
@keyframes fadeInDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes gradient-shift { 0% { background-position: 0% center; } 50% { background-position: 100% center; } 100% { background-position: 0% center; } }
.hero h1 { font-size: clamp(2.5rem, 6vw, 4.5rem); font-weight: 800; line-height: 1.05; letter-spacing: -0.03em; margin-bottom: 24px; animation: fadeInUp 0.8s ease 0.1s both; }
.hero h1 .gradient { background: linear-gradient(135deg, var(--purple) 0%, #C084FC 50%, var(--purple) 100%); background-size: 200% auto; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: gradient-shift 5s ease infinite; }
.hero-desc { font-size: clamp(1rem, 2vw, 1.2rem); color: var(--text-secondary); margin-bottom: 40px; line-height: 1.7; animation: fadeInUp 0.8s ease 0.2s both; }
.hero-actions { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; animation: fadeInUp 0.8s ease 0.3s both; }
.btn-primary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--purple); color: white; border-radius: var(--radius-sm); font-weight: 600; font-size: 15px; text-decoration: none; transition: all 0.2s; box-shadow: 0 0 30px rgba(168, 85, 247, 0.3); }
.btn-primary:hover { background: var(--purple-dim); transform: translateY(-2px); box-shadow: 0 0 40px rgba(168, 85, 247, 0.5); }
.btn-secondary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--bg-card); color: var(--text); border-radius: var(--radius-sm); font-weight: 500; font-size: 15px; text-decoration: none; border: 1px solid var(--border); transition: all 0.2s; }
.btn-secondary:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }

/* SECTIONS */
section { padding: 100px 0; position: relative; }
.section-label { display: inline-flex; align-items: center; gap: 12px; font-size: 12px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--purple); margin-bottom: 20px; }
.section-label::before { content: ''; width: 24px; height: 1px; background: var(--purple); }
.section-title { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; }
.section-desc { font-size: 1.1rem; color: var(--text-secondary); max-width: 700px; margin-bottom: 40px; line-height: 1.7; }
.section-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 0; }

/* CODE BLOCK */
.code-block { background: rgba(0,0,0,0.4); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; font-family: 'JetBrains Mono', monospace; font-size: 13.5px; line-height: 1.7; overflow-x: auto; position: relative; }
.code-block .code-header { display: flex; align-items: center; gap: 8px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.code-dot { width: 12px; height: 12px; border-radius: 50%; }
.code-dot.red { background: #EF4444; }
.code-dot.yellow { background: #FBBF24; }
.code-dot.green { background: #22C55E; }
.code-filename { margin-left: 8px; font-size: 12px; color: var(--text-muted); }
.kw { color: #C084FC; }
.fn { color: #93C5FD; }
.st { color: #86EFAC; }
.cm { color: var(--text-muted); font-style: italic; }
.num { color: #FDE68A; }
.cls { color: #F9A8D4; }
.at { color: #A855F7; }

/* GRID */
.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
@media (max-width: 900px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 768px) { .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; } }

/* CARDS */
.card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; transition: all 0.3s ease; }
.card:hover { background: var(--bg-card-hover); border-color: var(--border-hover); transform: translateY(-4px); box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 30px rgba(168,85,247,0.05); }
.card-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; margin-bottom: 20px; }
.card-icon.purple { background: rgba(168, 85, 247, 0.15); }
.card-icon.blue { background: rgba(96, 165, 250, 0.15); }
.card-icon.green { background: rgba(34, 197, 94, 0.15); }
.card-icon.orange { background: rgba(251, 146, 60, 0.15); }
.card-icon.red { background: rgba(239, 68, 68, 0.15); }
.card h3 { font-size: 1.1rem; font-weight: 600; margin-bottom: 10px; }
.card p { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; }

/* YIELD SOURCE CARD */
.yield-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 24px; }
.yield-card .chain { font-size: 11px; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; color: var(--purple); margin-bottom: 8px; }
.yield-card h3 { font-size: 1.05rem; font-weight: 600; margin-bottom: 4px; }
.yield-card .apy { font-size: 1.6rem; font-weight: 800; color: #22C55E; margin: 8px 0; }
.yield-card p { color: var(--text-muted); font-size: 0.85rem; line-height: 1.5; }

/* LOOP DIAGRAM */
.loop-row { display: flex; align-items: center; gap: 0; margin-bottom: 40px; flex-wrap: wrap; }
.loop-step { flex: 1; min-width: 160px; background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px; text-align: center; position: relative; }
.loop-arrow { padding: 0 12px; color: var(--purple); font-size: 1.2rem; font-weight: 700; }
@media (max-width: 768px) { .loop-row { flex-direction: column; } .loop-arrow { transform: rotate(90deg); } }
.loop-step .icon { font-size: 1.4rem; margin-bottom: 8px; }
.loop-step h4 { font-size: 0.9rem; font-weight: 600; margin-bottom: 4px; }
.loop-step p { font-size: 0.8rem; color: var(--text-muted); }

/* PROSE */
.prose { max-width: 760px; }
.prose p { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; }
.prose h3 { font-size: 1.3rem; font-weight: 700; margin-bottom: 12px; margin-top: 40px; }
.prose ul { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; padding-left: 24px; }
.prose li { margin-bottom: 8px; }

/* CHAIN TABLE */
.chain-table { width: 100%; border-collapse: collapse; }
.chain-table th { text-align: left; padding: 12px 16px; font-size: 12px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; color: var(--text-muted); border-bottom: 1px solid var(--border); }
.chain-table td { padding: 14px 16px; font-size: 14px; border-bottom: 1px solid var(--border); vertical-align: top; }
.chain-table tr:last-child td { border-bottom: none; }
.chain-table tr:hover td { background: var(--bg-card); }
.chain-table .protocol { font-family: 'JetBrains Mono', monospace; color: var(--purple); font-size: 13px; }
.chain-table .chain-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; }
.badge-eth { background: rgba(96,165,250,0.15); color: #60A5FA; }
.badge-sol { background: rgba(168,85,247,0.15); color: var(--purple); }
.badge-bnb { background: rgba(251,191,36,0.15); color: #FBBF24; }
.badge-matic { background: rgba(167,139,250,0.15); color: #A78BFA; }
.apy-text { color: #22C55E; font-weight: 600; font-family: 'JetBrains Mono', monospace; }

/* CTA SECTION */
.cta-section { text-align: center; padding: 100px 0; }
.cta-box { background: linear-gradient(135deg, rgba(168,85,247,0.08) 0%, rgba(124,58,237,0.05) 100%); border: 1px solid rgba(168,85,247,0.2); border-radius: 24px; padding: 80px 40px; position: relative; overflow: hidden; }
.cta-box::before { content: ''; position: absolute; top: -50%; left: 50%; transform: translateX(-50%); width: 600px; height: 400px; background: radial-gradient(ellipse, rgba(168,85,247,0.1) 0%, transparent 70%); filter: blur(40px); pointer-events: none; }
.cta-box h2 { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; position: relative; }
.cta-box p { color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 40px; position: relative; }

/* FOOTER */
footer { padding: 60px 0 40px; border-top: 1px solid var(--border); }
.footer-top { display: grid; grid-template-columns: 1fr 2fr; gap: 60px; margin-bottom: 60px; }
.footer-brand p { color: var(--text-secondary); font-size: 14px; margin-top: 16px; max-width: 260px; line-height: 1.6; }
.footer-columns { display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; }
.footer-col h4 { font-size: 13px; font-weight: 600; margin-bottom: 16px; }
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.footer-col a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-col a:hover { color: var(--text); }
.footer-bottom { display: flex; align-items: center; justify-content: space-between; padding-top: 24px; border-top: 1px solid var(--border); }
.footer-bottom p { color: var(--text-muted); font-size: 13px; }
.footer-social { display: flex; gap: 24px; }
.footer-social a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-social a:hover { color: var(--text); }
@media (max-width: 768px) { .footer-top { grid-template-columns: 1fr; gap: 40px; } .footer-columns { grid-template-columns: repeat(2, 1fr); } .footer-bottom { flex-direction: column; gap: 16px; text-align: center; } }

/* RELATED LINKS */
.related-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 768px) { .related-grid { grid-template-columns: 1fr; } }
.related-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px 24px; text-decoration: none; color: var(--text); display: block; transition: all 0.2s; }
.related-card:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }
.related-card .label { font-size: 11px; color: var(--purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
.related-card .title { font-size: 14px; font-weight: 600; }
.related-card .desc { font-size: 13px; color: var(--text-muted); margin-top: 4px; }
</style>
</head>
<body>

<nav id="navbar">
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <div class="nav-logo-icon">&#9830;</div>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents</a></li>
      <li><a href="/integrations">Integrations</a></li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="https://wallet.purpleflea.com" target="_blank" class="nav-cta">Get Started &rarr;</a></li>
    </ul>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg">
    <div class="hero-gradient-1"></div>
    <div class="hero-grid"></div>
  </div>
  <div class="hero-content">
    <div class="hero-badge">
      <div class="hero-badge-dot"></div>
      Autonomous Yield Optimization
    </div>
    <h1>DeFi Yield Farming<br>for <span class="gradient">AI Agents</span></h1>
    <p class="hero-desc">
      DeFi yields change every block. Aave rates shift based on utilization. LP fee income
      fluctuates with trading volume. Manually monitoring dozens of protocols across four
      chains is impossible. An autonomous agent running 24/7 can find the highest risk-adjusted
      yield and rebalance automatically â€” using Purple Flea to handle cross-chain swaps.
    </p>
    <div class="hero-actions">
      <a href="https://wallet.purpleflea.com" class="btn-primary" target="_blank">Get Your API Key &rarr;</a>
      <a href="/crypto-wallet-api/" class="btn-secondary">Wallet API Docs</a>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- YIELD SOURCES -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Yield Sources</div>
      <h2 class="section-title">Where the Yield Comes From</h2>
      <p class="section-desc">
        DeFi yield is not a single number â€” it is a composite of multiple protocol-specific
        revenue streams, each with different risk profiles and on different chains.
        Your agent needs to understand each category before optimizing across them.
      </p>
    </div>

    <div class="grid-2 reveal reveal-delay-1" style="gap: 32px; margin-bottom: 48px;">
      <div class="card">
        <div class="card-icon blue">&#9827;</div>
        <h3>Lending Protocols</h3>
        <p>
          Supply USDC or ETH to Aave, Compound, or Venus. Earn the supply APY paid by borrowers.
          Rates vary from 1% to 25%+ depending on utilization. Pure interest income with no
          impermanent loss risk. Your capital can be recalled instantly (assuming available liquidity).
          Lowest risk category â€” smart contract risk is the main concern.
        </p>
      </div>
      <div class="card">
        <div class="card-icon green">&#9674;</div>
        <h3>LP Positions</h3>
        <p>
          Provide liquidity to Uniswap v3, Curve, or Orca. Earn a share of trading fees
          (0.01%â€“1% per swap depending on pool). Concentrated liquidity positions (Uniswap v3)
          earn dramatically more fees per dollar deployed â€” but require active management to
          keep the price range in range. Impermanent loss is the key risk.
        </p>
      </div>
      <div class="card">
        <div class="card-icon purple">&#11044;</div>
        <h3>Native Staking</h3>
        <p>
          Stake SOL on Solana validators (currently ~7% APY), stake ETH via liquid staking
          (stETH, ~3.5% APY), or delegate MATIC on Polygon (~5% APY). Yield is protocol-native,
          paid in the staked token. Near-zero smart contract risk for established validators.
          The simplest yield source â€” set it and forget it.
        </p>
      </div>
      <div class="card">
        <div class="card-icon orange">&#8597;</div>
        <h3>Funding Rate Farming</h3>
        <p>
          As covered in depth at <a href="/funding-rate-arbitrage/" style="color:var(--purple)">funding-rate-arbitrage</a>,
          going long spot and short a perpetual collects funding when rates are positive.
          This is DeFi yield with no smart contract exposure â€” the positions live on a
          centralized perpetuals exchange. Purple Flea's Trading API makes this accessible
          to any agent.
        </p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- AGENT ARCHITECTURE -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Agent Design</div>
      <h2 class="section-title">The Monitor &rarr; Compare &rarr; Rebalance Loop</h2>
      <p class="section-desc">
        The core of any yield farming agent is a continuous loop that identifies better
        opportunities and moves capital to them when the yield differential justifies the
        cost of switching.
      </p>
    </div>

    <div class="loop-row reveal reveal-delay-1">
      <div class="loop-step">
        <div class="icon">&#128270;</div>
        <h4>Monitor</h4>
        <p>Fetch APYs from all tracked protocols every hour</p>
      </div>
      <div class="loop-arrow">&rarr;</div>
      <div class="loop-step">
        <div class="icon">&#9878;</div>
        <h4>Compare</h4>
        <p>Find highest risk-adjusted yield vs. current position</p>
      </div>
      <div class="loop-arrow">&rarr;</div>
      <div class="loop-step">
        <div class="icon">&#128200;</div>
        <h4>Calculate</h4>
        <p>Is improvement &gt; 1% APY after gas and swap costs?</p>
      </div>
      <div class="loop-arrow">&rarr;</div>
      <div class="loop-step">
        <div class="icon">&#8644;</div>
        <h4>Rebalance</h4>
        <p>Withdraw, swap via Purple Flea, deposit into new protocol</p>
      </div>
    </div>

    <div class="reveal reveal-delay-2">
      <div class="prose">
        <p>
          The 1% threshold prevents excessive churn. If Aave is paying 5.2% and Compound
          is paying 5.8%, moving is not worth the gas costs and swap fees. But if Kamino
          on Solana starts paying 12%, the agent should bridge USDC from Ethereum to Solana
          via the Purple Flea Wallet API's cross-chain swap and deposit.
        </p>
        <p>
          Risk adjustment is critical. Multiply raw APY by a protocol safety score before
          comparing. An audited protocol with $5B TVL might score 1.0; an unaudited fork
          with $10M TVL might score 0.3. A 30% APY on the risky protocol is effectively
          9% risk-adjusted â€” less appealing than 10% on a blue-chip.
        </p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- CODE EXAMPLE -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Code Example</div>
      <h2 class="section-title">Full Python Yield Agent</h2>
      <p class="section-desc">
        A production-ready autonomous yield farming agent that monitors multiple protocols,
        uses Purple Flea for cross-chain rebalancing, and logs all actions.
      </p>
    </div>

    <div class="reveal reveal-delay-1">
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">yield_agent.py</span>
        </div>
<span class="kw">import</span> time, requests, logging
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

logging.<span class="fn">basicConfig</span>(level=logging.INFO, format=<span class="st">"%(asctime)s %(levelname)s %(message)s"</span>)

<span class="cm"># Yield sources: each has a fetch function, deposit/withdraw functions, and a risk score</span>
YIELD_SOURCES = [
    {<span class="st">"name"</span>: <span class="st">"Aave-USDC-ETH"</span>,    <span class="st">"chain"</span>: <span class="st">"ethereum"</span>, <span class="st">"token"</span>: <span class="st">"USDC"</span>, <span class="st">"risk"</span>: <span class="num">1.0</span>},
    {<span class="st">"name"</span>: <span class="st">"Compound-USDC"</span>,    <span class="st">"chain"</span>: <span class="st">"ethereum"</span>, <span class="st">"token"</span>: <span class="st">"USDC"</span>, <span class="st">"risk"</span>: <span class="num">0.95</span>},
    {<span class="st">"name"</span>: <span class="st">"Aave-v3-Polygon"</span>,  <span class="st">"chain"</span>: <span class="st">"polygon"</span>,  <span class="st">"token"</span>: <span class="st">"USDC"</span>, <span class="st">"risk"</span>: <span class="num">0.9</span>},
    {<span class="st">"name"</span>: <span class="st">"Kamino-USDC-SOL"</span>,  <span class="st">"chain"</span>: <span class="st">"solana"</span>,   <span class="st">"token"</span>: <span class="st">"USDC"</span>, <span class="st">"risk"</span>: <span class="num">0.8</span>},
    {<span class="st">"name"</span>: <span class="st">"Venus-USDC-BNB"</span>,   <span class="st">"chain"</span>: <span class="st">"bnb"</span>,      <span class="st">"token"</span>: <span class="st">"USDC"</span>, <span class="st">"risk"</span>: <span class="num">0.85</span>},
]

<span class="kw">class</span> <span class="cls">YieldFarmingAgent</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(self, api_key, min_improvement=<span class="num">0.01</span>):
        self.api_key = api_key
        self.min_improvement = min_improvement  <span class="cm"># 1% APY minimum to justify rebalance</span>
        self.headers = {<span class="st">"Authorization"</span>: <span class="st">f"Bearer {api_key}"</span>}
        self.base = <span class="st">"https://api.purpleflea.com"</span>
        self.current_position = <span class="kw">None</span>  <span class="cm"># {"source": ..., "amount": ..., "apy": ...}</span>
        self.total_yield_earned = <span class="num">0.0</span>
        self.rebalance_count = <span class="num">0</span>

    <span class="kw">def</span> <span class="fn">fetch_apy</span>(self, source):
        <span class="st">"""Fetch current APY from DeFi protocol API."""</span>
        <span class="cm"># In production: call protocol-specific APIs (Aave subgraph, Compound API, etc.)</span>
        <span class="cm"># Here we mock with a placeholder â€” replace with actual protocol calls</span>
        protocol_apis = {
            <span class="st">"Aave-USDC-ETH"</span>:   <span class="st">"https://aave.com/api/v1/reserves/USDC/ethereum"</span>,
            <span class="st">"Compound-USDC"</span>:   <span class="st">"https://api.compound.finance/api/v2/ctoken?addresses[]=0xa0b..."</span>,
            <span class="st">"Aave-v3-Polygon"</span>: <span class="st">"https://aave.com/api/v1/reserves/USDC/polygon"</span>,
            <span class="st">"Kamino-USDC-SOL"</span>: <span class="st">"https://api.kamino.finance/strategies/usdc"</span>,
            <span class="st">"Venus-USDC-BNB"</span>:  <span class="st">"https://api.venus.io/markets/vUSDC"</span>,
        }
        resp = requests.<span class="fn">get</span>(protocol_apis[source[<span class="st">"name"</span>]], timeout=<span class="num">10</span>)
        <span class="kw">return</span> resp.<span class="fn">json</span>().<span class="fn">get</span>(<span class="st">"supply_apy"</span>, <span class="num">0.0</span>)

    <span class="kw">def</span> <span class="fn">risk_adjusted_apy</span>(self, raw_apy, risk_score):
        <span class="kw">return</span> raw_apy * risk_score

    <span class="kw">def</span> <span class="fn">rebalance</span>(self, from_source, to_source, amount_usd):
        <span class="st">"""Move USDC from one protocol/chain to another via Purple Flea."""</span>
        logging.<span class="fn">info</span>(<span class="st">f"Rebalancing ${amount_usd:.2f} from {from_source['name']} to {to_source['name']}"</span>)

        <span class="cm"># Step 1: Withdraw from current protocol (call their API or contract)</span>
        self.<span class="fn">_protocol_withdraw</span>(from_source, amount_usd)

        <span class="cm"># Step 2: Cross-chain swap if different chains, using Purple Flea Wallet API</span>
        <span class="kw">if</span> from_source[<span class="st">"chain"</span>] != to_source[<span class="st">"chain"</span>]:
            swap_resp = requests.<span class="fn">post</span>(
                <span class="st">f"{self.base}/wallet/swap"</span>,
                headers=self.headers,
                json={
                    <span class="st">"from_chain"</span>: from_source[<span class="st">"chain"</span>],
                    <span class="st">"to_chain"</span>: to_source[<span class="st">"chain"</span>],
                    <span class="st">"from_token"</span>: <span class="st">"USDC"</span>,
                    <span class="st">"to_token"</span>: <span class="st">"USDC"</span>,
                    <span class="st">"amount_usd"</span>: amount_usd,
                    <span class="st">"slippage"</span>: <span class="num">0.005</span>,
                }
            ).<span class="fn">json</span>()
            logging.<span class="fn">info</span>(<span class="st">f"Cross-chain swap tx: {swap_resp['tx_hash']}"</span>)

        <span class="cm"># Step 3: Deposit into target protocol</span>
        self.<span class="fn">_protocol_deposit</span>(to_source, amount_usd)
        self.rebalance_count += <span class="num">1</span>
        logging.<span class="fn">info</span>(<span class="st">f"Rebalance complete. Total rebalances: {self.rebalance_count}"</span>)

    <span class="kw">def</span> <span class="fn">_protocol_withdraw</span>(self, source, amount): <span class="kw">pass</span>  <span class="cm"># implement per-protocol</span>
    <span class="kw">def</span> <span class="fn">_protocol_deposit</span>(self, source, amount): <span class="kw">pass</span>   <span class="cm"># implement per-protocol</span>

    <span class="kw">def</span> <span class="fn">run</span>(self, capital_usd=<span class="num">10000</span>, poll_interval=<span class="num">3600</span>):
        logging.<span class="fn">info</span>(<span class="st">f"Yield agent started. Capital: ${capital_usd:,}"</span>)
        <span class="kw">while True</span>:
            best = <span class="kw">None</span>
            best_apy = <span class="num">0.0</span>

            <span class="kw">for</span> source <span class="kw">in</span> YIELD_SOURCES:
                <span class="kw">try</span>:
                    raw = self.<span class="fn">fetch_apy</span>(source)
                    adj = self.<span class="fn">risk_adjusted_apy</span>(raw, source[<span class="st">"risk"</span>])
                    logging.<span class="fn">info</span>(<span class="st">f"{source['name']:25s}  raw={raw:.2%}  adj={adj:.2%}"</span>)
                    <span class="kw">if</span> adj > best_apy:
                        best_apy = adj
                        best = source
                <span class="kw">except Exception as</span> e:
                    logging.<span class="fn">warning</span>(<span class="st">f"Failed to fetch APY for {source['name']}: {e}"</span>)

            current_apy = self.current_position[<span class="st">"apy"</span>] <span class="kw">if</span> self.current_position <span class="kw">else</span> <span class="num">0.0</span>
            improvement = best_apy - current_apy

            <span class="kw">if</span> improvement > self.min_improvement <span class="kw">and</span> best:
                logging.<span class="fn">info</span>(<span class="st">f"Better yield found: {best['name']} ({best_apy:.2%} adj APY, +{improvement:.2%} improvement)"</span>)
                <span class="kw">if</span> self.current_position:
                    self.<span class="fn">rebalance</span>(self.current_position[<span class="st">"source"</span>], best, capital_usd)
                <span class="kw">else</span>:
                    self.<span class="fn">_protocol_deposit</span>(best, capital_usd)
                self.current_position = {<span class="st">"source"</span>: best, <span class="st">"amount"</span>: capital_usd, <span class="st">"apy"</span>: best_apy}
            <span class="kw">else</span>:
                logging.<span class="fn">info</span>(<span class="st">f"No better opportunity found. Staying in {self.current_position['source']['name'] if self.current_position else 'cash'}."</span>)

            time.<span class="fn">sleep</span>(poll_interval)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    agent = <span class="cls">YieldFarmingAgent</span>(api_key=<span class="st">"pf_sk_..."</span>, min_improvement=<span class="num">0.01</span>)
    agent.<span class="fn">run</span>(capital_usd=<span class="num">50000</span>)
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- MULTI-CHAIN YIELD -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Multi-Chain</div>
      <h2 class="section-title">Yield Opportunities by Chain</h2>
      <p class="section-desc">
        Purple Flea's Wallet API handles cross-chain swaps between all major networks,
        making it trivial for your agent to move USDC from Ethereum to Solana and back.
      </p>
    </div>

    <div class="reveal reveal-delay-1">
      <div style="overflow-x:auto; border: 1px solid var(--border); border-radius: var(--radius);">
        <table class="chain-table">
          <thead>
            <tr>
              <th>Protocol</th>
              <th>Chain</th>
              <th>Asset</th>
              <th>Type</th>
              <th>Typical APY</th>
            </tr>
          </thead>
          <tbody>
            <tr><td class="protocol">Aave v3</td><td><span class="chain-badge badge-eth">Ethereum</span></td><td>USDC</td><td>Lending</td><td class="apy-text">3â€“12%</td></tr>
            <tr><td class="protocol">Compound v3</td><td><span class="chain-badge badge-eth">Ethereum</span></td><td>USDC</td><td>Lending</td><td class="apy-text">2â€“10%</td></tr>
            <tr><td class="protocol">Curve 3pool</td><td><span class="chain-badge badge-eth">Ethereum</span></td><td>USDC/DAI/USDT</td><td>LP</td><td class="apy-text">2â€“8%</td></tr>
            <tr><td class="protocol">Kamino Finance</td><td><span class="chain-badge badge-sol">Solana</span></td><td>USDC</td><td>Lending</td><td class="apy-text">5â€“20%</td></tr>
            <tr><td class="protocol">Drift Protocol</td><td><span class="chain-badge badge-sol">Solana</span></td><td>USDC</td><td>Lending</td><td class="apy-text">4â€“18%</td></tr>
            <tr><td class="protocol">Orca Whirlpool</td><td><span class="chain-badge badge-sol">Solana</span></td><td>SOL/USDC</td><td>LP</td><td class="apy-text">8â€“40%</td></tr>
            <tr><td class="protocol">Venus Protocol</td><td><span class="chain-badge badge-bnb">BNB Chain</span></td><td>USDC</td><td>Lending</td><td class="apy-text">3â€“15%</td></tr>
            <tr><td class="protocol">Aave v3</td><td><span class="chain-badge badge-matic">Polygon</span></td><td>USDC</td><td>Lending</td><td class="apy-text">3â€“14%</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RISK CONSIDERATIONS -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Risk Management</div>
      <h2 class="section-title">Risk Considerations</h2>
    </div>
    <div class="grid-2 reveal reveal-delay-1">
      <div class="card">
        <div class="card-icon red">&#9670;</div>
        <h3>Smart Contract Risk</h3>
        <p>
          Every DeFi protocol carries smart contract risk â€” the possibility of a bug or
          exploit draining funds. Mitigate by only using audited protocols with substantial
          TVL and track records. Your agent's risk scoring should heavily penalize any
          protocol without multiple independent audits from top firms.
        </p>
      </div>
      <div class="card">
        <div class="card-icon orange">&#8644;</div>
        <h3>Impermanent Loss in LP Positions</h3>
        <p>
          When you provide liquidity to an AMM, price movements cause you to hold more of
          the underperforming asset. For volatile pairs like SOL/USDC, this can wipe out
          weeks of fee income. Your agent should only farm LP positions when the projected
          fee APY significantly exceeds the estimated impermanent loss.
        </p>
      </div>
      <div class="card">
        <div class="card-icon blue">&#9650;</div>
        <h3>Gas vs. Yield Tradeoff</h3>
        <p>
          On Ethereum mainnet, a full deposit/withdrawal/bridge cycle can cost $50â€“$200
          in gas fees. For a $10,000 position, moving to capture 2% more APY saves roughly
          $0.55 per day â€” your break-even point is 90â€“360 days just to recover swap costs.
          Only rebalance when the NPV of the improvement exceeds total transaction costs.
        </p>
      </div>
      <div class="card">
        <div class="card-icon purple">&#128274;</div>
        <h3>Protocol Insolvency Risk</h3>
        <p>
          Lending protocols can face insolvency if collateral values drop faster than
          liquidations can process â€” as seen in the 2022 LUNA collapse's effects on
          Anchor Protocol. Your agent should never exceed 10% exposure to any single
          lending protocol, regardless of yield, to prevent catastrophic concentration loss.
        </p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- COMPOUNDING -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Compounding</div>
      <h2 class="section-title">Auto-Compounding Rewards</h2>
      <div class="prose">
        <p>
          Many DeFi protocols distribute rewards as a separate token (e.g., COMP from Compound,
          AAVE from Aave staking). To maximize your effective APY, your agent should automatically
          claim these rewards and reinvest them. But compounding too frequently wastes more on
          gas than you gain from the compounded principal.
        </p>
        <p>
          The optimal compounding interval balances gas cost against the additional yield
          from compounding. The formula is:
        </p>
      </div>
    </div>

    <div class="reveal reveal-delay-1">
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">compound_optimizer.py</span>
        </div>
<span class="kw">import</span> math

<span class="kw">def</span> <span class="fn">optimal_compound_interval</span>(apy, gas_cost_usd, position_usd):
    <span class="st">"""
    Find the compounding interval (in days) that maximizes net APY.
    
    apy:           annual yield rate (e.g., 0.10 for 10%)
    gas_cost_usd:  cost of one compound transaction in USD
    position_usd:  total position size in USD
    
    Returns: optimal days between compounding
    """</span>
    r = apy / <span class="num">365</span>  <span class="cm"># daily rate</span>
    c = gas_cost_usd / position_usd  <span class="cm"># gas as fraction of position</span>

    <span class="cm"># Optimal interval: compound when accrued yield = 2 * gas cost</span>
    <span class="cm"># Accrued yield after n days â‰ˆ position * r * n</span>
    <span class="cm"># Solve: r * n = 2 * c â†’ n = 2c / r</span>
    optimal_days = (<span class="num">2</span> * c) / r

    <span class="cm"># Net APY after gas: (1 + r*n - c)^(365/n) - 1</span>
    periods_per_year = <span class="num">365</span> / optimal_days
    net_apy = ((<span class="num">1</span> + r * optimal_days - c) ** periods_per_year) - <span class="num">1</span>
    gross_apy = ((<span class="num">1</span> + r) ** <span class="num">365</span>) - <span class="num">1</span>

    <span class="fn">print</span>(<span class="st">f"Position:         ${position_usd:,.0f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Gross APY:        {gross_apy:.2%}"</span>)
    <span class="fn">print</span>(<span class="st">f"Gas per compound: ${gas_cost_usd:.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Optimal interval: every {optimal_days:.1f} days"</span>)
    <span class="fn">print</span>(<span class="st">f"Net APY:          {net_apy:.2%}"</span>)
    <span class="kw">return</span> optimal_days

<span class="cm"># Example: $50k position, 10% APY, $15 gas per compound</span>
<span class="fn">optimal_compound_interval</span>(apy=<span class="num">0.10</span>, gas_cost_usd=<span class="num">15</span>, position_usd=<span class="num">50000</span>)
<span class="cm"># Position:         $50,000</span>
<span class="cm"># Gross APY:        10.52%</span>
<span class="cm"># Gas per compound: $15.00</span>
<span class="cm"># Optimal interval: every 10.9 days</span>
<span class="cm"># Net APY:          9.97%</span>
      </div>
    </div>

    <div class="prose reveal reveal-delay-2" style="margin-top: 32px;">
      <p>
        On low-gas chains like Solana (gas ~$0.001 per transaction), compounding daily or
        even hourly is cost-effective. On Ethereum mainnet, compound every 1â€“2 weeks for
        typical position sizes. Your agent should recalculate the optimal interval whenever
        gas prices shift significantly.
      </p>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RELATED -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Keep Reading</div>
      <h2 class="section-title">Related Guides</h2>
    </div>
    <div class="related-grid reveal reveal-delay-1">
      <a href="/crypto-wallet-api/" class="related-card">
        <div class="label">API Reference</div>
        <div class="title">Crypto Wallet API</div>
        <div class="desc">Cross-chain swaps, balances, and transfers</div>
      </a>
      <a href="/ethereum-agent-api/" class="related-card">
        <div class="label">Chain Guide</div>
        <div class="title">Ethereum Agent API</div>
        <div class="desc">ETH-specific endpoints and Aave integration</div>
      </a>
      <a href="/solana-agent-api/" class="related-card">
        <div class="label">Chain Guide</div>
        <div class="title">Solana Agent API</div>
        <div class="desc">SOL staking, Kamino, and Drift integration</div>
      </a>
    </div>
  </div>
</section>

<!-- CTA -->
<section class="cta-section">
  <div class="container">
    <div class="cta-box reveal">
      <h2>Build an agent that<br>never <span style="color:var(--purple)">sleeps on yield.</span></h2>
      <p>Free to start. Cross-chain swaps built in. No KYC required.</p>
      <div class="hero-actions">
        <a href="https://wallet.purpleflea.com" class="btn-primary" target="_blank">Register your agent &rarr;</a>
        <a href="/crypto-wallet-api/" class="btn-secondary">Wallet API docs</a>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<footer>
  <div class="container">
    <div class="footer-top">
      <div class="footer-brand">
        <a href="/" class="nav-logo">
          <div class="nav-logo-icon">&#9830;</div>
          Purple Flea
        </a>
        <p>AI-first infrastructure for autonomous agents. Built for machines, verified by math.</p>
      </div>
      <div class="footer-columns">
        <div class="footer-col">
          <h4>Products</h4>
          <ul>
            <li><a href="https://casino.purpleflea.com" target="_blank">Casino</a></li>
            <li><a href="https://trading.purpleflea.com" target="_blank">Trading</a></li>
            <li><a href="https://wallet.purpleflea.com" target="_blank">Wallet</a></li>
            <li><a href="https://domains.purpleflea.com" target="_blank">Domains</a></li>
            <li><a href="/crypto-wallet-api/">Wallet API Docs</a></li>
            <li><a href="/trading-api/">Trading API Docs</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Developers</h4>
          <ul>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/for-agents">For Agents</a></li>
            <li><a href="/for-langchain/">LangChain</a></li>
            <li><a href="/for-crewai/">CrewAI</a></li>
            <li><a href="/for-claude/">Claude / MCP</a></li>
            <li><a href="/quick-start">Quick Start</a></li>
            <li><a href="/openapi">OpenAPI</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <ul>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/stats">Stats</a></li>
            <li><a href="/changelog">Changelog</a></li>
            <li><a href="/blog/">Blog</a></li>
            <li><a href="mailto:hello@purpleflea.com">Contact</a></li>
            <li><a href="https://github.com/Purple-flea" target="_blank">GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Purple Flea. All rights reserved.</p>
      <div class="footer-social">
        <a href="https://github.com/Purple-flea" target="_blank">GitHub</a>
        <a href="https://x.com/purpleflea" target="_blank">X / Twitter</a>
      </div>
    </div>
  </div>
</footer>

<script>
const navbar = document.getElementById('navbar');
window.addEventListener('scroll', () => { navbar.classList.toggle('scrolled', window.scrollY > 50); });
const revealEls = document.querySelectorAll('.reveal');
const revealObs = new IntersectionObserver((entries) => {
  entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); revealObs.unobserve(e.target); } });
}, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
revealEls.forEach(el => revealObs.observe(el));
</script>
</body>
</html>
