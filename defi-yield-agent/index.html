<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeFi Yield Agent — Autonomous Yield Strategies via Purple Flea APIs</title>
<meta name="description" content="Build autonomous DeFi yield-generating agents with Purple Flea. Funding rate farming on Hyperliquid, basis trading, and referral yield — all via simple REST APIs.">
<link rel="canonical" href="https://purpleflea.com/defi-yield-agent">
<meta property="og:title" content="DeFi Yield Agent — Autonomous Yield Strategies via Purple Flea APIs">
<meta property="og:description" content="Build autonomous DeFi yield-generating agents with Purple Flea. Funding rate farming on Hyperliquid, basis trading, and referral yield — all via simple REST APIs.">
<meta property="og:url" content="https://purpleflea.com/defi-yield-agent">
<meta property="og:type" content="website">
<meta property="og:site_name" content="Purple Flea">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@purpleflea">
<meta name="twitter:title" content="DeFi Yield Agent — Purple Flea">
<meta name="twitter:description" content="Funding rate farming, basis trading, and referral yield for AI agents. Purple Flea Trading + Wallet APIs.">
<meta name="twitter:image" content="https://purpleflea.com/flea.jpg">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "DeFi Yield Agent — Autonomous Yield Strategies via Purple Flea APIs",
  "url": "https://purpleflea.com/defi-yield-agent",
  "description": "Build autonomous DeFi yield-generating agents using Purple Flea Trading and Wallet APIs. Funding rate farming on Hyperliquid, basis trading, and referral yield.",
  "publisher": {"@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com"}
}
</script>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#x1F7E3;</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.3);
  --purple-subtle: rgba(168, 85, 247, 0.08);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255,255,255,0.06);
  --border-hover: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --radius: 16px;
  --radius-sm: 10px;
}
html { scroll-behavior: smooth; }
body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
body::before { content: ''; position: fixed; inset: 0; z-index: 9999; pointer-events: none; opacity: 0.025; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"); background-repeat: repeat; background-size: 180px; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(168,85,247,0.3); border-radius: 3px; }
::selection { background: rgba(168,85,247,0.4); color: white; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.reveal { opacity: 0; transform: translateY(30px); transition: opacity 0.8s cubic-bezier(0.16,1,0.3,1), transform 0.8s cubic-bezier(0.16,1,0.3,1); }
.reveal.visible { opacity: 1; transform: translateY(0); }
.reveal-delay-1 { transition-delay: 0.1s; }
.reveal-delay-2 { transition-delay: 0.2s; }
.reveal-delay-3 { transition-delay: 0.3s; }

/* NAV */
nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 16px 0; transition: all 0.3s ease; }
nav.scrolled { background: rgba(9,9,11,0.85); backdrop-filter: blur(20px) saturate(1.5); border-bottom: 1px solid var(--border); }
.nav-inner { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.nav-logo { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 18px; text-decoration: none; color: var(--text); }
.nav-logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--purple), var(--purple-dim)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
.nav-links { display: flex; align-items: center; gap: 32px; list-style: none; }
.nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 14px; font-weight: 450; transition: color 0.2s; }
.nav-links a:hover { color: var(--text); }
.nav-cta { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; background: var(--purple); color: white !important; border-radius: 8px; font-weight: 500; font-size: 14px; text-decoration: none; transition: all 0.2s; }
.nav-cta:hover { background: var(--purple-dim); transform: translateY(-1px); }
@media (max-width: 768px) { .nav-links { display: none; } }

/* HERO */
.hero { min-height: 80vh; display: flex; align-items: center; justify-content: center; position: relative; padding: 120px 0 80px; overflow: hidden; }
.hero-bg { position: absolute; inset: 0; overflow: hidden; }
.hero-gradient-1 { position: absolute; top: -30%; left: 50%; transform: translateX(-50%); width: 900px; height: 600px; background: radial-gradient(ellipse, rgba(168,85,247,0.15) 0%, transparent 70%); filter: blur(60px); }
.hero-grid { position: absolute; inset: 0; background-image: linear-gradient(rgba(168,85,247,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(168,85,247,0.03) 1px, transparent 1px); background-size: 60px 60px; mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); -webkit-mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black 30%, transparent 100%); }
.hero-content { position: relative; text-align: center; max-width: 860px; margin: 0 auto; padding: 0 24px; }
.hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px 6px 8px; background: var(--purple-subtle); border: 1px solid rgba(168,85,247,0.15); border-radius: 100px; font-size: 13px; font-weight: 500; color: var(--purple); margin-bottom: 32px; animation: fadeInDown 0.8s ease; }
.hero-badge-dot { width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: badge-pulse 2s ease-in-out infinite; }
@keyframes badge-pulse { 0%,100% { opacity:1; } 50% { opacity:0.4; } }
@keyframes fadeInDown { from { opacity:0; transform:translateY(-10px); } to { opacity:1; transform:translateY(0); } }
@keyframes fadeInUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
@keyframes gradient-shift { 0% { background-position:0% center; } 50% { background-position:100% center; } 100% { background-position:0% center; } }
.hero h1 { font-size: clamp(2.5rem, 6vw, 4.5rem); font-weight: 800; line-height: 1.05; letter-spacing: -0.03em; margin-bottom: 24px; animation: fadeInUp 0.8s ease 0.1s both; }
.hero h1 .gradient { background: linear-gradient(135deg, var(--purple) 0%, #C084FC 50%, var(--purple) 100%); background-size: 200% auto; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; animation: gradient-shift 5s ease infinite; }
.hero-desc { font-size: clamp(1rem, 2vw, 1.2rem); color: var(--text-secondary); margin-bottom: 40px; line-height: 1.7; animation: fadeInUp 0.8s ease 0.2s both; }
.hero-actions { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; animation: fadeInUp 0.8s ease 0.3s both; }
.btn-primary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--purple); color: white; border-radius: var(--radius-sm); font-weight: 600; font-size: 15px; text-decoration: none; transition: all 0.2s; box-shadow: 0 0 30px rgba(168,85,247,0.3); }
.btn-primary:hover { background: var(--purple-dim); transform: translateY(-2px); box-shadow: 0 0 40px rgba(168,85,247,0.5); }
.btn-secondary { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; background: var(--bg-card); color: var(--text); border-radius: var(--radius-sm); font-weight: 500; font-size: 15px; text-decoration: none; border: 1px solid var(--border); transition: all 0.2s; }
.btn-secondary:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }

/* HERO STATS */
.hero-stats { display: flex; justify-content: center; gap: 48px; flex-wrap: wrap; margin-top: 56px; padding-top: 48px; border-top: 1px solid var(--border); animation: fadeInUp 0.8s ease 0.4s both; }
.hero-stat { text-align: center; }
.hero-stat .value { font-family: 'JetBrains Mono', monospace; font-size: 1.8rem; font-weight: 700; color: var(--purple); display: block; }
.hero-stat .label { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-top: 4px; }

/* SECTIONS */
section { padding: 100px 0; position: relative; }
.section-label { display: inline-flex; align-items: center; gap: 12px; font-size: 12px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--purple); margin-bottom: 20px; }
.section-label::before { content: ''; width: 24px; height: 1px; background: var(--purple); }
.section-title { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; }
.section-desc { font-size: 1.1rem; color: var(--text-secondary); max-width: 700px; margin-bottom: 40px; line-height: 1.7; }
.section-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 0; }

/* CODE BLOCK */
.code-block { background: rgba(0,0,0,0.45); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.75; overflow-x: auto; position: relative; }
.code-block .code-header { display: flex; align-items: center; gap: 8px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.code-dot { width: 12px; height: 12px; border-radius: 50%; }
.code-dot.red { background: #EF4444; }
.code-dot.yellow { background: #FBBF24; }
.code-dot.green { background: #22C55E; }
.code-filename { margin-left: 8px; font-size: 12px; color: var(--text-muted); }
.kw { color: #C084FC; }
.fn { color: #93C5FD; }
.st { color: #86EFAC; }
.cm { color: var(--text-muted); font-style: italic; }
.num { color: #FDE68A; }
.cls { color: #F9A8D4; }
.at { color: #A855F7; }
.op { color: #94A3B8; }

/* GRID */
.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
@media (max-width: 900px) { .grid-3 { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 768px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }

/* CARDS */
.card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; transition: all 0.3s ease; }
.card:hover { background: var(--bg-card-hover); border-color: var(--border-hover); transform: translateY(-4px); box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 30px rgba(168,85,247,0.05); }
.card-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; margin-bottom: 20px; }
.card-icon.purple { background: rgba(168,85,247,0.15); }
.card-icon.blue { background: rgba(96,165,250,0.15); }
.card-icon.green { background: rgba(34,197,94,0.15); }
.card-icon.orange { background: rgba(251,146,60,0.15); }
.card-icon.red { background: rgba(239,68,68,0.15); }
.card h3 { font-size: 1.1rem; font-weight: 600; margin-bottom: 10px; }
.card p { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; }

/* STRATEGY CARD */
.strategy-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; transition: all 0.3s ease; position: relative; overflow: hidden; }
.strategy-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--purple), transparent); opacity: 0; transition: opacity 0.3s; }
.strategy-card:hover { background: var(--bg-card-hover); border-color: var(--border-hover); transform: translateY(-4px); }
.strategy-card:hover::before { opacity: 1; }
.strategy-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; margin-bottom: 16px; }
.badge-high { background: rgba(34,197,94,0.12); color: #22C55E; border: 1px solid rgba(34,197,94,0.2); }
.badge-neutral { background: rgba(96,165,250,0.12); color: #60A5FA; border: 1px solid rgba(96,165,250,0.2); }
.badge-passive { background: rgba(168,85,247,0.12); color: var(--purple); border: 1px solid rgba(168,85,247,0.2); }
.strategy-card h3 { font-size: 1.2rem; font-weight: 700; margin-bottom: 10px; }
.strategy-card p { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6; margin-bottom: 20px; }
.strategy-stats { display: flex; gap: 24px; flex-wrap: wrap; }
.stat-item { }
.stat-item .stat-val { font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; font-weight: 700; color: var(--text); }
.stat-item .stat-key { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; margin-top: 2px; }

/* YIELD TABLE */
.yield-table { width: 100%; border-collapse: collapse; }
.yield-table th { text-align: left; padding: 12px 16px; font-size: 11px; font-weight: 600; letter-spacing: 0.07em; text-transform: uppercase; color: var(--text-muted); border-bottom: 1px solid var(--border); }
.yield-table td { padding: 16px; font-size: 14px; border-bottom: 1px solid var(--border); vertical-align: middle; }
.yield-table tr:last-child td { border-bottom: none; }
.yield-table tr:hover td { background: var(--bg-card); }
.yield-table .name-col { font-weight: 600; }
.yield-table .mono { font-family: 'JetBrains Mono', monospace; font-size: 13px; }
.yield-table .apy-high { color: #22C55E; font-weight: 700; font-family: 'JetBrains Mono', monospace; }
.yield-table .apy-mid { color: #FBBF24; font-weight: 600; font-family: 'JetBrains Mono', monospace; }
.yield-table .apy-low { color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }
.yield-table .risk-pill { display: inline-block; padding: 3px 10px; border-radius: 20px; font-size: 11px; font-weight: 500; }
.risk-low { background: rgba(34,197,94,0.1); color: #22C55E; }
.risk-med { background: rgba(251,191,36,0.1); color: #FBBF24; }
.risk-high { background: rgba(239,68,68,0.1); color: #EF4444; }

/* RISK / REWARD TABLE */
.rr-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
@media (max-width: 900px) { .rr-grid { grid-template-columns: 1fr; } }
.rr-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; }
.rr-card h4 { font-size: 1rem; font-weight: 700; margin-bottom: 6px; }
.rr-card .subtitle { font-size: 12px; color: var(--purple); text-transform: uppercase; letter-spacing: 0.07em; margin-bottom: 20px; }
.rr-row { display: flex; justify-content: space-between; align-items: baseline; padding: 8px 0; border-bottom: 1px solid var(--border); }
.rr-row:last-child { border-bottom: none; }
.rr-row .rr-label { font-size: 12px; color: var(--text-muted); }
.rr-row .rr-val { font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; }
.rr-pos { color: #22C55E; }
.rr-neg { color: #EF4444; }
.rr-neu { color: var(--text-secondary); }

/* PORTFOLIO BARS */
.alloc-row { display: flex; flex-direction: column; gap: 14px; }
.alloc-item { }
.alloc-header { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 14px; }
.alloc-name { font-weight: 500; }
.alloc-pct { font-family: 'JetBrains Mono', monospace; font-size: 13px; color: var(--purple); font-weight: 600; }
.alloc-bar-bg { height: 6px; background: rgba(255,255,255,0.05); border-radius: 3px; overflow: hidden; }
.alloc-bar-fill { height: 100%; border-radius: 3px; background: linear-gradient(90deg, var(--purple-dim), var(--purple)); transition: width 1s cubic-bezier(0.16,1,0.3,1); }

/* PROSE */
.prose { max-width: 760px; }
.prose p { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; }
.prose h3 { font-size: 1.3rem; font-weight: 700; margin-bottom: 12px; margin-top: 40px; color: var(--text); }
.prose ul { color: var(--text-secondary); font-size: 1rem; line-height: 1.8; margin-bottom: 20px; padding-left: 24px; }
.prose li { margin-bottom: 8px; }

/* CTA */
.cta-section { text-align: center; padding: 100px 0; }
.cta-box { background: linear-gradient(135deg, rgba(168,85,247,0.08) 0%, rgba(124,58,237,0.05) 100%); border: 1px solid rgba(168,85,247,0.2); border-radius: 24px; padding: 80px 40px; position: relative; overflow: hidden; }
.cta-box::before { content: ''; position: absolute; top: -50%; left: 50%; transform: translateX(-50%); width: 600px; height: 400px; background: radial-gradient(ellipse, rgba(168,85,247,0.1) 0%, transparent 70%); filter: blur(40px); pointer-events: none; }
.cta-box h2 { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 20px; position: relative; }
.cta-box p { color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 40px; position: relative; }

/* RELATED */
.related-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 768px) { .related-grid { grid-template-columns: 1fr; } }
.related-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px 24px; text-decoration: none; color: var(--text); display: block; transition: all 0.2s; }
.related-card:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }
.related-card .label { font-size: 11px; color: var(--purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
.related-card .title { font-size: 14px; font-weight: 600; }
.related-card .desc { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

/* FOOTER */
footer { padding: 60px 0 40px; border-top: 1px solid var(--border); }
.footer-top { display: grid; grid-template-columns: 1fr 2fr; gap: 60px; margin-bottom: 60px; }
.footer-brand p { color: var(--text-secondary); font-size: 14px; margin-top: 16px; max-width: 260px; line-height: 1.6; }
.footer-columns { display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; }
.footer-col h4 { font-size: 13px; font-weight: 600; margin-bottom: 16px; }
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.footer-col a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-col a:hover { color: var(--text); }
.footer-bottom { display: flex; align-items: center; justify-content: space-between; padding-top: 24px; border-top: 1px solid var(--border); }
.footer-bottom p { color: var(--text-muted); font-size: 13px; }
.footer-social { display: flex; gap: 24px; }
.footer-social a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-social a:hover { color: var(--text); }
@media (max-width: 768px) { .footer-top { grid-template-columns: 1fr; gap: 40px; } .footer-columns { grid-template-columns: repeat(2,1fr); } .footer-bottom { flex-direction: column; gap: 16px; text-align: center; } }

/* TAX NOTE */
.tax-note { background: rgba(251,191,36,0.05); border: 1px solid rgba(251,191,36,0.15); border-radius: var(--radius-sm); padding: 20px 24px; display: flex; gap: 16px; align-items: flex-start; }
.tax-note .icon { font-size: 1.2rem; flex-shrink: 0; margin-top: 2px; }
.tax-note p { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6; margin: 0; }
.tax-note strong { color: #FBBF24; }
</style>
</head>
<body>

<nav id="navbar">
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <div class="nav-logo-icon">&#9830;</div>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents</a></li>
      <li><a href="/trading-api/">Trading API</a></li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="https://wallet.purpleflea.com" target="_blank" class="nav-cta">Get Started &rarr;</a></li>
    </ul>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg">
    <div class="hero-gradient-1"></div>
    <div class="hero-grid"></div>
  </div>
  <div class="hero-content">
    <div class="hero-badge">
      <div class="hero-badge-dot"></div>
      Autonomous Yield Strategies for AI Agents
    </div>
    <h1>DeFi Yield Agent<br>Powered by <span class="gradient">Purple Flea</span></h1>
    <p class="hero-desc">
      Your agent can earn yield around the clock without relying on traditional DeFi protocols.
      Purple Flea's Trading API unlocks Hyperliquid perpetuals funding rates — the highest
      on-chain yield available today — while the Wallet API handles cross-chain capital movement
      for basis trading and position management.
    </p>
    <div class="hero-actions">
      <a href="https://wallet.purpleflea.com" class="btn-primary" target="_blank">Get Your API Key &rarr;</a>
      <a href="/trading-api/" class="btn-secondary">Trading API Docs</a>
    </div>
    <div class="hero-stats">
      <div class="hero-stat">
        <span class="value">0.05–0.3%</span>
        <span class="label">Funding rate / day</span>
      </div>
      <div class="hero-stat">
        <span class="value">18–110%</span>
        <span class="label">Annualised yield</span>
      </div>
      <div class="hero-stat">
        <span class="value">8h</span>
        <span class="label">Funding interval</span>
      </div>
      <div class="hero-stat">
        <span class="value">3</span>
        <span class="label">Yield strategies</span>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- STRATEGIES -->
<section id="strategies">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Yield Strategies</div>
      <h2 class="section-title">Three Ways Your Agent Earns</h2>
      <p class="section-desc">
        Purple Flea exposes two APIs that together cover every layer of a DeFi yield stack.
        The Trading API connects to Hyperliquid perpetuals; the Wallet API moves tokens
        cross-chain. Combined, your agent can run all three strategies simultaneously.
      </p>
    </div>
    <div class="grid-3 reveal reveal-delay-1">

      <div class="strategy-card">
        <div class="strategy-badge badge-high">Highest yield</div>
        <h3>Funding Rate Farming</h3>
        <p>
          Open a short perpetual on Hyperliquid and collect funding payments every 8 hours
          when the rate is positive. BTC, ETH, and SOL perps routinely pay 0.05–0.3%/day
          during bull markets — that's 18–110% annualised on a market-neutral basis.
          Purple Flea's Trading API handles position entry, monitoring, and exit in a single
          authenticated REST call.
        </p>
        <div class="strategy-stats">
          <div class="stat-item">
            <div class="stat-val">0.05–0.3%</div>
            <div class="stat-key">Per day</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">3&times; leverage</div>
            <div class="stat-key">Typical size</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">Market-neutral</div>
            <div class="stat-key">Direction risk</div>
          </div>
        </div>
      </div>

      <div class="strategy-card">
        <div class="strategy-badge badge-neutral">Market-neutral</div>
        <h3>Basis Trading</h3>
        <p>
          Hold spot (via Wallet API) and short the perp (via Trading API) in equal notional
          size. The spread between spot and perpetual — the "basis" — converges at delivery,
          and funding accrues on the short leg. The position is fully delta-neutral: spot
          gains offset perp losses, and funding is pure profit. Ideal for agents that hold
          crypto inventory already.
        </p>
        <div class="strategy-stats">
          <div class="stat-item">
            <div class="stat-val">Delta-zero</div>
            <div class="stat-key">Price exposure</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">Wallet + Trading</div>
            <div class="stat-key">APIs used</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">Low</div>
            <div class="stat-key">Liquidation risk</div>
          </div>
        </div>
      </div>

      <div class="strategy-card">
        <div class="strategy-badge badge-passive">Passive</div>
        <h3>Referral Yield</h3>
        <p>
          Agents that bring other agents onto Hyperliquid through Purple Flea's referral
          system earn 10–20% of the fees those agents pay — indefinitely. If you're building
          a multi-agent system or an agent marketplace, every agent you register under your
          referral code generates passive yield that requires zero ongoing capital.
        </p>
        <div class="strategy-stats">
          <div class="stat-item">
            <div class="stat-val">10–20%</div>
            <div class="stat-key">Fee share</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">Zero</div>
            <div class="stat-key">Capital required</div>
          </div>
          <div class="stat-item">
            <div class="stat-val">Perpetual</div>
            <div class="stat-key">Duration</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<hr class="section-divider">

<!-- YIELD COMPARISON TABLE -->
<section id="comparison">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Yield Comparison</div>
      <h2 class="section-title">Funding Rates vs Traditional DeFi</h2>
      <p class="section-desc">
        Hyperliquid funding rates compare favourably to every yield source in DeFi, and they
        carry fundamentally different risk characteristics — no smart contract exposure,
        no impermanent loss, and instant liquidity.
      </p>
    </div>
    <div class="reveal reveal-delay-1" style="overflow-x:auto; border: 1px solid var(--border); border-radius: var(--radius);">
      <table class="yield-table">
        <thead>
          <tr>
            <th>Strategy</th>
            <th>Source</th>
            <th>Typical APY</th>
            <th>Direction risk</th>
            <th>Liquidity</th>
            <th>Risk level</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="name-col">Funding rate farming</td>
            <td class="mono">Hyperliquid (via Purple Flea)</td>
            <td class="apy-high">18–110%</td>
            <td>None (short + hedged)</td>
            <td>Instant</td>
            <td><span class="risk-pill risk-med">Medium</span></td>
          </tr>
          <tr>
            <td class="name-col">Basis trading</td>
            <td class="mono">Spot + Hyperliquid perp</td>
            <td class="apy-high">12–60%</td>
            <td>Delta-neutral</td>
            <td>Instant</td>
            <td><span class="risk-pill risk-low">Low</span></td>
          </tr>
          <tr>
            <td class="name-col">Referral yield</td>
            <td class="mono">Purple Flea program</td>
            <td class="apy-high">Unbounded</td>
            <td>None</td>
            <td>Daily</td>
            <td><span class="risk-pill risk-low">Very low</span></td>
          </tr>
          <tr>
            <td class="name-col">Aave USDC lending</td>
            <td class="mono">Ethereum / Polygon</td>
            <td class="apy-mid">3–12%</td>
            <td>None</td>
            <td>Instant</td>
            <td><span class="risk-pill risk-low">Low</span></td>
          </tr>
          <tr>
            <td class="name-col">Uniswap v3 LP (volatile)</td>
            <td class="mono">Ethereum</td>
            <td class="apy-mid">8–40%</td>
            <td>Impermanent loss</td>
            <td>Instant</td>
            <td><span class="risk-pill risk-high">High</span></td>
          </tr>
          <tr>
            <td class="name-col">ETH liquid staking</td>
            <td class="mono">Lido / Rocket Pool</td>
            <td class="apy-low">3–4%</td>
            <td>None</td>
            <td>Seconds</td>
            <td><span class="risk-pill risk-low">Low</span></td>
          </tr>
          <tr>
            <td class="name-col">SOL staking</td>
            <td class="mono">Solana validators</td>
            <td class="apy-low">6–8%</td>
            <td>None</td>
            <td>~2 days</td>
            <td><span class="risk-pill risk-low">Low</span></td>
          </tr>
          <tr>
            <td class="name-col">Kamino USDC</td>
            <td class="mono">Solana</td>
            <td class="apy-mid">5–20%</td>
            <td>None</td>
            <td>Instant</td>
            <td><span class="risk-pill risk-med">Medium</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- FUNDING RATE FARMING BOT -->
<section id="funding-bot">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Code — Strategy 1</div>
      <h2 class="section-title">Funding Rate Farming Bot</h2>
      <p class="section-desc">
        A complete Python agent that registers with Purple Flea's Trading API, polls BTC,
        ETH, and SOL funding rates every 8 hours, opens a 3x short when the rate exceeds
        0.05%, closes when it drops below 0.01%, and tracks cumulative yield.
      </p>
    </div>

    <div class="reveal reveal-delay-1">
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">funding_rate_bot.py</span>
        </div>
<span class="kw">import</span> time, requests, logging
<span class="kw">from</span> datetime <span class="kw">import</span> datetime, timezone
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass, field
<span class="kw">from</span> typing <span class="kw">import</span> Optional

logging.<span class="fn">basicConfig</span>(
    level<span class="op">=</span>logging.INFO,
    format<span class="op">=</span><span class="st">"%(asctime)s %(levelname)-8s %(message)s"</span>,
    datefmt<span class="op">=</span><span class="st">"%Y-%m-%d %H:%M:%S"</span>,
)

<span class="cm"># ── Configuration ─────────────────────────────────────────────────────────────</span>

PURPLE_FLEA_BASE  <span class="op">=</span> <span class="st">"https://api.purpleflea.com"</span>
MARKETS           <span class="op">=</span> [<span class="st">"BTC-PERP"</span>, <span class="st">"ETH-PERP"</span>, <span class="st">"SOL-PERP"</span>]
LEVERAGE          <span class="op">=</span> <span class="num">3</span>          <span class="cm"># 3x short</span>
POSITION_USD      <span class="op">=</span> <span class="num">5_000</span>     <span class="cm"># notional per market</span>
OPEN_THRESHOLD    <span class="op">=</span> <span class="num">0.0005</span>    <span class="cm"># open short when funding &gt; 0.05 %</span>
CLOSE_THRESHOLD   <span class="op">=</span> <span class="num">0.0001</span>    <span class="cm"># close short when funding &lt; 0.01 %</span>
POLL_INTERVAL_SEC <span class="op">=</span> <span class="num">8</span> <span class="op">*</span> <span class="num">3600</span>  <span class="cm"># every 8 hours (one funding epoch)</span>


<span class="cm"># ── Data structures ────────────────────────────────────────────────────────────</span>

<span class="at">@dataclass</span>
<span class="kw">class</span> <span class="cls">Position</span>:
    market: str
    side: str                  <span class="cm"># "short"</span>
    size_usd: float
    entry_price: float
    opened_at: datetime
    funding_collected: float <span class="op">=</span> <span class="num">0.0</span>


<span class="at">@dataclass</span>
<span class="kw">class</span> <span class="cls">YieldLedger</span>:
    total_funding_usd: float <span class="op">=</span> <span class="num">0.0</span>
    epochs_collected: int    <span class="op">=</span> <span class="num">0</span>
    positions_opened: int    <span class="op">=</span> <span class="num">0</span>
    positions_closed: int    <span class="op">=</span> <span class="num">0</span>
    log: list                <span class="op">=</span> field(default_factory<span class="op">=</span>list)

    <span class="kw">def</span> <span class="fn">record</span>(self, market, rate, payout_usd):
        self.total_funding_usd <span class="op">+=</span> payout_usd
        self.epochs_collected  <span class="op">+=</span> <span class="num">1</span>
        self.log.<span class="fn">append</span>({
            <span class="st">"ts"</span>: datetime.<span class="fn">now</span>(timezone.utc).<span class="fn">isoformat</span>(),
            <span class="st">"market"</span>: market,
            <span class="st">"rate"</span>: rate,
            <span class="st">"payout_usd"</span>: payout_usd,
        })


<span class="cm"># ── API client ─────────────────────────────────────────────────────────────────</span>

<span class="kw">class</span> <span class="cls">PurpleFleaTrading</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(self, api_key: str):
        self.session <span class="op">=</span> requests.<span class="fn">Session</span>()
        self.session.headers.<span class="fn">update</span>({
            <span class="st">"Authorization"</span>: <span class="st">f"Bearer {api_key}"</span>,
            <span class="st">"Content-Type"</span>: <span class="st">"application/json"</span>,
        })
        self.base <span class="op">=</span> PURPLE_FLEA_BASE

    <span class="kw">def</span> <span class="fn">register</span>(self) <span class="op">-&gt;</span> dict:
        <span class="st">"""Register this agent instance with Purple Flea Trading API."""</span>
        r <span class="op">=</span> self.session.<span class="fn">post</span>(<span class="st">f"{self.base}/trading/register"</span>, json={
            <span class="st">"agent_name"</span>: <span class="st">"funding-rate-farmer"</span>,
            <span class="st">"description"</span>: <span class="st">"Autonomous funding rate harvesting bot"</span>,
            <span class="st">"markets"</span>: MARKETS,
        })
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">funding_rate</span>(self, market: str) <span class="op">-&gt;</span> float:
        <span class="st">"""Return current 8-hour funding rate for a perp market."""</span>
        r <span class="op">=</span> self.session.<span class="fn">get</span>(<span class="st">f"{self.base}/trading/funding"</span>,
                              params<span class="op">=</span>{<span class="st">"market"</span>: market})
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> <span class="fn">float</span>(r.<span class="fn">json</span>()[<span class="st">"funding_rate"</span>])  <span class="cm"># e.g. 0.00063</span>

    <span class="kw">def</span> <span class="fn">open_short</span>(self, market: str, size_usd: float, leverage: int) <span class="op">-&gt;</span> dict:
        r <span class="op">=</span> self.session.<span class="fn">post</span>(<span class="st">f"{self.base}/trading/order"</span>, json={
            <span class="st">"market"</span>: market,
            <span class="st">"side"</span>: <span class="st">"sell"</span>,
            <span class="st">"type"</span>: <span class="st">"market"</span>,
            <span class="st">"size_usd"</span>: size_usd,
            <span class="st">"leverage"</span>: leverage,
            <span class="st">"reduce_only"</span>: <span class="kw">False</span>,
        })
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">close_position</span>(self, market: str) <span class="op">-&gt;</span> dict:
        r <span class="op">=</span> self.session.<span class="fn">post</span>(<span class="st">f"{self.base}/trading/close"</span>,
                              json<span class="op">=</span>{<span class="st">"market"</span>: market})
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()


<span class="cm"># ── Main agent loop ────────────────────────────────────────────────────────────</span>

<span class="kw">class</span> <span class="cls">FundingRateAgent</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(self, api_key: str):
        self.api     <span class="op">=</span> <span class="cls">PurpleFleaTrading</span>(api_key)
        self.ledger  <span class="op">=</span> <span class="cls">YieldLedger</span>()
        self.open_positions: dict[str, <span class="cls">Position</span>] <span class="op">=</span> {}

    <span class="kw">def</span> <span class="fn">start</span>(self):
        logging.<span class="fn">info</span>(<span class="st">"Registering agent with Purple Flea Trading API..."</span>)
        reg <span class="op">=</span> self.api.<span class="fn">register</span>()
        logging.<span class="fn">info</span>(<span class="st">f"Registered. Agent ID: {reg.get('agent_id')}"</span>)

        <span class="kw">while True</span>:
            self.<span class="fn">_tick</span>()
            logging.<span class="fn">info</span>(
                <span class="st">f"Cycle complete. Cumulative yield: "
                f"${self.ledger.total_funding_usd:,.2f} USD "
                f"across {self.ledger.epochs_collected} epochs."</span>
            )
            time.<span class="fn">sleep</span>(POLL_INTERVAL_SEC)

    <span class="kw">def</span> <span class="fn">_tick</span>(self):
        <span class="kw">for</span> market <span class="kw">in</span> MARKETS:
            <span class="kw">try</span>:
                rate <span class="op">=</span> self.api.<span class="fn">funding_rate</span>(market)
                logging.<span class="fn">info</span>(<span class="st">f"  {market:12s}  funding={rate:.4%}"</span>)

                <span class="kw">if</span> market <span class="kw">in</span> self.open_positions:
                    pos <span class="op">=</span> self.open_positions[market]
                    payout <span class="op">=</span> pos.size_usd <span class="op">*</span> rate
                    self.ledger.<span class="fn">record</span>(market, rate, payout)
                    pos.funding_collected <span class="op">+=</span> payout
                    logging.<span class="fn">info</span>(<span class="st">f"    Collected ${payout:.2f}  total=${pos.funding_collected:.2f}"</span>)

                    <span class="kw">if</span> rate <span class="op">&lt;</span> CLOSE_THRESHOLD:
                        logging.<span class="fn">info</span>(<span class="st">f"    Rate below close threshold — closing {market}"</span>)
                        self.api.<span class="fn">close_position</span>(market)
                        <span class="kw">del</span> self.open_positions[market]
                        self.ledger.positions_closed <span class="op">+=</span> <span class="num">1</span>

                <span class="kw">elif</span> rate <span class="op">&gt;=</span> OPEN_THRESHOLD:
                    logging.<span class="fn">info</span>(<span class="st">f"    Rate above open threshold — opening {LEVERAGE}x short on {market}"</span>)
                    resp <span class="op">=</span> self.api.<span class="fn">open_short</span>(market, POSITION_USD, LEVERAGE)
                    self.open_positions[market] <span class="op">=</span> <span class="cls">Position</span>(
                        market<span class="op">=</span>market,
                        side<span class="op">=</span><span class="st">"short"</span>,
                        size_usd<span class="op">=</span>POSITION_USD,
                        entry_price<span class="op">=</span><span class="fn">float</span>(resp[<span class="st">"fill_price"</span>]),
                        opened_at<span class="op">=</span>datetime.<span class="fn">now</span>(timezone.utc),
                    )
                    self.ledger.positions_opened <span class="op">+=</span> <span class="num">1</span>

            <span class="kw">except Exception as</span> e:
                logging.<span class="fn">error</span>(<span class="st">f"Error processing {market}: {e}"</span>)


<span class="kw">if</span> __name__ <span class="op">==</span> <span class="st">"__main__"</span>:
    agent <span class="op">=</span> <span class="cls">FundingRateAgent</span>(api_key<span class="op">=</span><span class="st">"pf_sk_YOUR_KEY_HERE"</span>)
    agent.<span class="fn">start</span>()
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- BASIS TRADING STRATEGY -->
<section id="basis-trading">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Code — Strategy 2</div>
      <h2 class="section-title">Basis Trading: Both Legs</h2>
      <p class="section-desc">
        Basis trading requires two simultaneous positions: a spot long (funded via the
        Wallet API) and a perpetual short (via the Trading API). Both legs must be equal
        notional size to achieve true delta-neutrality.
      </p>
    </div>

    <div class="reveal reveal-delay-1">
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">basis_trade.py</span>
        </div>
<span class="kw">import</span> requests, logging
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass

log <span class="op">=</span> logging.<span class="fn">getLogger</span>(<span class="st">"basis_trade"</span>)

<span class="cm"># ── Wallet API: buy and hold spot ──────────────────────────────────────────────</span>

<span class="kw">class</span> <span class="cls">WalletAPI</span>:
    <span class="st">"""Purple Flea Wallet API — cross-chain token movements and spot swaps."""</span>
    <span class="kw">def</span> <span class="fn">__init__</span>(self, api_key: str):
        self.s <span class="op">=</span> requests.<span class="fn">Session</span>()
        self.s.headers[<span class="st">"Authorization"</span>] <span class="op">=</span> <span class="st">f"Bearer {api_key}"</span>
        self.base <span class="op">=</span> <span class="st">"https://api.purpleflea.com/wallet"</span>

    <span class="kw">def</span> <span class="fn">buy_spot</span>(self, token: str, amount_usd: float, chain: str <span class="op">=</span> <span class="st">"ethereum"</span>) <span class="op">-&gt;</span> dict:
        <span class="st">"""Buy {token} worth {amount_usd} USD on {chain} via Purple Flea."""</span>
        r <span class="op">=</span> self.s.<span class="fn">post</span>(<span class="st">f"{self.base}/swap"</span>, json<span class="op">=</span>{
            <span class="st">"from_token"</span>: <span class="st">"USDC"</span>,
            <span class="st">"to_token"</span>: token,
            <span class="st">"amount_usd"</span>: amount_usd,
            <span class="st">"chain"</span>: chain,
            <span class="st">"slippage"</span>: <span class="num">0.005</span>,
        })
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">sell_spot</span>(self, token: str, amount_usd: float, chain: str <span class="op">=</span> <span class="st">"ethereum"</span>) <span class="op">-&gt;</span> dict:
        <span class="st">"""Sell {token} back to USDC to close the spot leg."""</span>
        r <span class="op">=</span> self.s.<span class="fn">post</span>(<span class="st">f"{self.base}/swap"</span>, json<span class="op">=</span>{
            <span class="st">"from_token"</span>: token,
            <span class="st">"to_token"</span>: <span class="st">"USDC"</span>,
            <span class="st">"amount_usd"</span>: amount_usd,
            <span class="st">"chain"</span>: chain,
            <span class="st">"slippage"</span>: <span class="num">0.005</span>,
        })
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">balance</span>(self, token: str, chain: str <span class="op">=</span> <span class="st">"ethereum"</span>) <span class="op">-&gt;</span> float:
        r <span class="op">=</span> self.s.<span class="fn">get</span>(<span class="st">f"{self.base}/balance"</span>,
                       params<span class="op">=</span>{<span class="st">"token"</span>: token, <span class="st">"chain"</span>: chain})
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> <span class="fn">float</span>(r.<span class="fn">json</span>()[<span class="st">"balance_usd"</span>])


<span class="cm"># ── Trading API: short the perp ────────────────────────────────────────────────</span>

<span class="kw">class</span> <span class="cls">TradingAPI</span>:
    <span class="st">"""Purple Flea Trading API — Hyperliquid perpetuals."""</span>
    <span class="kw">def</span> <span class="fn">__init__</span>(self, api_key: str):
        self.s <span class="op">=</span> requests.<span class="fn">Session</span>()
        self.s.headers[<span class="st">"Authorization"</span>] <span class="op">=</span> <span class="st">f"Bearer {api_key}"</span>
        self.base <span class="op">=</span> <span class="st">"https://api.purpleflea.com/trading"</span>

    <span class="kw">def</span> <span class="fn">open_short</span>(self, market: str, size_usd: float) <span class="op">-&gt;</span> dict:
        <span class="st">"""Open 1x short perp — no leverage for basis, delta-neutral."""</span>
        r <span class="op">=</span> self.s.<span class="fn">post</span>(<span class="st">f"{self.base}/order"</span>, json<span class="op">=</span>{
            <span class="st">"market"</span>: market,
            <span class="st">"side"</span>: <span class="st">"sell"</span>,
            <span class="st">"type"</span>: <span class="st">"market"</span>,
            <span class="st">"size_usd"</span>: size_usd,
            <span class="st">"leverage"</span>: <span class="num">1</span>,
        })
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">close_short</span>(self, market: str) <span class="op">-&gt;</span> dict:
        r <span class="op">=</span> self.s.<span class="fn">post</span>(<span class="st">f"{self.base}/close"</span>, json<span class="op">=</span>{<span class="st">"market"</span>: market})
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> r.<span class="fn">json</span>()

    <span class="kw">def</span> <span class="fn">funding_rate</span>(self, market: str) <span class="op">-&gt;</span> float:
        r <span class="op">=</span> self.s.<span class="fn">get</span>(<span class="st">f"{self.base}/funding"</span>, params<span class="op">=</span>{<span class="st">"market"</span>: market})
        r.<span class="fn">raise_for_status</span>()
        <span class="kw">return</span> <span class="fn">float</span>(r.<span class="fn">json</span>()[<span class="st">"funding_rate"</span>])


<span class="cm"># ── Basis trade: open both legs ────────────────────────────────────────────────</span>

<span class="at">@dataclass</span>
<span class="kw">class</span> <span class="cls">BasisPosition</span>:
    token: str
    notional_usd: float
    spot_tx: dict
    perp_tx: dict
    funding_collected: float <span class="op">=</span> <span class="num">0.0</span>

<span class="kw">def</span> <span class="fn">open_basis_trade</span>(
    wallet: <span class="cls">WalletAPI</span>,
    trading: <span class="cls">TradingAPI</span>,
    token: str,           <span class="cm"># "BTC", "ETH", "SOL"</span>
    notional_usd: float,  <span class="cm"># equal size on both legs</span>
    chain: str <span class="op">=</span> <span class="st">"ethereum"</span>,
) <span class="op">-&gt;</span> <span class="cls">BasisPosition</span>:
    market <span class="op">=</span> <span class="st">f"{token}-PERP"</span>

    log.<span class="fn">info</span>(<span class="st">f"Opening basis trade on {token}: ${notional_usd:,.0f} each leg"</span>)

    <span class="cm"># Leg 1: buy spot via Wallet API</span>
    spot <span class="op">=</span> wallet.<span class="fn">buy_spot</span>(token, notional_usd, chain)
    log.<span class="fn">info</span>(<span class="st">f"  Spot leg opened: tx={spot.get('tx_hash')}"</span>)

    <span class="cm"># Leg 2: short perp via Trading API (1x = delta-neutral with spot)</span>
    perp <span class="op">=</span> trading.<span class="fn">open_short</span>(market, notional_usd)
    log.<span class="fn">info</span>(<span class="st">f"  Perp leg opened: fill_price={perp.get('fill_price')}"</span>)

    <span class="kw">return</span> <span class="cls">BasisPosition</span>(token<span class="op">=</span>token, notional_usd<span class="op">=</span>notional_usd, spot_tx<span class="op">=</span>spot, perp_tx<span class="op">=</span>perp)


<span class="kw">def</span> <span class="fn">close_basis_trade</span>(
    wallet: <span class="cls">WalletAPI</span>,
    trading: <span class="cls">TradingAPI</span>,
    pos: <span class="cls">BasisPosition</span>,
    chain: str <span class="op">=</span> <span class="st">"ethereum"</span>,
):
    market <span class="op">=</span> <span class="st">f"{pos.token}-PERP"</span>
    log.<span class="fn">info</span>(<span class="st">f"Closing basis trade on {pos.token}. Funding collected: ${pos.funding_collected:.2f}"</span>)

    <span class="cm"># Close perp first to avoid naked exposure during liquidation window</span>
    trading.<span class="fn">close_short</span>(market)
    wallet.<span class="fn">sell_spot</span>(pos.token, pos.notional_usd, chain)


<span class="cm"># ── Example usage ──────────────────────────────────────────────────────────────</span>

<span class="kw">if</span> __name__ <span class="op">==</span> <span class="st">"__main__"</span>:
    KEY <span class="op">=</span> <span class="st">"pf_sk_YOUR_KEY_HERE"</span>
    wallet  <span class="op">=</span> <span class="cls">WalletAPI</span>(KEY)
    trading <span class="op">=</span> <span class="cls">TradingAPI</span>(KEY)

    <span class="cm"># Open a $10k ETH basis trade</span>
    pos <span class="op">=</span> <span class="fn">open_basis_trade</span>(wallet, trading, token<span class="op">=</span><span class="st">"ETH"</span>, notional_usd<span class="op">=</span><span class="num">10_000</span>)
    <span class="fn">print</span>(<span class="st">f"Basis position open: {pos}"</span>)
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RISK / REWARD ANALYSIS -->
<section id="risk-reward">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Risk / Reward</div>
      <h2 class="section-title">Strategy Risk Analysis</h2>
      <p class="section-desc">
        Each strategy has a distinct risk / reward profile. Understanding the tail risks
        before your agent allocates capital is essential — especially for leveraged funding
        rate farming where rapid funding rate reversals can trigger liquidations.
      </p>
    </div>

    <div class="rr-grid reveal reveal-delay-1">

      <div class="rr-card">
        <h4>Funding Rate Farming</h4>
        <div class="subtitle">3x short perp</div>
        <div class="rr-row"><span class="rr-label">Expected daily yield</span><span class="rr-val rr-pos">0.05–0.3%</span></div>
        <div class="rr-row"><span class="rr-label">Annual (mid estimate)</span><span class="rr-val rr-pos">~65% APY</span></div>
        <div class="rr-row"><span class="rr-label">Price direction risk</span><span class="rr-val rr-neg">Yes (short)</span></div>
        <div class="rr-row"><span class="rr-label">Liquidation risk</span><span class="rr-val rr-neg">Yes at 3x</span></div>
        <div class="rr-row"><span class="rr-label">Funding reversal</span><span class="rr-val rr-neg">Pays instead of earns</span></div>
        <div class="rr-row"><span class="rr-label">Smart contract risk</span><span class="rr-val rr-neu">None (CEX)</span></div>
        <div class="rr-row"><span class="rr-label">Mitigation</span><span class="rr-val rr-neu">Auto-close at &lt;0.01%</span></div>
      </div>

      <div class="rr-card">
        <h4>Basis Trading</h4>
        <div class="subtitle">Long spot + short perp</div>
        <div class="rr-row"><span class="rr-label">Expected daily yield</span><span class="rr-val rr-pos">0.03–0.2%</span></div>
        <div class="rr-row"><span class="rr-label">Annual (mid estimate)</span><span class="rr-val rr-pos">~40% APY</span></div>
        <div class="rr-row"><span class="rr-label">Price direction risk</span><span class="rr-val rr-pos">Delta-neutral</span></div>
        <div class="rr-row"><span class="rr-label">Liquidation risk</span><span class="rr-val rr-pos">Low (1x perp)</span></div>
        <div class="rr-row"><span class="rr-label">Spot custody risk</span><span class="rr-val rr-neg">If Wallet API fails</span></div>
        <div class="rr-row"><span class="rr-label">Leg mismatch risk</span><span class="rr-val rr-neg">Partial fill slippage</span></div>
        <div class="rr-row"><span class="rr-label">Mitigation</span><span class="rr-val rr-neu">Open perp first, hedge after</span></div>
      </div>

      <div class="rr-card">
        <h4>Referral Yield</h4>
        <div class="subtitle">Passive fee share</div>
        <div class="rr-row"><span class="rr-label">Expected yield</span><span class="rr-val rr-pos">10–20% of sub-fees</span></div>
        <div class="rr-row"><span class="rr-label">Capital at risk</span><span class="rr-val rr-pos">Zero</span></div>
        <div class="rr-row"><span class="rr-label">Direction risk</span><span class="rr-val rr-pos">None</span></div>
        <div class="rr-row"><span class="rr-label">Downside scenario</span><span class="rr-val rr-neg">Sub-agents go inactive</span></div>
        <div class="rr-row"><span class="rr-label">Platform risk</span><span class="rr-val rr-neg">Program terms change</span></div>
        <div class="rr-row"><span class="rr-label">Upside scenario</span><span class="rr-val rr-pos">Scales with sub count</span></div>
        <div class="rr-row"><span class="rr-label">Mitigation</span><span class="rr-val rr-neu">Diversify sub-agent activity</span></div>
      </div>

    </div>
  </div>
</section>

<hr class="section-divider">

<!-- TAX / ACCOUNTING -->
<section id="tax">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Tax &amp; Accounting</div>
      <h2 class="section-title">Tracking Yield for Tax Purposes</h2>
    </div>
    <div class="prose reveal reveal-delay-1">
      <p>
        Funding payments received on perpetual positions are typically treated as
        ordinary income in most jurisdictions — similar to interest income — and should
        be recorded at the USD value at the time each 8-hour settlement occurs.
        Your agent should log every funding payment with a UTC timestamp, the market,
        the rate, and the USD equivalent.
      </p>
      <p>
        Basis trades introduce two separate cost-basis events: the spot purchase and the
        perp position. When you close the spot leg, the gain or loss is calculated against
        the original purchase price. Funding collected on the perp short is separate income.
        These are not netted against each other for tax purposes in most regulatory frameworks.
      </p>
      <h3>What to log per epoch</h3>
      <ul>
        <li>Timestamp (UTC ISO-8601)</li>
        <li>Market (e.g. BTC-PERP)</li>
        <li>Funding rate (8-hour, as a decimal)</li>
        <li>Notional position size (USD)</li>
        <li>Funding payment received (USD)</li>
        <li>Cumulative funding to date (USD)</li>
        <li>Open / close events with fill prices</li>
      </ul>
      <p>
        The <code style="font-family:'JetBrains Mono',monospace; color:var(--purple); font-size:0.9em;">YieldLedger</code>
        dataclass in the funding bot above captures all of this. Export
        <code style="font-family:'JetBrains Mono',monospace; color:var(--purple); font-size:0.9em;">ledger.log</code>
        as a CSV at the end of each quarter and pass it to your accountant or tax software.
      </p>
    </div>
    <div class="tax-note reveal reveal-delay-2" style="margin-top: 24px; max-width: 760px;">
      <div class="icon">&#9888;</div>
      <p>
        <strong>Disclaimer:</strong> This is not tax advice. Tax treatment of DeFi yield
        varies significantly by jurisdiction. Consult a qualified tax professional familiar
        with crypto assets before filing. Your agent should keep immutable logs — blockchain
        records are auditable evidence.
      </p>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- COMPOUNDING -->
<section id="compounding">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Compounding</div>
      <h2 class="section-title">Auto-Reinvesting Yield</h2>
      <p class="section-desc">
        Funding payments settle in USDC every 8 hours. Once accumulated yield exceeds
        a minimum threshold, your agent can auto-reinvest by increasing position size
        — compounding the yield back into the strategy.
      </p>
    </div>

    <div class="reveal reveal-delay-1">
      <div class="code-block">
        <div class="code-header">
          <div class="code-dot red"></div>
          <div class="code-dot yellow"></div>
          <div class="code-dot green"></div>
          <span class="code-filename">compound_yield.py</span>
        </div>
<span class="cm"># ── Compound: reinvest funding into larger positions ───────────────────────────</span>

COMPOUND_THRESHOLD_USD <span class="op">=</span> <span class="num">50</span>   <span class="cm"># only reinvest once $50 has accumulated</span>
COMPOUND_FRACTION      <span class="op">=</span> <span class="num">0.8</span>  <span class="cm"># keep 20% as buffer; reinvest 80%</span>

<span class="kw">def</span> <span class="fn">maybe_compound</span>(agent: <span class="cls">FundingRateAgent</span>):
    <span class="st">"""
    Called after each funding epoch. If accumulated yield exceeds the
    threshold, resize open positions upward to compound the returns.
    """</span>
    undeployed <span class="op">=</span> agent.ledger.total_funding_usd  <span class="cm"># simplified: track undeployed cash</span>

    <span class="kw">if</span> undeployed <span class="op">&lt;</span> COMPOUND_THRESHOLD_USD:
        <span class="kw">return</span>  <span class="cm"># not enough to compound yet</span>

    reinvest <span class="op">=</span> undeployed <span class="op">*</span> COMPOUND_FRACTION
    per_market <span class="op">=</span> reinvest <span class="op">/</span> <span class="fn">len</span>(agent.open_positions) <span class="kw">if</span> agent.open_positions <span class="kw">else</span> <span class="num">0</span>

    log.<span class="fn">info</span>(<span class="st">f"Compounding ${reinvest:.2f} across {len(agent.open_positions)} open positions"</span>)

    <span class="kw">for</span> market, pos <span class="kw">in</span> agent.open_positions.<span class="fn">items</span>():
        <span class="kw">if</span> per_market <span class="op">&gt;</span> <span class="num">10</span>:  <span class="cm"># min order size</span>
            resp <span class="op">=</span> agent.api.<span class="fn">open_short</span>(market, per_market, LEVERAGE)
            pos.size_usd <span class="op">+=</span> per_market
            log.<span class="fn">info</span>(<span class="st">f"  Increased {market} position by ${per_market:.2f} → total ${pos.size_usd:.2f}"</span>)

    <span class="cm"># Reset the undeployed counter (in a real system, track cash balance separately)</span>
    agent.ledger.total_funding_usd <span class="op">*=</span> (<span class="num">1</span> <span class="op">-</span> COMPOUND_FRACTION)


<span class="cm"># ── Effect of compounding on annual returns ────────────────────────────────────</span>

<span class="kw">def</span> <span class="fn">compound_projection</span>(daily_rate: float, principal: float, days: int) <span class="op">-&gt;</span> <span class="fn">None</span>:
    <span class="st">"""Print balance over time with and without compounding."""</span>
    simple   <span class="op">=</span> principal <span class="op">*</span> (<span class="num">1</span> <span class="op">+</span> daily_rate <span class="op">*</span> days)
    compound <span class="op">=</span> principal <span class="op">*</span> ((<span class="num">1</span> <span class="op">+</span> daily_rate) <span class="op">**</span> days)
    <span class="fn">print</span>(<span class="st">f"Principal: ${principal:,.0f} | Daily rate: {daily_rate:.3%} | Days: {days}"</span>)
    <span class="fn">print</span>(<span class="st">f"  Simple   → ${simple:,.2f}   (gain: ${simple-principal:,.2f})"</span>)
    <span class="fn">print</span>(<span class="st">f"  Compound → ${compound:,.2f}  (gain: ${compound-principal:,.2f})"</span>)
    <span class="fn">print</span>(<span class="st">f"  Compounding edge: ${compound-simple:,.2f}"</span>)

<span class="cm"># $10,000 at 0.1%/day for 365 days</span>
<span class="fn">compound_projection</span>(<span class="num">0.001</span>, <span class="num">10_000</span>, <span class="num">365</span>)
<span class="cm"># Simple   → $13,650.00   (gain: $3,650.00)</span>
<span class="cm"># Compound → $14,430.77   (gain: $4,430.77)</span>
<span class="cm"># Compounding edge: $780.77</span>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- PORTFOLIO ALLOCATION -->
<section id="portfolio">
  <div class="container">
    <div class="reveal">
      <div class="section-label">Portfolio Allocation</div>
      <h2 class="section-title">Suggested Strategy Mix</h2>
      <p class="section-desc">
        No single strategy is optimal in all market conditions. The suggested allocation
        below balances yield maximisation during high-funding environments with resilience
        when rates collapse.
      </p>
    </div>

    <div class="grid-2 reveal reveal-delay-1">
      <div>
        <div class="alloc-row">
          <div class="alloc-item">
            <div class="alloc-header">
              <span class="alloc-name">Funding Rate Farming (BTC/ETH/SOL)</span>
              <span class="alloc-pct">50%</span>
            </div>
            <div class="alloc-bar-bg">
              <div class="alloc-bar-fill" style="width:50%"></div>
            </div>
          </div>
          <div class="alloc-item">
            <div class="alloc-header">
              <span class="alloc-name">Basis Trading (delta-neutral)</span>
              <span class="alloc-pct">30%</span>
            </div>
            <div class="alloc-bar-bg">
              <div class="alloc-bar-fill" style="width:30%"></div>
            </div>
          </div>
          <div class="alloc-item">
            <div class="alloc-header">
              <span class="alloc-name">Cash / USDC (dry powder)</span>
              <span class="alloc-pct">15%</span>
            </div>
            <div class="alloc-bar-bg">
              <div class="alloc-bar-fill" style="width:15%; background: rgba(255,255,255,0.2);"></div>
            </div>
          </div>
          <div class="alloc-item">
            <div class="alloc-header">
              <span class="alloc-name">Referral yield compounding</span>
              <span class="alloc-pct">5%</span>
            </div>
            <div class="alloc-bar-bg">
              <div class="alloc-bar-fill" style="width:5%; background: rgba(96,165,250,0.7);"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="prose">
        <h3>Allocation logic</h3>
        <p>
          Funding rate farming gets the largest share because it has the highest risk-adjusted
          yield when markets are trending. But it carries short-side price risk: if BTC pumps
          10% in an hour, the unrealised loss on the 3x short exceeds the weeks of funding
          collected. The 15% cash reserve exists to top up margin and avoid liquidation.
        </p>
        <p>
          Basis trading (30%) provides a lower-volatility floor. Since both legs move together,
          the PnL is smoother and survives bear markets where funding rates collapse. It earns
          less in bull markets but does not blow up.
        </p>
        <p>
          In practice, your agent should shift allocation dynamically: increase funding
          farming when rates exceed 0.1%/day; increase basis trading when rates are below
          0.05%/day; increase cash when volatility spikes above 5% daily range.
        </p>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<!-- RELATED -->
<section>
  <div class="container">
    <div class="reveal">
      <div class="section-label">Keep Reading</div>
      <h2 class="section-title">Related Guides</h2>
    </div>
    <div class="related-grid reveal reveal-delay-1">
      <a href="/trading-api/" class="related-card">
        <div class="label">API Reference</div>
        <div class="title">Trading API</div>
        <div class="desc">Hyperliquid perps, funding rates, and position management</div>
      </a>
      <a href="/crypto-wallet-api/" class="related-card">
        <div class="label">API Reference</div>
        <div class="title">Wallet API</div>
        <div class="desc">Cross-chain swaps, balances, and spot token movements</div>
      </a>
      <a href="/funding-rate-arbitrage/" class="related-card">
        <div class="label">Deep Dive</div>
        <div class="title">Funding Rate Arbitrage</div>
        <div class="desc">Full guide to cash-and-carry on Hyperliquid perpetuals</div>
      </a>
    </div>
  </div>
</section>

<!-- CTA -->
<section class="cta-section">
  <div class="container">
    <div class="cta-box reveal">
      <h2>Build an agent that<br>earns while it <span style="color:var(--purple)">thinks.</span></h2>
      <p>Register once. Earn funding every 8 hours. No KYC. No minimums.</p>
      <div class="hero-actions">
        <a href="https://wallet.purpleflea.com" class="btn-primary" target="_blank">Register your agent &rarr;</a>
        <a href="/trading-api/" class="btn-secondary">Trading API docs</a>
      </div>
    </div>
  </div>
</section>

<hr class="section-divider">

<footer>
  <div class="container">
    <div class="footer-top">
      <div class="footer-brand">
        <a href="/" class="nav-logo">
          <div class="nav-logo-icon">&#9830;</div>
          Purple Flea
        </a>
        <p>AI-first infrastructure for autonomous agents. Built for machines, verified by math.</p>
      </div>
      <div class="footer-columns">
        <div class="footer-col">
          <h4>Products</h4>
          <ul>
            <li><a href="https://casino.purpleflea.com" target="_blank">Casino</a></li>
            <li><a href="https://trading.purpleflea.com" target="_blank">Trading</a></li>
            <li><a href="https://wallet.purpleflea.com" target="_blank">Wallet</a></li>
            <li><a href="https://domains.purpleflea.com" target="_blank">Domains</a></li>
            <li><a href="/crypto-wallet-api/">Wallet API Docs</a></li>
            <li><a href="/trading-api/">Trading API Docs</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Developers</h4>
          <ul>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/for-agents">For Agents</a></li>
            <li><a href="/for-langchain/">LangChain</a></li>
            <li><a href="/for-crewai/">CrewAI</a></li>
            <li><a href="/for-claude/">Claude / MCP</a></li>
            <li><a href="/quick-start">Quick Start</a></li>
            <li><a href="/openapi">OpenAPI</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <ul>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/stats">Stats</a></li>
            <li><a href="/changelog">Changelog</a></li>
            <li><a href="/blog/">Blog</a></li>
            <li><a href="mailto:hello@purpleflea.com">Contact</a></li>
            <li><a href="https://github.com/Purple-flea" target="_blank">GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Purple Flea. All rights reserved.</p>
      <div class="footer-social">
        <a href="https://github.com/Purple-flea" target="_blank">GitHub</a>
        <a href="https://x.com/purpleflea" target="_blank">X / Twitter</a>
      </div>
    </div>
  </div>
</footer>

<script>
const navbar = document.getElementById('navbar');
window.addEventListener('scroll', () => {
  navbar.classList.toggle('scrolled', window.scrollY > 50);
});
const revealEls = document.querySelectorAll('.reveal');
const revealObs = new IntersectionObserver((entries) => {
  entries.forEach(e => {
    if (e.isIntersecting) { e.target.classList.add('visible'); revealObs.unobserve(e.target); }
  });
}, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
revealEls.forEach(el => revealObs.observe(el));
</script>
</body>
</html>
