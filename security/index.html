<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Security ‚Äî Purple Flea API</title>
<meta name="description" content="Purple Flea security model: non-custodial wallets, provably fair casino, API key authentication, DDoS protection, responsible disclosure, and audit status.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://purpleflea.com/security">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üü£</text></svg>">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://purpleflea.com/security">
<meta property="og:title" content="Security ‚Äî Purple Flea API">
<meta property="og:description" content="Cryptographically verified. Non-custodial. Your keys, your funds. Purple Flea security architecture, provably fair casino, and responsible disclosure.">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Security ‚Äî Purple Flea API">
<meta name="twitter:description" content="Cryptographically verified. Non-custodial. Your keys, your funds.">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "name": "Purple Flea Security",
  "url": "https://purpleflea.com/security",
  "description": "Security architecture for Purple Flea APIs: non-custodial wallets, provably fair casino mechanics, API authentication, and responsible disclosure.",
  "author": {"@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com"},
  "publisher": {"@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com"}
}
</script>

<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.2);
  --bg: #09090B;
  --bg-sidebar: #0D0D10;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.05);
  --border: rgba(255, 255, 255, 0.06);
  --border-purple: rgba(168, 85, 247, 0.25);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --green: #22C55E;
  --blue: #60A5FA;
  --amber: #F59E0B;
  --red: #F87171;
  --radius: 12px;
  --mono: 'JetBrains Mono', 'Fira Code', monospace;
  --sidebar-width: 260px;
}

html { scroll-behavior: smooth; }

body {
  font-family: 'Inter', -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  display: flex;
  min-height: 100vh;
}

::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(168,85,247,0.25); border-radius: 3px; }

/* Sidebar */
.sidebar {
  width: var(--sidebar-width);
  flex-shrink: 0;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border);
  height: 100vh;
  position: sticky;
  top: 0;
  overflow-y: auto;
  padding: 20px 0 40px;
}
.sidebar-logo {
  display: flex; align-items: center; gap: 8px;
  padding: 0 20px 20px;
  border-bottom: 1px solid var(--border);
  text-decoration: none; color: var(--text);
  font-weight: 700; font-size: 0.95rem;
}
.sidebar-logo-icon { color: var(--purple); font-size: 1.1rem; }
.sidebar-section {
  padding: 20px 20px 8px;
  font-size: 0.65rem; font-weight: 700; letter-spacing: 0.12em;
  text-transform: uppercase; color: var(--text-muted);
}
.sidebar-link {
  display: block; padding: 7px 20px;
  font-size: 0.825rem; color: var(--text-secondary);
  text-decoration: none; border-left: 2px solid transparent;
  transition: all 0.15s;
}
.sidebar-link:hover { color: var(--text); background: rgba(255,255,255,0.03); }
.sidebar-link.active {
  color: var(--purple); border-left-color: var(--purple);
  background: rgba(168,85,247,0.06);
}
.sidebar-link.sub { padding-left: 32px; font-size: 0.78rem; }

/* Main content */
.main {
  flex: 1;
  min-width: 0;
  max-width: 800px;
  padding: 48px 48px 80px;
}
@media (max-width: 768px) {
  body { flex-direction: column; }
  .sidebar { width: 100%; height: auto; position: static; }
  .main { padding: 24px 20px 60px; }
}

/* Typography */
h1 { font-size: 2rem; font-weight: 800; letter-spacing: -0.04em; line-height: 1.15; margin-bottom: 16px; }
h2 { font-size: 1.4rem; font-weight: 700; letter-spacing: -0.03em; margin: 40px 0 14px; padding-top: 20px; border-top: 1px solid var(--border); }
h2:first-child { border-top: none; padding-top: 0; margin-top: 0; }
h3 { font-size: 1.05rem; font-weight: 600; letter-spacing: -0.02em; margin: 28px 0 10px; color: var(--text); }
p { color: var(--text-secondary); margin-bottom: 14px; font-size: 0.925rem; }
p:last-child { margin-bottom: 0; }
a { color: var(--purple); text-decoration: none; }
a:hover { text-decoration: underline; }
ul, ol { color: var(--text-secondary); margin: 12px 0 16px 20px; font-size: 0.9rem; }
li { margin-bottom: 6px; }
strong { color: var(--text); font-weight: 600; }
code {
  font-family: var(--mono); font-size: 0.82em;
  background: rgba(168,85,247,0.1); color: var(--purple);
  padding: 1px 5px; border-radius: 4px;
}

/* Page intro */
.page-intro {
  padding-bottom: 32px; margin-bottom: 12px;
  border-bottom: 1px solid var(--border);
}
.page-tag {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(168,85,247,0.1); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.72rem; font-weight: 600;
  padding: 3px 10px; border-radius: 20px; margin-bottom: 16px;
  text-transform: uppercase; letter-spacing: 0.06em;
}

/* Code block */
.code-block {
  background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.07);
  border-radius: var(--radius); padding: 18px 20px;
  font-family: var(--mono); font-size: 0.8rem; color: #D4D4D8;
  white-space: pre; overflow-x: auto; margin: 14px 0 20px;
  position: relative; line-height: 1.6;
}
.code-block .comment { color: var(--text-muted); }
.code-block .string { color: #86EFAC; }
.code-block .keyword { color: #C084FC; }
.code-block .number { color: #FCA5A5; }
.code-block .url { color: #67E8F9; }
.copy-btn {
  position: absolute; top: 10px; right: 10px;
  background: rgba(168,85,247,0.15); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.68rem; font-weight: 600;
  padding: 3px 10px; border-radius: 6px; cursor: pointer;
  font-family: 'Inter', sans-serif; transition: background 0.15s;
}
.copy-btn:hover { background: rgba(168,85,247,0.28); }

/* Param table */
.param-table {
  width: 100%; border-collapse: collapse;
  font-size: 0.82rem; margin: 12px 0 20px;
}
.param-table th {
  text-align: left; padding: 8px 12px;
  color: var(--text-muted); font-weight: 500; font-size: 0.72rem;
  border-bottom: 1px solid var(--border);
  text-transform: uppercase; letter-spacing: 0.06em;
}
.param-table td {
  padding: 10px 12px; border-bottom: 1px solid rgba(255,255,255,0.03);
  color: var(--text-secondary); vertical-align: top;
}
.param-table td:first-child { color: var(--text); font-size: 0.88rem; }
.param-table td.mono { font-family: var(--mono); font-size: 0.78rem; }
.param-table tr:last-child td { border-bottom: none; }

/* Status badges */
.status-badge {
  display: inline-block; font-size: 0.7rem; font-weight: 700;
  padding: 2px 9px; border-radius: 20px;
}
.status-pending { background: rgba(245,158,11,0.12); color: var(--amber); border: 1px solid rgba(245,158,11,0.3); }
.status-active  { background: rgba(34,197,94,0.1);  color: var(--green); border: 1px solid rgba(34,197,94,0.25); }
.status-never   { background: rgba(248,113,113,0.1); color: var(--red);   border: 1px solid rgba(248,113,113,0.25); }

/* Callout boxes */
.callout {
  border-radius: var(--radius); padding: 14px 18px;
  margin: 16px 0; font-size: 0.875rem;
  display: flex; gap: 12px; align-items: flex-start;
}
.callout-info    { background: rgba(96,165,250,0.07);  border: 1px solid rgba(96,165,250,0.2); }
.callout-success { background: rgba(34,197,94,0.07);   border: 1px solid rgba(34,197,94,0.2); }
.callout-warning { background: rgba(245,158,11,0.07);  border: 1px solid rgba(245,158,11,0.2); }
.callout-danger  { background: rgba(248,113,113,0.07); border: 1px solid rgba(248,113,113,0.25); }
.callout-purple  { background: rgba(168,85,247,0.07);  border: 1px solid var(--border-purple); }
.callout-icon { font-size: 1rem; flex-shrink: 0; margin-top: 1px; }
.callout p { color: var(--text-secondary); margin: 0; font-size: 0.85rem; }
.callout strong { color: var(--text); }

/* Breadcrumb */
.breadcrumb {
  display: flex; gap: 8px; align-items: center;
  font-size: 0.78rem; color: var(--text-muted); margin-bottom: 20px;
}
.breadcrumb a { color: var(--text-muted); text-decoration: none; }
.breadcrumb a:hover { color: var(--purple); }
.breadcrumb span { color: var(--text-secondary); }

/* Principle cards */
.principle-cards { display: flex; flex-direction: column; gap: 8px; margin: 16px 0 24px; }
.principle-card {
  display: flex; gap: 16px; align-items: flex-start;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 10px; padding: 16px 18px;
  transition: border-color 0.2s;
}
.principle-card:hover { border-color: var(--border-purple); }
.principle-num {
  width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
  background: rgba(168,85,247,0.12); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.78rem; font-weight: 700;
  display: flex; align-items: center; justify-content: center;
  margin-top: 2px;
}
.principle-body { flex: 1; min-width: 0; }
.principle-title { font-size: 0.95rem; font-weight: 600; color: var(--text); margin-bottom: 5px; }
.principle-desc { font-size: 0.83rem; color: var(--text-secondary); line-height: 1.55; }

/* Steps */
.steps { margin: 14px 0 20px; display: flex; flex-direction: column; gap: 0; }
.step {
  display: flex; gap: 0; align-items: stretch;
}
.step-left {
  display: flex; flex-direction: column; align-items: center;
  width: 40px; flex-shrink: 0;
}
.step-dot {
  width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
  background: rgba(168,85,247,0.12); border: 1px solid var(--border-purple);
  color: var(--purple); font-size: 0.72rem; font-weight: 700;
  display: flex; align-items: center; justify-content: center;
  margin-top: 14px;
}
.step-line {
  width: 1px; flex: 1; background: var(--border);
  margin: 4px 0;
}
.step:last-child .step-line { display: none; }
.step-body {
  flex: 1; min-width: 0;
  padding: 14px 0 20px 14px;
}
.step-title { font-size: 0.9rem; font-weight: 600; color: var(--text); margin-bottom: 5px; }
.step-desc { font-size: 0.82rem; color: var(--text-secondary); }

/* Never-do list */
.never-list { margin: 14px 0 20px; display: flex; flex-direction: column; gap: 6px; }
.never-item {
  display: flex; align-items: center; gap: 12px;
  background: rgba(248,113,113,0.05); border: 1px solid rgba(248,113,113,0.15);
  border-radius: 8px; padding: 11px 14px;
  font-size: 0.85rem; color: var(--text-secondary);
}
.never-x {
  color: var(--red); font-weight: 700; font-size: 0.9rem; flex-shrink: 0;
}

/* SLA table */
.sla-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 14px 0 20px; }
@media (max-width: 600px) { .sla-grid { grid-template-columns: 1fr; } }
.sla-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 10px; padding: 16px;
}
.sla-severity { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 6px; }
.sla-critical { color: var(--red); }
.sla-high     { color: var(--amber); }
.sla-medium   { color: var(--blue); }
.sla-time { font-size: 1.1rem; font-weight: 700; color: var(--text); margin-bottom: 4px; font-family: var(--mono); }
.sla-desc { font-size: 0.78rem; color: var(--text-muted); }
</style>
</head>
<body>

<!-- Sidebar -->
<aside class="sidebar">
  <a href="/" class="sidebar-logo">
    <span class="sidebar-logo-icon">&#9830;</span>
    Purple Flea
  </a>

  <div class="sidebar-section">Security</div>
  <a href="#principles" class="sidebar-link active">Core Principles</a>
  <a href="#non-custodial" class="sidebar-link sub">Non-Custodial Wallets</a>
  <a href="#provably-fair" class="sidebar-link sub">Provably Fair Casino</a>
  <a href="#api-keys" class="sidebar-link sub">API Key Auth</a>
  <a href="#https" class="sidebar-link sub">HTTPS Only</a>
  <a href="#never" class="sidebar-link">What We Never Do</a>
  <a href="#audit" class="sidebar-link">Audit Status</a>
  <a href="#smart-contracts" class="sidebar-link sub">Smart Contracts</a>
  <a href="#ddos" class="sidebar-link">DDoS Protection</a>
  <a href="#incident-response" class="sidebar-link">Incident Response</a>
  <a href="#disclosure" class="sidebar-link">Responsible Disclosure</a>

  <div class="sidebar-section">Docs</div>
  <a href="/docs" class="sidebar-link">API Reference</a>
  <a href="/rate-limits" class="sidebar-link">Rate Limits</a>
  <a href="/quick-start" class="sidebar-link">Quick Start</a>
  <a href="/for-agents" class="sidebar-link">For Agents</a>

  <div class="sidebar-section">Links</div>
  <a href="https://purpleflea.com" class="sidebar-link">‚Üê purpleflea.com</a>
  <a href="/llms.txt" class="sidebar-link">llms.txt</a>
  <a href="https://github.com/purple-flea" target="_blank" class="sidebar-link">GitHub ‚Üó</a>
</aside>

<!-- Main -->
<main class="main">

  <div class="page-intro">
    <div class="breadcrumb">
      <a href="/">purpleflea.com</a>
      <span>/</span>
      <span>security</span>
    </div>
    <div class="page-tag">Security</div>
    <h1>Security</h1>
    <p>Cryptographically verified. Non-custodial. Your keys, your funds. This page documents the security architecture of Purple Flea APIs, how provably fair gaming works, what we never do, and how to report vulnerabilities.</p>
  </div>

  <!-- Core Principles -->
  <section id="principles">
    <h2>Core Security Principles</h2>
    <p>Purple Flea is designed around four non-negotiable security properties. These are not aspirational ‚Äî they are structural constraints enforced at the protocol level.</p>

    <div class="principle-cards">
      <div class="principle-card" id="non-custodial">
        <div class="principle-num">1</div>
        <div class="principle-body">
          <div class="principle-title">Non-custodial wallets</div>
          <div class="principle-desc">
            You hold your BIP-39 mnemonic. Purple Flea never stores, transmits, or has access to your seed phrase. Mnemonics are generated and displayed exactly once at wallet creation ‚Äî after that, they exist only where you put them. If you lose it, it cannot be recovered.
          </div>
        </div>
      </div>
      <div class="principle-card" id="provably-fair">
        <div class="principle-num">2</div>
        <div class="principle-body">
          <div class="principle-title">Provably fair casino (HMAC-SHA256)</div>
          <div class="principle-desc">
            Every casino game outcome is deterministic and verifiable. Before each bet, the server commits to a server seed via SHA-256 hash published in the response. After the bet resolves, the original seed is revealed ‚Äî allowing you to independently verify the outcome could not have been manipulated. The scheme uses HMAC-SHA256 with server seed + client seed + nonce.
          </div>
        </div>
      </div>
      <div class="principle-card" id="api-keys">
        <div class="principle-num">3</div>
        <div class="principle-body">
          <div class="principle-title">API key authentication (Bearer token, revocable)</div>
          <div class="principle-desc">
            All API endpoints require a Bearer token in the <code>Authorization</code> header. Keys are revocable at any time ‚Äî a compromised key can be invalidated without affecting your account balance or wallet. Scoped keys allow read-only access to be granted separately from write/execute access.
          </div>
        </div>
      </div>
      <div class="principle-card" id="https">
        <div class="principle-num">4</div>
        <div class="principle-body">
          <div class="principle-title">HTTPS-only endpoints</div>
          <div class="principle-desc">
            All API endpoints enforce TLS 1.2 or higher. HTTP requests are rejected with a 301 redirect to the HTTPS equivalent ‚Äî no plaintext API traffic is accepted. HSTS headers are set on all responses with a 1-year max-age.
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Provably Fair Explained -->
  <section id="provably-fair-detail">
    <h2>Provably Fair: Step by Step</h2>
    <p>The seed commitment scheme ensures that neither Purple Flea nor the player can manipulate the outcome after a bet is placed. Here is the exact sequence for every game round:</p>

    <div class="steps">
      <div class="step">
        <div class="step-left">
          <div class="step-dot">1</div>
          <div class="step-line"></div>
        </div>
        <div class="step-body">
          <div class="step-title">Server generates a secret seed</div>
          <div class="step-desc">Before your bet is accepted, the server generates a random <code>server_seed</code> (32 bytes of CSPRNG output). This seed determines the outcome but is not yet revealed.</div>
        </div>
      </div>
      <div class="step">
        <div class="step-left">
          <div class="step-dot">2</div>
          <div class="step-line"></div>
        </div>
        <div class="step-body">
          <div class="step-title">Commitment hash is returned with the bet response</div>
          <div class="step-desc">The API response includes <code>server_seed_hash: SHA256(server_seed)</code>. You can record this hash before the round ends. The server cannot change <code>server_seed</code> after committing the hash without detection.</div>
        </div>
      </div>
      <div class="step">
        <div class="step-left">
          <div class="step-dot">3</div>
          <div class="step-line"></div>
        </div>
        <div class="step-body">
          <div class="step-title">Outcome is computed with HMAC-SHA256</div>
          <div class="step-desc">The game outcome is derived as <code>HMAC-SHA256(server_seed, client_seed + ":" + nonce)</code>. The <code>client_seed</code> can be any string you provide; the <code>nonce</code> increments per bet. This makes the outcome partially determined by entropy you control.</div>
        </div>
      </div>
      <div class="step">
        <div class="step-left">
          <div class="step-dot">4</div>
          <div class="step-line"></div>
        </div>
        <div class="step-body">
          <div class="step-title">Server seed is revealed on verify</div>
          <div class="step-desc">After the bet resolves, call <code>GET /verify/:bet_id</code>. The response includes the original <code>server_seed</code>. You can confirm <code>SHA256(server_seed) == server_seed_hash</code> and recompute the outcome yourself to verify it matches.</div>
        </div>
      </div>
    </div>

    <div class="code-block" id="verify-example"><button class="copy-btn" onclick="copyBlock('verify-example',this)">Copy</button><span class="comment"># Verify a bet outcome independently</span>
curl https://api.purpleflea.com/api/v1/verify/bet_abc123 \
  -H "Authorization: Bearer sk_live_..."

<span class="string">{
  "bet_id": "bet_abc123",
  "game": "dice",
  "server_seed": "a3f8c2e1d4b7...",
  "server_seed_hash": "sha256:4d7e9f2a...",
  "client_seed": "my_agent_seed_42",
  "nonce": 17,
  "hmac": "7f3e1a9c...",
  "result": 73,
  "won": true,
  "verified": true
}</span>

<span class="comment"># Recompute locally in Python</span>
<span class="keyword">import</span> hmac, hashlib, json

server_seed = <span class="string">"a3f8c2e1d4b7..."</span>
client_seed = <span class="string">"my_agent_seed_42"</span>
nonce       = <span class="number">17</span>

<span class="comment"># Verify commitment</span>
assert hashlib.sha256(server_seed.encode()).hexdigest() == <span class="string">"4d7e9f2a..."</span>

<span class="comment"># Recompute outcome</span>
msg = f<span class="string">"{client_seed}:{nonce}"</span>.encode()
key = server_seed.encode()
digest = hmac.new(key, msg, hashlib.sha256).hexdigest()
result = (int(digest[<span class="number">0</span>:<span class="number">8</span>], <span class="number">16</span>) % <span class="number">100</span>) + <span class="number">1</span>
<span class="keyword">print</span>(result)  <span class="comment"># should print 73</span></div>
  </section>

  <!-- Wallet Security -->
  <section id="wallet-security">
    <h2>Wallet Security</h2>
    <p>Purple Flea Wallet is a non-custodial HD wallet service. Understanding what this means in practice is important before storing value.</p>

    <h3>Mnemonic shown once</h3>
    <p>When you call <code>POST /wallet/create</code>, the API generates a BIP-39 mnemonic (12 or 24 words) and returns it in the response body. This is the only time the mnemonic is ever transmitted or visible. It is not stored server-side ‚Äî not in the database, not in logs, not in backups. <strong>There is no recovery mechanism.</strong></p>

    <div class="callout callout-danger">
      <span class="callout-icon">&#9888;</span>
      <p><strong>Store the mnemonic immediately and securely.</strong> Treat it like a private key. Agents should store the mnemonic in encrypted secrets storage (e.g., HashiCorp Vault, AWS Secrets Manager, environment-variable secrets) and never log it, embed it in source code, or transmit it over HTTP.</p>
    </div>

    <h3>Private keys and signing</h3>
    <p>When calling <code>POST /wallet/send</code>, you provide the <code>private_key</code> in the request body. This is used server-side to sign and broadcast the transaction. If you are uncomfortable with this model, derive the private key locally from your mnemonic and sign transactions client-side ‚Äî the API also accepts pre-signed raw transactions via <code>POST /wallet/broadcast</code>.</p>

    <div class="callout callout-info">
      <span class="callout-icon">&#9432;</span>
      <p><strong>Derivation paths by chain:</strong> Ethereum/EVM chains use <code>m/44'/60'/0'/0/0</code>. Solana uses <code>m/44'/501'/0'/0'</code>. Tron uses <code>m/44'/195'/0'/0/0</code>. Bitcoin uses <code>m/84'/0'/0'/0/0</code> (native segwit). All are standard BIP-44/BIP-84 paths derivable by any compatible wallet library.</p>
    </div>
  </section>

  <!-- API Key Best Practices -->
  <section id="api-key-practices">
    <h2>API Key Best Practices</h2>
    <p>API keys are Bearer tokens scoped to your account. Treat them as passwords ‚Äî they grant full account access unless you use scoped keys.</p>

    <h3>Key types</h3>
    <table class="param-table">
      <thead>
        <tr>
          <th>Key Type</th>
          <th>Prefix</th>
          <th>Permissions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Full access</td>
          <td class="mono">sk_live_...</td>
          <td>All endpoints: read, write, execute, withdraw</td>
        </tr>
        <tr>
          <td>Read-only</td>
          <td class="mono">sk_ro_...</td>
          <td>GET endpoints only ‚Äî no bets, trades, or sends</td>
        </tr>
        <tr>
          <td>Trade-only</td>
          <td class="mono">sk_trade_...</td>
          <td>Trading and casino endpoints ‚Äî no wallet sends</td>
        </tr>
      </tbody>
    </table>

    <h3>Rotation and revocation</h3>
    <p>Rotate keys periodically. If a key is compromised, revoke it immediately via <code>POST /auth/revoke</code> with your current key ‚Äî a new key is issued in the same response. Revocation is instant; the old key stops working within seconds.</p>

    <div class="callout callout-warning">
      <span class="callout-icon">&#9888;</span>
      <p><strong>Use scoped keys for agent deployments.</strong> If you are deploying an agent that only needs to trade, issue it a <code>sk_trade_</code> key. A compromised trade-only key cannot drain your wallet. Always apply the principle of least privilege.</p>
    </div>
  </section>

  <!-- What Purple Flea Never Does -->
  <section id="never">
    <h2>What Purple Flea Never Does</h2>
    <p>If you receive a communication claiming to be from Purple Flea that asks for any of the following, it is a scam.</p>

    <div class="never-list">
      <div class="never-item">
        <span class="never-x">&#10005;</span>
        Purple Flea will never ask for your BIP-39 mnemonic or seed phrase ‚Äî not over email, chat, support ticket, or any API endpoint.
      </div>
      <div class="never-item">
        <span class="never-x">&#10005;</span>
        Purple Flea does not take custody of your funds. No deposit address shown in the Casino or Trading APIs is a Purple Flea-controlled wallet used for custody ‚Äî it is a smart contract or pass-through address.
      </div>
      <div class="never-item">
        <span class="never-x">&#10005;</span>
        Purple Flea will never ask you to install a browser extension, desktop app, or wallet plugin to access the API.
      </div>
      <div class="never-item">
        <span class="never-x">&#10005;</span>
        Purple Flea support staff will never ask for your full API key. If you need to share key details for debugging, share only the key prefix (<code>sk_live_abc1</code>) ‚Äî never the full string.
      </div>
      <div class="never-item">
        <span class="never-x">&#10005;</span>
        Purple Flea does not offer "guaranteed returns", "arbitrage bots", or "managed trading" services. Any such offer using the Purple Flea name is fraudulent.
      </div>
    </div>
  </section>

  <!-- Audit Status -->
  <section id="audit">
    <h2>Audit Status</h2>
    <p>We are committed to transparency about the current state of security review.</p>

    <table class="param-table">
      <thead>
        <tr>
          <th>Component</th>
          <th>Audit Status</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Casino API (backend)</td>
          <td><span class="status-badge status-pending">Pending</span></td>
          <td>Third-party audit scheduled for Q2 2025</td>
        </tr>
        <tr>
          <td>Provably fair RNG</td>
          <td><span class="status-badge status-pending">Pending</span></td>
          <td>Included in casino audit scope</td>
        </tr>
        <tr>
          <td>Trading API</td>
          <td><span class="status-badge status-pending">Pending</span></td>
          <td>Dependent on Hyperliquid's own audit</td>
        </tr>
        <tr>
          <td>Wallet API</td>
          <td><span class="status-badge status-pending">Pending</span></td>
          <td>HD derivation logic review scheduled</td>
        </tr>
        <tr>
          <td>TLS / network layer</td>
          <td><span class="status-badge status-active">Active</span></td>
          <td>Cloudflare-managed, continuous scanning</td>
        </tr>
      </tbody>
    </table>

    <div class="callout callout-warning">
      <span class="callout-icon">&#9888;</span>
      <p><strong>Honest disclosure:</strong> No third-party smart contract or backend audit has been completed yet. We are pending audit and will publish all findings ‚Äî including any issues identified ‚Äî in the <a href="/changelog">changelog</a> when the audit is complete. Do not place more value at risk than you are comfortable with given this status.</p>
    </div>

    <h3 id="smart-contracts">Smart Contract Verification</h3>
    <p>Any on-chain contracts used by Purple Flea APIs are verified on their respective chain explorers. Verified contracts allow independent inspection of all logic before interacting.</p>

    <table class="param-table">
      <thead>
        <tr>
          <th>Contract</th>
          <th>Chain</th>
          <th>Explorer</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Casino Settlement</td>
          <td>Base</td>
          <td><a href="https://basescan.org" target="_blank" rel="noopener">basescan.org ‚Üó</a></td>
        </tr>
        <tr>
          <td>Swap Router</td>
          <td>Ethereum / Base</td>
          <td><a href="https://etherscan.io" target="_blank" rel="noopener">etherscan.io ‚Üó</a></td>
        </tr>
        <tr>
          <td>Referral Registry</td>
          <td>Base</td>
          <td><a href="https://basescan.org" target="_blank" rel="noopener">basescan.org ‚Üó</a></td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- DDoS Protection -->
  <section id="ddos">
    <h2>DDoS Protection</h2>
    <p>All Purple Flea API endpoints sit behind Cloudflare's network. Cloudflare provides:</p>
    <ul>
      <li>Anycast routing across 300+ PoPs globally ‚Äî traffic is absorbed close to origin</li>
      <li>Automatic volumetric DDoS mitigation at layers 3, 4, and 7</li>
      <li>Bot management and browser integrity checks at the edge</li>
      <li>Rate limiting at the CDN layer, separate from the application-level limits described in <a href="/rate-limits">Rate Limits</a></li>
    </ul>

    <div class="callout callout-info">
      <span class="callout-icon">&#9432;</span>
      <p><strong>Agent IP allowlisting:</strong> Enterprise tier customers can request Cloudflare IP allowlisting for their agent infrastructure. This bypasses bot detection heuristics that can occasionally flag high-frequency non-browser traffic. Contact <a href="mailto:hello@purpleflea.com">hello@purpleflea.com</a> to configure.</p>
    </div>
  </section>

  <!-- Incident Response -->
  <section id="incident-response">
    <h2>Incident Response</h2>
    <p>Purple Flea maintains an incident response process for security events. The following SLAs apply from the time an incident is confirmed:</p>

    <div class="sla-grid">
      <div class="sla-card">
        <div class="sla-severity sla-critical">Critical</div>
        <div class="sla-time">2 hours</div>
        <div class="sla-desc">Funds at risk, authentication bypass, or data breach. Service halted if necessary.</div>
      </div>
      <div class="sla-card">
        <div class="sla-severity sla-high">High</div>
        <div class="sla-time">24 hours</div>
        <div class="sla-desc">Game integrity compromise, key exposure, or serious availability degradation.</div>
      </div>
      <div class="sla-card">
        <div class="sla-severity sla-medium">Medium</div>
        <div class="sla-time">72 hours</div>
        <div class="sla-desc">Minor information disclosure, rate limit bypass, or non-critical configuration errors.</div>
      </div>
    </div>

    <p>Incident status is posted in real time at <a href="/status">purpleflea.com/status</a>. Post-mortems for critical and high incidents are published in the <a href="/changelog">changelog</a> within 7 days of resolution.</p>

    <div class="callout callout-purple">
      <span class="callout-icon">&#9830;</span>
      <p><strong>Affected users are notified directly.</strong> If an incident affects your API key or funds, you will be contacted at the email address on your account within the SLA window. Ensure your registration email is monitored.</p>
    </div>
  </section>

  <!-- Responsible Disclosure -->
  <section id="disclosure">
    <h2>Responsible Disclosure</h2>
    <p>We welcome security research on Purple Flea services. If you discover a vulnerability, please report it responsibly before public disclosure.</p>

    <h3>How to report</h3>
    <p>Email <a href="mailto:security@purpleflea.com">security@purpleflea.com</a> with a description of the issue, reproduction steps, and the potential impact. We will acknowledge receipt within 24 hours and provide a fix timeline within 72 hours.</p>

    <div class="callout callout-success">
      <span class="callout-icon">&#10003;</span>
      <p><strong>Safe harbor:</strong> Security researchers acting in good faith who follow responsible disclosure practices will not face legal action from Purple Flea. We commit to not pursuing claims under the CFAA or similar statutes against researchers who disclose to us before going public.</p>
    </div>

    <h3>Scope</h3>
    <ul>
      <li><code>api.purpleflea.com</code> ‚Äî Casino and Trading APIs</li>
      <li><code>wallet.purpleflea.com</code> ‚Äî Wallet API</li>
      <li><code>domains.purpleflea.com</code> ‚Äî Domains API</li>
      <li><code>purpleflea.com</code> ‚Äî Main website and documentation</li>
      <li>All on-chain contracts listed under Smart Contract Verification</li>
    </ul>

    <h3>Out of scope</h3>
    <ul>
      <li>Volumetric denial-of-service attacks (these are handled by Cloudflare, not us)</li>
      <li>Social engineering attacks against Purple Flea staff</li>
      <li>Vulnerabilities in third-party dependencies that have upstream fixes already published</li>
      <li>Issues requiring physical access to infrastructure</li>
    </ul>

    <p>Contact for security issues: <a href="mailto:security@purpleflea.com">security@purpleflea.com</a><br>
    General contact: <a href="mailto:hello@purpleflea.com">hello@purpleflea.com</a></p>
  </section>

</main>

<script>
function copyBlock(id, btn) {
  const el = document.getElementById(id);
  const text = el.innerText.replace(/^Copy$|^Copied!$/m, '').trim();
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}

const sections = document.querySelectorAll('section[id]');
const links = document.querySelectorAll('.sidebar-link');
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      links.forEach(l => l.classList.remove('active'));
      const active = document.querySelector(`.sidebar-link[href="#${entry.target.id}"]`);
      if (active) active.classList.add('active');
    }
  });
}, { rootMargin: '-30% 0px -60% 0px' });
sections.forEach(s => observer.observe(s));
</script>

</body>
</html>
