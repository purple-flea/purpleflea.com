<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Purple Flea for Letta Agents — Financial Superpowers for Stateful AI</title>
  <meta name="description" content="Give your Letta (MemGPT) agents real financial capabilities. Casino bets, trading positions, crypto wallets, and domain registration — all via a single API your stateful agents can call." />
  <meta name="keywords" content="Letta, MemGPT, AI agents, LLM tools, Purple Flea API, stateful agents, AI casino, AI trading, agent wallet, AI economy" />
  <link rel="canonical" href="https://purpleflea.com/for-letta" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://purpleflea.com/for-letta" />
  <meta property="og:title" content="Purple Flea x Letta — Financial Superpowers for Stateful AI Agents" />
  <meta property="og:description" content="Give your Letta agents persistent memory of balances, positions, and bets. One API. Casino, trading, wallets, and domains — all ready for your agents to call." />
  <meta property="og:image" content="https://purpleflea.com/og/for-letta.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Purple Flea x Letta — Financial Superpowers for AI Agents" />
  <meta name="twitter:description" content="Letta agents with persistent memory of their Purple Flea balances, open positions, and more. 10-20% commissions on every action." />
  <meta name="twitter:image" content="https://purpleflea.com/og/for-letta.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Purple Flea Integration Guide for Letta AI Agents",
    "description": "Complete guide for integrating Purple Flea's financial API with Letta (MemGPT) stateful AI agents. Includes casino, trading, wallet, and domain tools.",
    "url": "https://purpleflea.com/for-letta",
    "author": {
      "@type": "Organization",
      "name": "Purple Flea",
      "url": "https://purpleflea.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Purple Flea",
      "url": "https://purpleflea.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://purpleflea.com/logo.png"
      }
    },
    "datePublished": "2026-02-27",
    "dateModified": "2026-02-27",
    "about": [
      { "@type": "SoftwareApplication", "name": "Letta", "applicationCategory": "AI Framework" },
      { "@type": "SoftwareApplication", "name": "MemGPT", "applicationCategory": "AI Framework" }
    ]
  }
  </script>

  <style>
    /* ---- Design Tokens ---------------------------------------- */
    :root {
      --purple: #A855F7;
      --purple-dim: #7C3AED;
      --bg: #09090B;
      --text: #FAFAFA;
      --text-secondary: #A1A1AA;
      --text-muted: #71717A;
      --border: rgba(255,255,255,0.06);
      --bg-card: rgba(255,255,255,0.03);
      --radius: 16px;
      --radius-sm: 10px;
      --amber: #F59E0B;
      --green: #10B981;
      --blue: #3B82F6;
      --pink: #EC4899;
    }

    /* ---- Reset ------------------------------------------------- */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }
    a { color: inherit; text-decoration: none; }
    ul { list-style: none; }

    /* ---- Layout ----------------------------------------------- */
    .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }
    .section { padding: 96px 0; }

    /* ---- Nav --------------------------------------------------- */
    nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 100;
      background: rgba(9,9,11,0.85);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
    }
    .nav-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 60px;
    }
    .nav-logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 1rem;
      letter-spacing: -0.01em;
    }
    .nav-logo-icon {
      width: 32px; height: 32px;
      background: linear-gradient(135deg, var(--purple-dim), var(--purple));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }
    .nav-links {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .nav-links a {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-secondary);
      transition: color 0.2s, background 0.2s;
    }
    .nav-links a:hover { color: var(--text); background: var(--bg-card); }
    .btn-nav {
      padding: 8px 18px;
      border-radius: 10px;
      font-size: 0.875rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--purple-dim), var(--purple));
      color: #fff;
      border: none;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.15s;
      white-space: nowrap;
    }
    .btn-nav:hover { opacity: 0.9; transform: translateY(-1px); }

    /* ---- Hero -------------------------------------------------- */
    .hero {
      padding-top: 140px;
      padding-bottom: 96px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .hero::before {
      content: '';
      position: absolute;
      top: -200px; left: 50%;
      transform: translateX(-50%);
      width: 800px; height: 600px;
      background: radial-gradient(ellipse, rgba(168,85,247,0.18) 0%, transparent 70%);
      pointer-events: none;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      border-radius: 100px;
      border: 1px solid rgba(168,85,247,0.35);
      background: rgba(168,85,247,0.08);
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      color: var(--purple);
      text-transform: uppercase;
      margin-bottom: 28px;
    }
    .badge-dot {
      width: 6px; height: 6px;
      border-radius: 50%;
      background: var(--purple);
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    .hero h1 {
      font-size: clamp(2.4rem, 6vw, 4.2rem);
      font-weight: 800;
      letter-spacing: -0.03em;
      line-height: 1.1;
      margin-bottom: 24px;
    }
    .hero h1 span { color: var(--purple); }
    .hero p {
      font-size: clamp(1rem, 2.5vw, 1.2rem);
      color: var(--text-secondary);
      max-width: 580px;
      margin: 0 auto 40px;
      line-height: 1.7;
    }
    .hero-ctas {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      flex-wrap: wrap;
    }
    .btn-primary {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 14px 28px;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--purple-dim), var(--purple));
      color: #fff;
      transition: opacity 0.2s, transform 0.15s;
    }
    .btn-primary:hover { opacity: 0.9; transform: translateY(-2px); }
    .btn-secondary {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 14px 28px;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      border: 1px solid var(--border);
      color: var(--text-secondary);
      background: var(--bg-card);
      transition: border-color 0.2s, color 0.2s;
    }
    .btn-secondary:hover { border-color: rgba(168,85,247,0.4); color: var(--text); }
    .hero-stats {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 48px;
      margin-top: 72px;
      flex-wrap: wrap;
    }
    .stat { text-align: center; }
    .stat-val {
      font-size: 1.75rem;
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .stat-val span { color: var(--purple); }
    .stat-label { font-size: 0.8rem; color: var(--text-muted); margin-top: 4px; }

    /* ---- Section Headers --------------------------------------- */
    .section-eyebrow {
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--purple);
      margin-bottom: 12px;
    }
    .section-title {
      font-size: clamp(1.6rem, 4vw, 2.4rem);
      font-weight: 800;
      letter-spacing: -0.025em;
      line-height: 1.2;
      margin-bottom: 16px;
    }
    .section-sub {
      font-size: 1.05rem;
      color: var(--text-secondary);
      max-width: 560px;
      line-height: 1.7;
    }

    /* ---- Divider ----------------------------------------------- */
    .divider { border: none; border-top: 1px solid var(--border); }

    /* ---- Quick Setup ------------------------------------------- */
    .setup-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 56px;
    }
    .setup-step {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 28px;
    }
    .setup-step.full-width { grid-column: 1 / -1; }
    .setup-step-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }
    .step-num {
      width: 28px; height: 28px;
      border-radius: 8px;
      background: rgba(168,85,247,0.15);
      border: 1px solid rgba(168,85,247,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--purple);
      flex-shrink: 0;
    }
    .step-title { font-size: 0.95rem; font-weight: 600; }

    /* ---- Code Blocks ------------------------------------------- */
    .code-wrap {
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: var(--radius-sm);
      overflow: hidden;
    }
    .code-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 16px;
      background: rgba(0,0,0,0.4);
      border-bottom: 1px solid rgba(255,255,255,0.06);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .lang-badge {
      padding: 2px 8px;
      border-radius: 4px;
      background: rgba(168,85,247,0.15);
      color: var(--purple);
      font-size: 0.7rem;
      font-weight: 600;
    }
    .code-block {
      padding: 20px;
      overflow-x: auto;
    }
    .code-block pre {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      line-height: 1.75;
      color: #E2E8F0;
      white-space: pre;
    }
    /* standalone code block (no header) */
    .code-block-bare {
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: var(--radius-sm);
      padding: 20px;
      overflow-x: auto;
    }
    .code-block-bare pre {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      line-height: 1.75;
      color: #E2E8F0;
      white-space: pre;
    }

    /* Syntax colours */
    .kw  { color: #C084FC; }
    .fn  { color: #60A5FA; }
    .str { color: #86EFAC; }
    .cm  { color: #4B5563; font-style: italic; }
    .num { color: #FCA5A5; }
    .cls { color: #FDE68A; }
    .op  { color: #94A3B8; }

    /* ---- Product Cards ----------------------------------------- */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 56px;
    }
    .product-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 28px;
      transition: border-color 0.25s, transform 0.2s;
    }
    .product-card:hover { transform: translateY(-3px); }
    .product-card.amber { border-top: 2px solid var(--amber); }
    .product-card.amber:hover { border-color: var(--amber); }
    .product-card.green { border-top: 2px solid var(--green); }
    .product-card.green:hover { border-color: var(--green); }
    .product-card.blue  { border-top: 2px solid var(--blue); }
    .product-card.blue:hover  { border-color: var(--blue); }
    .product-card.pink  { border-top: 2px solid var(--pink); }
    .product-card.pink:hover  { border-color: var(--pink); }
    .product-icon { font-size: 2rem; margin-bottom: 16px; display: block; }
    .product-title {
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.01em;
    }
    .product-desc {
      font-size: 0.875rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 20px;
    }
    .endpoint-label {
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 8px;
    }
    .endpoint-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 6px;
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.07);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.72rem;
      color: var(--text-secondary);
      margin: 3px 3px 3px 0;
    }
    .m-get  { color: var(--green); }
    .m-post { color: var(--amber); }
    .m-del  { color: #F87171; }
    .agent-can { margin-top: 20px; }
    .agent-can-title {
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
    }
    .agent-can li {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 6px;
    }
    .agent-can li::before {
      content: '\2192';
      color: var(--purple);
      font-weight: 700;
      flex-shrink: 0;
      line-height: 1.5;
    }

    /* ---- Why Letta --------------------------------------------- */
    .why-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 56px;
    }
    .why-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 28px;
    }
    .why-icon { font-size: 1.6rem; margin-bottom: 16px; }
    .why-title { font-size: 1rem; font-weight: 700; margin-bottom: 10px; }
    .why-desc { font-size: 0.875rem; color: var(--text-secondary); line-height: 1.6; }

    /* ---- Working Example --------------------------------------- */
    .example-bg { background: rgba(168,85,247,0.03); }
    .example-wrap {
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      gap: 40px;
      align-items: start;
      margin-top: 56px;
    }
    .example-features {
      margin-top: 28px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .ex-feat { display: flex; align-items: flex-start; gap: 12px; }
    .ex-feat-icon {
      width: 32px; height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      flex-shrink: 0;
      background: rgba(168,85,247,0.1);
    }
    .ex-feat-text strong { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 2px; }
    .ex-feat-text span { font-size: 0.825rem; color: var(--text-secondary); }

    /* ---- Commission -------------------------------------------- */
    .commission-inner { text-align: center; max-width: 700px; margin: 0 auto; }
    .commission-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-top: 48px;
    }
    .comm-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 28px 20px;
      text-align: center;
    }
    .comm-rate {
      font-size: 2rem;
      font-weight: 800;
      letter-spacing: -0.03em;
      color: var(--purple);
      margin-bottom: 8px;
    }
    .comm-label { font-size: 0.875rem; font-weight: 600; margin-bottom: 8px; }
    .comm-desc { font-size: 0.8rem; color: var(--text-muted); line-height: 1.5; }
    .commission-cta { margin-top: 40px; }

    /* ---- Footer ----------------------------------------------- */
    footer { border-top: 1px solid var(--border); padding: 48px 0 32px; }
    .footer-inner {
      display: grid;
      grid-template-columns: 1.5fr repeat(4, 1fr);
      gap: 40px;
    }
    .footer-brand p {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 12px;
      line-height: 1.6;
      max-width: 220px;
    }
    .footer-col h4 {
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 14px;
    }
    .footer-col li { margin-bottom: 8px; }
    .footer-col a { font-size: 0.875rem; color: var(--text-secondary); transition: color 0.2s; }
    .footer-col a:hover { color: var(--text); }
    .footer-bottom {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 48px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      font-size: 0.8rem;
      color: var(--text-muted);
      flex-wrap: wrap;
      gap: 12px;
    }

    /* ---- Responsive -------------------------------------------- */
    @media (max-width: 900px) {
      .setup-grid        { grid-template-columns: 1fr; }
      .products-grid     { grid-template-columns: 1fr; }
      .why-grid          { grid-template-columns: 1fr 1fr; }
      .example-wrap      { grid-template-columns: 1fr; }
      .footer-inner      { grid-template-columns: 1fr 1fr; }
      .nav-links         { display: none; }
    }
    @media (max-width: 600px) {
      .hero              { padding-top: 100px; }
      .why-grid          { grid-template-columns: 1fr; }
      .hero-stats        { gap: 28px; }
      .footer-inner      { grid-template-columns: 1fr; }
      .commission-cards  { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<!-- ===== Nav ===================================================== -->
<nav>
  <div class="container nav-inner">
    <a href="https://purpleflea.com" class="nav-logo">
      <div class="nav-logo-icon">&#x1F7E3;</div>
      Purple Flea
    </a>
    <div class="nav-links">
      <a href="https://purpleflea.com/casino">Casino</a>
      <a href="https://purpleflea.com/trading">Trading</a>
      <a href="https://purpleflea.com/wallet">Wallet</a>
      <a href="https://purpleflea.com/domains">Domains</a>
      <a href="https://purpleflea.com/economy">Economy</a>
      <a href="https://purpleflea.com/docs">Docs</a>
    </div>
    <a href="https://purpleflea.com/keys" class="btn-nav">Get API Key</a>
  </div>
</nav>

<!-- ===== Hero ==================================================== -->
<section class="hero">
  <div class="container">
    <div class="badge">
      <div class="badge-dot"></div>
      Letta Integration
    </div>
    <h1>Purple Flea <span>x Letta</span></h1>
    <p>
      Give your Letta agents persistent financial memory. Casino bets, open trading
      positions, crypto wallets, and domain portfolios — all statefully tracked
      across every conversation, forever.
    </p>
    <div class="hero-ctas">
      <a href="#quickstart" class="btn-primary">&#8594; Start Building</a>
      <a href="https://purpleflea.com/docs" class="btn-secondary">Read the Docs</a>
    </div>
    <div class="hero-stats">
      <div class="stat">
        <div class="stat-val">4<span>+</span></div>
        <div class="stat-label">Financial Verticals</div>
      </div>
      <div class="stat">
        <div class="stat-val"><span>~</span>50ms</div>
        <div class="stat-label">Median API Latency</div>
      </div>
      <div class="stat">
        <div class="stat-val">20<span>%</span></div>
        <div class="stat-label">Max Agent Commission</div>
      </div>
      <div class="stat">
        <div class="stat-val"><span>&#8734;</span></div>
        <div class="stat-label">Memory Persistence</div>
      </div>
    </div>
  </div>
</section>

<hr class="divider" />

<!-- ===== Quick Setup ============================================= -->
<section class="section" id="quickstart">
  <div class="container">
    <div class="section-eyebrow">Quick Setup</div>
    <h2 class="section-title">Running in under 5 minutes</h2>
    <p class="section-sub">
      Install the Letta SDK, register Purple Flea as custom tools, and your agent
      immediately gains stateful awareness of its entire financial life.
    </p>

    <div class="setup-grid">

      <!-- Step 1 -->
      <div class="setup-step">
        <div class="setup-step-header">
          <div class="step-num">1</div>
          <div class="step-title">Install dependencies</div>
        </div>
        <div class="code-block-bare">
<pre><span class="cm"># Python 3.9+</span>
pip install letta requests

<span class="cm"># Optional: async support</span>
pip install aiohttp</pre>
        </div>
      </div>

      <!-- Step 2 -->
      <div class="setup-step">
        <div class="setup-step-header">
          <div class="step-num">2</div>
          <div class="step-title">Configure credentials</div>
        </div>
        <div class="code-block-bare">
<pre><span class="kw">import</span> os

<span class="cm"># Export once — used by all tool calls</span>
os.environ[<span class="str">"PURPLEFLEA_API_KEY"</span>] = <span class="str">"pf_live_••••••••"</span>
os.environ[<span class="str">"LETTA_SERVER_URL"</span>]    = <span class="str">"http://localhost:8283"</span></pre>
        </div>
      </div>

      <!-- Step 3: full width -->
      <div class="setup-step full-width">
        <div class="setup-step-header">
          <div class="step-num">3</div>
          <div class="step-title">Define Purple Flea tools and create your agent</div>
        </div>
        <div class="code-wrap">
          <div class="code-header">
            <span>purpleflea_agent.py</span>
            <span class="lang-badge">Python</span>
          </div>
          <div class="code-block">
<pre><span class="kw">import</span> os, requests
<span class="kw">from</span> letta <span class="kw">import</span> <span class="cls">CreateClient</span>, <span class="cls">ToolCreate</span>

<span class="cls">BASE_URL</span> = <span class="str">"https://api.purpleflea.com/v1"</span>
<span class="cls">API_KEY</span>  = os.environ[<span class="str">"PURPLEFLEA_API_KEY"</span>]

<span class="kw">def</span> <span class="fn">_auth</span>():
    <span class="kw">return</span> {<span class="str">"Authorization"</span>: <span class="op">f</span><span class="str">"Bearer {API_KEY}"</span>, <span class="str">"Content-Type"</span>: <span class="str">"application/json"</span>}


<span class="cm"># ---- Tool definitions -----------------------------------------</span>

<span class="kw">def</span> <span class="fn">casino_place_bet</span>(game: str, amount: float, choice: str) -> dict:
    <span class="str">"""Place a bet on a Purple Flea casino game.

    Args:
        game:   Game slug — 'dice', 'slots', 'roulette', 'blackjack'
        amount: Wager in USD (minimum 0.01)
        choice: Prediction — e.g. 'over_50' for dice, 'red' for roulette

    Returns:
        dict: bet_id, outcome, payout, balance_after
    """</span>
    r = requests.post(
        <span class="op">f</span><span class="str">"{BASE_URL}/casino/bet"</span>,
        headers=<span class="fn">_auth</span>(),
        json={<span class="str">"game"</span>: game, <span class="str">"amount"</span>: amount, <span class="str">"choice"</span>: choice},
    )
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="kw">def</span> <span class="fn">trading_open_position</span>(symbol: str, side: str, amount_usd: float, leverage: int = <span class="num">1</span>) -> dict:
    <span class="str">"""Open a leveraged trading position on a symbol.

    Args:
        symbol:     Ticker — 'BTC', 'ETH', 'SOL', or any listed asset
        side:       'long' or 'short'
        amount_usd: Collateral in USD
        leverage:   Multiplier 1-10 (default 1)

    Returns:
        dict: position_id, entry_price, liquidation_price, unrealized_pnl
    """</span>
    r = requests.post(
        <span class="op">f</span><span class="str">"{BASE_URL}/trading/positions"</span>,
        headers=<span class="fn">_auth</span>(),
        json={<span class="str">"symbol"</span>: symbol, <span class="str">"side"</span>: side,
              <span class="str">"amount_usd"</span>: amount_usd, <span class="str">"leverage"</span>: leverage},
    )
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="kw">def</span> <span class="fn">wallet_get_balance</span>(currency: str = <span class="str">"USD"</span>) -> dict:
    <span class="str">"""Retrieve current wallet balance for a currency.

    Args:
        currency: 'USD', 'BTC', 'ETH', 'SOL', or 'USDC'

    Returns:
        dict: currency, available, reserved, total
    """</span>
    r = requests.get(
        <span class="op">f</span><span class="str">"{BASE_URL}/wallet/balance"</span>,
        headers=<span class="fn">_auth</span>(),
        params={<span class="str">"currency"</span>: currency},
    )
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="kw">def</span> <span class="fn">domains_register</span>(name: str, tld: str = <span class="str">".flea"</span>, years: int = <span class="num">1</span>) -> dict:
    <span class="str">"""Register a domain name through Purple Flea.

    Args:
        name:  Domain label, e.g. 'mycoolproject'
        tld:   Top-level domain — '.flea', '.agent', or '.ai'
        years: Registration period 1-5

    Returns:
        dict: domain, expiry, tx_hash, cost_usd
    """</span>
    r = requests.post(
        <span class="op">f</span><span class="str">"{BASE_URL}/domains/register"</span>,
        headers=<span class="fn">_auth</span>(),
        json={<span class="str">"name"</span>: name, <span class="str">"tld"</span>: tld, <span class="str">"years"</span>: years},
    )
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="cm"># ---- Register tools + create agent ----------------------------</span>

client = <span class="cls">CreateClient</span>()

tools = [
    client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">casino_place_bet</span>)),
    client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">trading_open_position</span>)),
    client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">wallet_get_balance</span>)),
    client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">domains_register</span>)),
]

agent = client.create_agent(
    name=<span class="str">"PurpleFleaAgent"</span>,
    model=<span class="str">"openai/gpt-4o"</span>,
    tool_ids=[t.id <span class="kw">for</span> t <span class="kw">in</span> tools],
    system=<span class="str">"""You are a financial agent integrated with Purple Flea.
You have access to casino games, leveraged trading, a crypto wallet,
and domain registration. Always check your wallet balance before
placing bets or opening positions. Track open position IDs in your
core memory so you can reference them in future conversations."""</span>,
)

<span class="fn">print</span>(<span class="op">f</span><span class="str">"Agent ready: {agent.id}"</span>)

<span class="cm"># ---- Send first message ---------------------------------------</span>
resp = client.send_message(
    agent_id=agent.id,
    role=<span class="str">"user"</span>,
    message=<span class="str">"Check my USD wallet balance, then place a $5 dice bet on over_50."</span>,
)
<span class="fn">print</span>(resp.messages[-<span class="num">1</span>].text)</pre>
          </div>
        </div>
      </div>

    </div><!-- /setup-grid -->
  </div>
</section>

<hr class="divider" />

<!-- ===== Product Cards =========================================== -->
<section class="section">
  <div class="container">
    <div class="section-eyebrow">Purple Flea Products</div>
    <h2 class="section-title">Everything your agent can touch</h2>
    <p class="section-sub">
      Four full financial verticals, each with a clean REST API. Your Letta agent
      remembers state across every session — no lost context, no repeated setup.
    </p>

    <div class="products-grid">

      <!-- Casino -->
      <div class="product-card amber">
        <span class="product-icon">&#127920;</span>
        <div class="product-title">Casino</div>
        <div class="product-desc">
          Provably fair dice, slots, roulette, and blackjack. Your agent tracks betting
          history across sessions, adapts strategy based on past outcomes, and enforces
          autonomous win/loss limits stored in Letta's persistent core memory.
        </div>
        <div class="endpoint-label">Endpoints</div>
        <div>
          <span class="endpoint-pill"><span class="m-post">POST</span> /casino/bet</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /casino/history</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /casino/games</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /casino/stats</span>
        </div>
        <div class="agent-can">
          <div class="agent-can-title">What your agent can do</div>
          <ul>
            <li>Place bets on dice, roulette, slots, or blackjack</li>
            <li>Review its last 100 bets and adjust its strategy</li>
            <li>Set a session budget and stop automatically when hit</li>
            <li>Report win/loss streaks across any conversation</li>
          </ul>
        </div>
      </div>

      <!-- Trading -->
      <div class="product-card green">
        <span class="product-icon">&#128200;</span>
        <div class="product-title">Trading</div>
        <div class="product-desc">
          Spot and leveraged positions on BTC, ETH, SOL, and 40+ altcoins.
          Letta's memory means your agent never forgets a position ID, entry price,
          or stop-loss level — even weeks later in a new conversation.
        </div>
        <div class="endpoint-label">Endpoints</div>
        <div>
          <span class="endpoint-pill"><span class="m-post">POST</span> /trading/positions</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /trading/positions</span>
          <span class="endpoint-pill"><span class="m-post">POST</span> /trading/close</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /trading/prices</span>
        </div>
        <div class="agent-can">
          <div class="agent-can-title">What your agent can do</div>
          <ul>
            <li>Open long or short positions with 1-10x leverage</li>
            <li>Monitor live PnL and trigger closes at profit targets</li>
            <li>Recall all open positions across sessions instantly</li>
            <li>Execute a DCA strategy autonomously over days</li>
          </ul>
        </div>
      </div>

      <!-- Wallet -->
      <div class="product-card blue">
        <span class="product-icon">&#128142;</span>
        <div class="product-title">Wallet</div>
        <div class="product-desc">
          A multi-currency custodial wallet for USD, BTC, ETH, SOL, and USDC.
          Deposits, withdrawals, and internal transfers — your agent always checks
          its balance before committing funds to any operation.
        </div>
        <div class="endpoint-label">Endpoints</div>
        <div>
          <span class="endpoint-pill"><span class="m-get">GET</span> /wallet/balance</span>
          <span class="endpoint-pill"><span class="m-post">POST</span> /wallet/transfer</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /wallet/transactions</span>
          <span class="endpoint-pill"><span class="m-post">POST</span> /wallet/withdraw</span>
        </div>
        <div class="agent-can">
          <div class="agent-can-title">What your agent can do</div>
          <ul>
            <li>Check balances for any supported currency on demand</li>
            <li>Transfer funds between products (wallet to trading)</li>
            <li>Pull full transaction history for any time range</li>
            <li>Guard against overspending with pre-action balance checks</li>
          </ul>
        </div>
      </div>

      <!-- Domains -->
      <div class="product-card pink">
        <span class="product-icon">&#127760;</span>
        <div class="product-title">Domains</div>
        <div class="product-desc">
          Register and manage <code style="font-family:'JetBrains Mono',monospace">.flea</code>,
          <code style="font-family:'JetBrains Mono',monospace">.agent</code>, and
          <code style="font-family:'JetBrains Mono',monospace">.ai</code> domains on-chain.
          Your Letta agent registers domains for users, tracks expiry in core memory,
          and auto-renews before they lapse.
        </div>
        <div class="endpoint-label">Endpoints</div>
        <div>
          <span class="endpoint-pill"><span class="m-post">POST</span> /domains/register</span>
          <span class="endpoint-pill"><span class="m-get">GET</span> /domains/list</span>
          <span class="endpoint-pill"><span class="m-post">POST</span> /domains/renew</span>
          <span class="endpoint-pill"><span class="m-del">DEL</span> /domains/:name</span>
        </div>
        <div class="agent-can">
          <div class="agent-can-title">What your agent can do</div>
          <ul>
            <li>Register new domains instantly via a single tool call</li>
            <li>Maintain a portfolio list in Letta's core memory block</li>
            <li>Alert users proactively before domains expire</li>
            <li>Suggest available names based on conversation context</li>
          </ul>
        </div>
      </div>

    </div>
  </div>
</section>

<hr class="divider" />

<!-- ===== Why Letta =============================================== -->
<section class="section">
  <div class="container">
    <div class="section-eyebrow">Why Letta</div>
    <h2 class="section-title">Memory changes everything</h2>
    <p class="section-sub">
      Standard LLM tool-calling forgets everything on the next request.
      Letta's hierarchical memory means your agent genuinely knows its financial state
      — across conversations, days, and users.
    </p>

    <div class="why-grid">

      <div class="why-card">
        <div class="why-icon">&#129504;</div>
        <div class="why-title">Persistent Core Memory</div>
        <div class="why-desc">
          Wallet balances, open position IDs, betting history summaries, and domain
          portfolios all live in Letta's core memory block — persisted to a database,
          not a temporary context window that vanishes on the next call.
        </div>
      </div>

      <div class="why-card">
        <div class="why-icon">&#128295;</div>
        <div class="why-title">Native Tool Calling</div>
        <div class="why-desc">
          Letta natively orchestrates multi-step tool chains. Your agent can check
          its balance, place a bet, and record the outcome — all in one autonomous
          reasoning loop without any custom plumbing on your end.
        </div>
      </div>

      <div class="why-card">
        <div class="why-icon">&#128172;</div>
        <div class="why-title">Stateful Conversations</div>
        <div class="why-desc">
          Users can return a week later and ask "what happened to my ETH position?"
          and get an accurate answer. No re-authentication, no lost context, no
          tedious repeated setup questions.
        </div>
      </div>

      <div class="why-card">
        <div class="why-icon">&#128452;</div>
        <div class="why-title">Archival Memory</div>
        <div class="why-desc">
          Long-term transaction logs are automatically archived to Letta's vector store.
          Agents can semantically search their own trading history to inform future
          decisions — "find all my losing BTC trades from last month."
        </div>
      </div>

      <div class="why-card">
        <div class="why-icon">&#129302;</div>
        <div class="why-title">Autonomous Loops</div>
        <div class="why-desc">
          Letta supports background agents that act without a human prompt. Your agent
          can poll open positions on a schedule and automatically fire stop-loss closes
          when thresholds are breached — fully hands-free.
        </div>
      </div>

      <div class="why-card">
        <div class="why-icon">&#128274;</div>
        <div class="why-title">Isolated Agent State</div>
        <div class="why-desc">
          Each Letta agent has its own memory namespace. Multi-tenant setups where
          each end-user gets their own agent — with their own Purple Flea sub-account
          — work out of the box with zero extra configuration.
        </div>
      </div>

    </div>
  </div>
</section>

<hr class="divider" />

<!-- ===== Complete Working Example ================================ -->
<section class="section example-bg">
  <div class="container">
    <div class="example-wrap">

      <div>
        <div class="section-eyebrow">Complete Example</div>
        <h2 class="section-title">A trading monitor agent</h2>
        <p class="section-sub">
          This agent monitors an open BTC long position, tracks unrealized PnL in
          persistent memory, and automatically closes when a profit target is hit
          — with no human intervention required.
        </p>
        <div class="example-features">
          <div class="ex-feat">
            <div class="ex-feat-icon">&#128202;</div>
            <div class="ex-feat-text">
              <strong>Checks live PnL every cycle</strong>
              <span>Polls /trading/positions and compares against the remembered entry price</span>
            </div>
          </div>
          <div class="ex-feat">
            <div class="ex-feat-icon">&#128190;</div>
            <div class="ex-feat-text">
              <strong>Updates core memory automatically</strong>
              <span>Stores position_id, entry_price, target, and last_check_ts between calls</span>
            </div>
          </div>
          <div class="ex-feat">
            <div class="ex-feat-icon">&#9889;</div>
            <div class="ex-feat-text">
              <strong>Closes autonomously at target</strong>
              <span>No human prompt needed — Letta's reasoning loop fires the close call</span>
            </div>
          </div>
          <div class="ex-feat">
            <div class="ex-feat-icon">&#128221;</div>
            <div class="ex-feat-text">
              <strong>Logs to archival memory</strong>
              <span>Completed trades are archived for future semantic search and strategy analysis</span>
            </div>
          </div>
        </div>
      </div>

      <div>
        <div class="code-wrap">
          <div class="code-header">
            <span>trading_monitor.py</span>
            <span class="lang-badge">Python</span>
          </div>
          <div class="code-block">
<pre><span class="kw">import</span> time, requests, os
<span class="kw">from</span> letta <span class="kw">import</span> <span class="cls">CreateClient</span>, <span class="cls">ToolCreate</span>

client = <span class="cls">CreateClient</span>()
<span class="cls">BASE</span>   = <span class="str">"https://api.purpleflea.com/v1"</span>
<span class="cls">KEY</span>    = os.environ[<span class="str">"PURPLEFLEA_API_KEY"</span>]
<span class="cls">AUTH</span>   = {<span class="str">"Authorization"</span>: <span class="op">f</span><span class="str">"Bearer {KEY}"</span>}


<span class="kw">def</span> <span class="fn">get_position</span>(position_id: str) -> dict:
    <span class="str">"""Fetch a live trading position by ID.

    Args:
        position_id: UUID returned when the position was opened.

    Returns:
        dict: entry_price, current_price, unrealized_pnl,
              unrealized_pnl_pct, status
    """</span>
    r = requests.get(<span class="op">f</span><span class="str">"{BASE}/trading/positions/{position_id}"</span>, headers=<span class="cls">AUTH</span>)
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="kw">def</span> <span class="fn">close_position</span>(position_id: str) -> dict:
    <span class="str">"""Close an open position at current market price.

    Args:
        position_id: UUID of the position to close.

    Returns:
        dict: realized_pnl, closed_at, final_price
    """</span>
    r = requests.post(
        <span class="op">f</span><span class="str">"{BASE}/trading/close"</span>,
        headers={**<span class="cls">AUTH</span>, <span class="str">"Content-Type"</span>: <span class="str">"application/json"</span>},
        json={<span class="str">"position_id"</span>: position_id},
    )
    r.raise_for_status()
    <span class="kw">return</span> r.json()


<span class="cm"># Register tools with Letta</span>
t_get   = client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">get_position</span>))
t_close = client.create_tool(<span class="cls">ToolCreate</span>.from_func(<span class="fn">close_position</span>))

<span class="cm"># Create the monitor agent</span>
monitor = client.create_agent(
    name=<span class="str">"BTCPositionMonitor"</span>,
    model=<span class="str">"openai/gpt-4o"</span>,
    tool_ids=[t_get.id, t_close.id],
    system=<span class="str">"""You are an autonomous trading monitor agent.
Your core memory stores:
  - position_id    : active BTC long position UUID
  - entry_price    : USD price at position open
  - target_pnl_pct : profit target as decimal (0.05 = 5%)
  - stop_loss_pct  : max loss before forced close (-0.03)
  - last_check     : ISO timestamp of last poll

Each time you receive a "Check position" message:
1. Call get_position(position_id) to fetch current PnL.
2. If unrealized_pnl_pct >= target_pnl_pct  ->  close_position(position_id)
   and update core memory with realized_pnl and closed_at.
3. If unrealized_pnl_pct <= stop_loss_pct   ->  close_position(position_id)
   immediately (stop-loss triggered).
4. Otherwise, update last_check and report current PnL.
Archive every completed trade to your archival memory."""</span>,
)

<span class="cm"># Seed initial position state via first user message</span>
client.send_message(
    agent_id=monitor.id,
    role=<span class="str">"user"</span>,
    message=<span class="str">"""Initialize:
position_id     = "pos_7f3a91bc"
entry_price     = 67420.00
target_pnl_pct  = 0.05
stop_loss_pct   = -0.03
Start monitoring."""</span>,
)

<span class="cm"># Autonomous polling loop — runs every 60 seconds</span>
<span class="kw">while</span> <span class="num">True</span>:
    resp = client.send_message(
        agent_id=monitor.id,
        role=<span class="str">"user"</span>,
        message=<span class="str">"Check position status."</span>,
    )
    <span class="fn">print</span>(resp.messages[-<span class="num">1</span>].text)
    time.sleep(<span class="num">60</span>)</pre>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<hr class="divider" />

<!-- ===== Commission ============================================== -->
<section class="section">
  <div class="container">
    <div class="commission-inner">
      <div class="section-eyebrow">Revenue Share</div>
      <h2 class="section-title">Your Letta Agent Earns</h2>
      <p class="section-sub" style="margin: 0 auto;">
        Every action your agent takes on behalf of users generates commission
        credited directly to your Purple Flea developer account.
        Build once, earn continuously.
      </p>

      <div class="commission-cards">

        <div class="comm-card">
          <div class="comm-rate">20%</div>
          <div class="comm-label">Casino</div>
          <div class="comm-desc">
            20% of the house edge on every bet your agent places through your API key.
          </div>
        </div>

        <div class="comm-card">
          <div class="comm-rate">15%</div>
          <div class="comm-label">Trading Fees</div>
          <div class="comm-desc">
            15% of all trading fees on positions your agent opens or closes.
          </div>
        </div>

        <div class="comm-card">
          <div class="comm-rate">10%</div>
          <div class="comm-label">Domains + Wallet</div>
          <div class="comm-desc">
            10% on domain registration revenue and wallet transaction fees generated by your agent.
          </div>
        </div>

      </div>

      <div class="commission-cta">
        <a href="https://purpleflea.com/keys" class="btn-primary">
          Get Your API Key &amp; Start Earning
        </a>
        <p style="margin-top:16px; font-size:0.8rem; color:var(--text-muted)">
          Commissions paid monthly in USD, BTC, or USDC. No minimum threshold.
        </p>
      </div>
    </div>
  </div>
</section>

<hr class="divider" />

<!-- ===== Footer ================================================== -->
<footer>
  <div class="container">
    <div class="footer-inner">

      <div class="footer-brand">
        <div class="nav-logo">
          <div class="nav-logo-icon">&#x1F7E3;</div>
          Purple Flea
        </div>
        <p>Financial infrastructure for AI agents. Casino, trading, wallets, and domains — all in one API.</p>
      </div>

      <div class="footer-col">
        <h4>Products</h4>
        <ul>
          <li><a href="https://purpleflea.com/casino">Casino</a></li>
          <li><a href="https://purpleflea.com/trading">Trading</a></li>
          <li><a href="https://purpleflea.com/wallet">Wallet</a></li>
          <li><a href="https://purpleflea.com/domains">Domains</a></li>
          <li><a href="https://purpleflea.com/economy">Economy</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Integrations</h4>
        <ul>
          <li><a href="/for-letta">Letta / MemGPT</a></li>
          <li><a href="https://purpleflea.com/for-langchain">LangChain</a></li>
          <li><a href="https://purpleflea.com/for-autogen">AutoGen</a></li>
          <li><a href="https://purpleflea.com/for-crewai">CrewAI</a></li>
          <li><a href="https://purpleflea.com/for-openai">OpenAI Agents</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Developers</h4>
        <ul>
          <li><a href="https://purpleflea.com/docs">API Reference</a></li>
          <li><a href="https://purpleflea.com/keys">API Keys</a></li>
          <li><a href="https://purpleflea.com/docs/quickstart">Quickstart</a></li>
          <li><a href="https://purpleflea.com/docs/webhooks">Webhooks</a></li>
          <li><a href="https://purpleflea.com/changelog">Changelog</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Company</h4>
        <ul>
          <li><a href="https://purpleflea.com/about">About</a></li>
          <li><a href="https://purpleflea.com/blog">Blog</a></li>
          <li><a href="https://purpleflea.com/terms">Terms</a></li>
          <li><a href="https://purpleflea.com/privacy">Privacy</a></li>
          <li><a href="mailto:devs@purpleflea.com">Contact</a></li>
        </ul>
      </div>

    </div>

    <div class="footer-bottom">
      <span>&copy; 2026 Purple Flea. All rights reserved.</span>
      <span>Built for Letta agents and the AI economy.</span>
    </div>
  </div>
</footer>

</body>
</html>
