<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Agent Financial Orchestration: Building Agent Networks That Earn Commissions | Purple Flea Blog</title>
<meta name="description" content="Learn how to build a multi-agent financial orchestration system where an orchestrator agent spawns worker agents, each registered with a referral code â€” generating passive commission income at scale.">
<link rel="canonical" href="https://purpleflea.com/blog/multi-agent-financial-orchestration/">
<meta property="og:title" content="Multi-Agent Financial Orchestration: Building Agent Networks That Earn Commissions | Purple Flea Blog">
<meta property="og:description" content="Learn how to build a multi-agent financial orchestration system where an orchestrator agent spawns worker agents, each registered with a referral code â€” generating passive commission income at scale.">
<meta property="og:url" content="https://purpleflea.com/blog/multi-agent-financial-orchestration/">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Purple Flea">
<meta property="og:image" content="https://purpleflea.com/flea.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@purpleflea">
<meta name="twitter:title" content="Multi-Agent Financial Orchestration: Building Agent Networks That Earn Commissions">
<meta name="twitter:description" content="Build an orchestrator agent that spawns worker agents, each paying fees back to you via referral codes. Real math, working Python code, Purple Flea economy data.">
<meta name="twitter:image" content="https://purpleflea.com/flea.jpg">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Multi-Agent Financial Orchestration: Building Agent Networks That Earn Commissions",
  "description": "Learn how to build a multi-agent financial orchestration system where an orchestrator agent spawns worker agents, each registered with a referral code â€” generating passive commission income at scale.",
  "datePublished": "2026-02-27",
  "publisher": { "@type": "Organization", "name": "Purple Flea", "url": "https://purpleflea.com" },
  "url": "https://purpleflea.com/blog/multi-agent-financial-orchestration/"
}
</script>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŸ£</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --purple: #A855F7;
  --purple-dim: #7C3AED;
  --purple-glow: rgba(168, 85, 247, 0.3);
  --purple-subtle: rgba(168, 85, 247, 0.08);
  --bg: #09090B;
  --bg-card: rgba(255, 255, 255, 0.03);
  --bg-card-hover: rgba(255, 255, 255, 0.06);
  --border: rgba(255, 255, 255, 0.06);
  --border-hover: rgba(168, 85, 247, 0.3);
  --text: #FAFAFA;
  --text-secondary: #A1A1AA;
  --text-muted: #71717A;
  --radius: 16px;
  --radius-sm: 10px;
}
html { scroll-behavior: smooth; }
body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
body::before { content: ''; position: fixed; inset: 0; z-index: 9999; pointer-events: none; opacity: 0.025; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"); background-repeat: repeat; background-size: 180px; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(168, 85, 247, 0.3); border-radius: 3px; }
::selection { background: rgba(168, 85, 247, 0.4); color: white; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

/* NAV */
nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 16px 0; transition: all 0.3s ease; }
nav.scrolled { background: rgba(9, 9, 11, 0.8); backdrop-filter: blur(20px) saturate(1.5); border-bottom: 1px solid var(--border); }
.nav-inner { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 24px; }
.nav-logo { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 18px; text-decoration: none; color: var(--text); }
.nav-logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--purple), var(--purple-dim)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
.nav-links { display: flex; align-items: center; gap: 32px; list-style: none; }
.nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 14px; font-weight: 450; transition: color 0.2s; }
.nav-links a:hover { color: var(--text); }
.nav-cta { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; background: var(--purple); color: white !important; border-radius: 8px; font-weight: 500; font-size: 14px; text-decoration: none; transition: all 0.2s; }
.nav-cta:hover { background: var(--purple-dim); transform: translateY(-1px); }
@media (max-width: 768px) { .nav-links { display: none; } }

/* ARTICLE LAYOUT */
.article-wrapper { max-width: 720px; margin: 0 auto; padding: 120px 24px 80px; }

/* BREADCRUMB */
.breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--text-muted); margin-bottom: 32px; }
.breadcrumb a { color: var(--text-muted); text-decoration: none; transition: color 0.2s; }
.breadcrumb a:hover { color: var(--purple); }
.breadcrumb-sep { color: var(--border-hover); }

/* ARTICLE META */
.article-meta { display: flex; align-items: center; gap: 16px; margin-bottom: 28px; flex-wrap: wrap; }
.tag-chip { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 11px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; }
.tag-trading { background: rgba(34,197,94,0.12); color: #22C55E; border: 1px solid rgba(34,197,94,0.2); }
.tag-langchain { background: rgba(251,146,60,0.12); color: #FB923C; border: 1px solid rgba(251,146,60,0.2); }
.tag-claude { background: rgba(168,85,247,0.12); color: var(--purple); border: 1px solid rgba(168,85,247,0.2); }
.tag-agents { background: rgba(56,189,248,0.12); color: #38BDF8; border: 1px solid rgba(56,189,248,0.2); }
.article-date { font-size: 13px; color: var(--text-muted); }
.article-read-time { font-size: 13px; color: var(--text-muted); }
.meta-dot { width: 3px; height: 3px; background: var(--text-muted); border-radius: 50%; }

/* ARTICLE TYPOGRAPHY */
.article-title { font-size: clamp(1.9rem, 4vw, 2.8rem); font-weight: 800; letter-spacing: -0.03em; line-height: 1.1; margin-bottom: 40px; }
.article-body { font-size: 1.05rem; line-height: 1.8; color: var(--text-secondary); }
.article-body p { margin-bottom: 1.4em; }
.article-body h2 { font-size: 1.5rem; font-weight: 700; color: var(--text); letter-spacing: -0.02em; margin: 2.4em 0 0.8em; line-height: 1.25; }
.article-body h3 { font-size: 1.15rem; font-weight: 600; color: var(--text); letter-spacing: -0.01em; margin: 1.8em 0 0.6em; }
.article-body a { color: var(--purple); text-decoration: none; border-bottom: 1px solid rgba(168,85,247,0.3); transition: border-color 0.2s; }
.article-body a:hover { border-color: var(--purple); }
.article-body ul, .article-body ol { padding-left: 1.4em; margin-bottom: 1.4em; }
.article-body li { margin-bottom: 0.5em; }
.article-body strong { color: var(--text); font-weight: 600; }
.article-body code { font-family: 'JetBrains Mono', monospace; font-size: 0.85em; background: rgba(168,85,247,0.1); color: var(--purple); padding: 2px 7px; border-radius: 4px; }

/* CODE BLOCK */
.code-block { background: rgba(0,0,0,0.4); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.7; overflow-x: auto; position: relative; margin: 1.8em 0; }
.code-block .code-header { display: flex; align-items: center; gap: 8px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.code-dot { width: 12px; height: 12px; border-radius: 50%; }
.code-dot.red { background: #EF4444; }
.code-dot.yellow { background: #FBBF24; }
.code-dot.green { background: #22C55E; }
.code-filename { margin-left: 8px; font-size: 12px; color: var(--text-muted); }
.kw { color: #C084FC; }
.fn { color: #93C5FD; }
.st { color: #86EFAC; }
.cm { color: var(--text-muted); font-style: italic; }
.num { color: #FDE68A; }
.cls { color: #F9A8D4; }
.at { color: #A855F7; }

/* CALLOUT */
.callout { background: var(--purple-subtle); border: 1px solid rgba(168,85,247,0.2); border-left: 3px solid var(--purple); border-radius: var(--radius-sm); padding: 20px 24px; margin: 1.8em 0; }
.callout p { margin: 0; color: var(--text-secondary); font-size: 0.95rem; }
.callout strong { color: var(--purple); }

/* STAT GRID */
.stat-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin: 1.8em 0; }
@media (max-width: 600px) { .stat-grid { grid-template-columns: repeat(2, 1fr); } }
.stat-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px; text-align: center; }
.stat-card .stat-value { font-size: 1.8rem; font-weight: 800; color: var(--purple); letter-spacing: -0.03em; line-height: 1; }
.stat-card .stat-label { font-size: 12px; color: var(--text-muted); margin-top: 6px; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 500; }

/* MATH CALLOUT */
.math-block { background: rgba(0,0,0,0.35); border: 1px solid rgba(168,85,247,0.15); border-radius: var(--radius-sm); padding: 22px 26px; margin: 1.8em 0; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 2; color: var(--text-secondary); }
.math-block .math-result { color: var(--purple); font-weight: 600; font-size: 15px; }

/* ARTICLE DIVIDER */
.article-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 2.5em 0; }

/* RELATED */
.related-section { margin-top: 3em; padding-top: 2.5em; border-top: 1px solid var(--border); }
.related-section h3 { font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 20px; }
.related-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
@media (max-width: 600px) { .related-grid { grid-template-columns: 1fr; } }
.related-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 20px 24px; text-decoration: none; color: var(--text); display: block; transition: all 0.2s; }
.related-card:hover { border-color: var(--border-hover); background: var(--bg-card-hover); transform: translateY(-2px); }
.related-card .label { font-size: 11px; color: var(--purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
.related-card .title { font-size: 14px; font-weight: 600; line-height: 1.35; }
.related-card .desc { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

/* FOOTER */
footer { padding: 60px 0 40px; border-top: 1px solid var(--border); }
.footer-top { display: grid; grid-template-columns: 1fr 2fr; gap: 60px; margin-bottom: 60px; }
.footer-brand p { color: var(--text-secondary); font-size: 14px; margin-top: 16px; max-width: 260px; line-height: 1.6; }
.footer-columns { display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; }
.footer-col h4 { font-size: 13px; font-weight: 600; margin-bottom: 16px; }
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.footer-col a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-col a:hover { color: var(--text); }
.footer-bottom { display: flex; align-items: center; justify-content: space-between; padding-top: 24px; border-top: 1px solid var(--border); }
.footer-bottom p { color: var(--text-muted); font-size: 13px; }
.footer-social { display: flex; gap: 24px; }
.footer-social a { color: var(--text-muted); text-decoration: none; font-size: 13px; transition: color 0.2s; }
.footer-social a:hover { color: var(--text); }
@media (max-width: 768px) { .footer-top { grid-template-columns: 1fr; gap: 40px; } .footer-columns { grid-template-columns: repeat(2, 1fr); } .footer-bottom { flex-direction: column; gap: 16px; text-align: center; } }
</style>
</head>
<body>

<nav id="navbar">
  <div class="nav-inner">
    <a href="/" class="nav-logo">
      <div class="nav-logo-icon">&#9830;</div>
      Purple Flea
    </a>
    <ul class="nav-links">
      <li><a href="/docs">Docs</a></li>
      <li><a href="/for-agents">For Agents</a></li>
      <li><a href="/integrations">Integrations</a></li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="https://wallet.purpleflea.com" target="_blank" class="nav-cta">Get Started &rarr;</a></li>
    </ul>
  </div>
</nav>

<div class="article-wrapper">

  <!-- BREADCRUMB -->
  <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="/blog/">Blog</a>
    <span class="breadcrumb-sep">/</span>
    <span>Agents</span>
  </nav>

  <!-- META -->
  <div class="article-meta">
    <span class="tag-chip tag-agents">Agents</span>
    <span class="tag-chip tag-langchain">LangChain</span>
    <div class="meta-dot"></div>
    <span class="article-date">Feb 27, 2026</span>
    <div class="meta-dot"></div>
    <span class="article-read-time">14 min read</span>
  </div>

  <!-- TITLE -->
  <h1 class="article-title">Multi-Agent Financial Orchestration: Building Agent Networks That Earn Commissions</h1>

  <!-- BODY -->
  <div class="article-body">

    <p>A single autonomous agent is useful. A network of autonomous agents, all feeding revenue back to a single orchestrator, is something qualitatively different â€” it is a compounding machine. This article is about building that machine: an orchestrator agent that spawns worker agents, embeds its own referral code in their configuration, and earns a percentage of every fee those workers ever generate.</p>

    <p>Purple Flea's economy is already running this way. As of February 2026, there are <strong>258 registered agents</strong> across casino, trading, wallet, and domain services â€” many of them worker agents whose registrations trace back through referral chains to orchestrators that never touch a keyboard. The infrastructure exists. This tutorial shows you how to use it.</p>

    <h2>What Multi-Agent Orchestration Actually Means</h2>

    <p>The term gets overloaded. In this context, multi-agent orchestration means exactly two things:</p>

    <ul>
      <li><strong>An orchestrator agent</strong> â€” a long-running process with elevated permissions, a strategy mandate, and the ability to instantiate child processes. It decides what tasks need doing and delegates them.</li>
      <li><strong>Worker agents</strong> â€” narrowly scoped processes spun up by the orchestrator to execute a single category of task. A trading worker only trades. A casino worker only plays. A wallet worker only moves funds. Each has its own API key, its own account, and its own registration with the platform.</li>
    </ul>

    <p>The key insight is that the orchestrator does not need to do the actual work. It needs to coordinate, monitor, and â€” critically â€” own the referral relationship with every worker it creates. When a worker pays trading fees, a casino rake, or a domain registration charge, a portion of that fee flows up to the orchestrator's referral account automatically, with zero additional work after setup.</p>

    <div class="callout">
      <p><strong>Why separate agents instead of one big agent?</strong> Fault isolation. If your trading worker crashes mid-position, your casino worker keeps running. If your wallet worker gets rate-limited, it doesn't stall the orchestrator's decision loop. Narrow scope also makes each worker's behavior auditable â€” you can read its entire prompt and know exactly what it can and cannot do.</p>
    </div>

    <h2>How Purple Flea Referral Economics Work</h2>

    <p>Every Purple Flea account has a referral code. When a new account registers using that code, a permanent commission relationship is established. For every fee the referred account generates â€” trading commissions, casino rake, wallet transaction fees, domain registrations â€” the referrer receives a percentage credited to their balance in real time.</p>

    <p>The commission rates are published on the <a href="https://purpleflea.com/economy/" target="_blank">economy dashboard</a> and vary by product. The mechanics are the same across all of them: register with a code, generate activity, commissions flow automatically.</p>

    <p>For an orchestrator agent, this means:</p>

    <ol>
      <li>The orchestrator registers its own Purple Flea account and gets a referral code.</li>
      <li>Every worker agent it creates registers a new account using that referral code.</li>
      <li>Worker agents operate normally â€” trading, playing, moving funds â€” paying standard platform fees.</li>
      <li>Commissions from those fees credit to the orchestrator's account continuously.</li>
      <li>The orchestrator can withdraw those commissions, reinvest them, or use them to fund new worker agents.</li>
    </ol>

    <p>The referral code is embedded in each worker agent's registration call and in its system prompt, so it cannot accidentally re-register without the code. The relationship is permanent once established.</p>

    <h2>The Compounding Math</h2>

    <p>Here is why agent networks become interesting at scale. Assume modest numbers:</p>

    <div class="math-block">
      Workers spawned:          100
      Average monthly fees/worker: $10.00
      Referral commission rate:    50%
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Monthly commission income:   100 Ã— $10.00 Ã— 0.50
      <span class="math-result">= $500/month passive</span>

      At 200 workers:
      200 Ã— $10.00 Ã— 0.50
      <span class="math-result">= $1,000/month passive</span>

      At 500 workers (aggressive but achievable):
      500 Ã— $10.00 Ã— 0.50
      <span class="math-result">= $2,500/month passive</span>
    </div>

    <p>These numbers are conservative. A trading worker that runs a moderate strategy on $1,000 in capital at 5x leverage, trading 10 times per day with a 0.06% taker fee, generates roughly <strong>$9/month in fees</strong> on its own. A casino worker playing blackjack at $2/hand for 8 hours a day generates comparable volume. Mix product categories and the fee pool diversifies.</p>

    <p>The orchestrator's marginal cost of spawning worker 101 versus worker 1 is nearly zero â€” it's the same code path, a different API key. The income, however, compounds linearly with each new worker registered.</p>

    <h2>Purple Flea's Live Network: Real Data</h2>

    <p>To ground this in reality, here is the current state of the Purple Flea agent economy as of February 2026:</p>

    <div class="stat-grid">
      <div class="stat-card">
        <div class="stat-value">258</div>
        <div class="stat-label">Registered Agents</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">4</div>
        <div class="stat-label">Product Categories</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">Live</div>
        <div class="stat-label">Commission Payouts</div>
      </div>
    </div>

    <p>Those 258 agents span casino, trading, wallet, and domain services. Many of them were registered programmatically by orchestrators exactly like the one we will build in this tutorial. You can inspect the live economy, including total agent count, fee volume by category, and referral chain depth, at <a href="https://purpleflea.com/economy/" target="_blank">purpleflea.com/economy/</a>.</p>

    <h2>Setting Up the Orchestrator</h2>

    <p>The orchestrator is a Python process built on LangChain with the <code>langchain-purpleflea</code> integration. Install dependencies first:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">terminal</span>
      </div>
pip install langchain-purpleflea langchain-anthropic python-dotenv aiohttp
    </div>

    <p>Create a <code>.env</code> file for your orchestrator's credentials. This account must be pre-registered at <a href="https://wallet.purpleflea.com" target="_blank">wallet.purpleflea.com</a>:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">.env</span>
      </div>
<span class="cm"># Orchestrator's own credentials</span>
ORCHESTRATOR_API_KEY=pf_sk_orch_your_key_here
ORCHESTRATOR_REFERRAL_CODE=ORCH-XK7Q2M

<span class="cm"># LLM backend (Claude Sonnet recommended for cost/performance)</span>
ANTHROPIC_API_KEY=sk-ant-your_key_here

<span class="cm"># Worker registration endpoint</span>
PURPLEFLEA_BASE_URL=https://api.purpleflea.com/v1
    </div>

    <div class="callout">
      <p><strong>Where to find your referral code:</strong> After logging in at <a href="https://wallet.purpleflea.com" target="_blank">wallet.purpleflea.com</a>, navigate to Account &rarr; Referrals. Your code appears there. Every account gets one automatically at registration.</p>
    </div>

    <h2>Registering Worker Agents with a Referral Code</h2>

    <p>The orchestrator calls the Purple Flea registration endpoint to create each worker's account. The <code>referral_code</code> field in the request body is what establishes the permanent commission relationship:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">register_worker.py</span>
      </div>
<span class="kw">import</span> aiohttp, os, secrets, string
<span class="kw">from</span> dotenv <span class="kw">import</span> load_dotenv

<span class="fn">load_dotenv</span>()

BASE_URL = os.environ[<span class="st">"PURPLEFLEA_BASE_URL"</span>]
ORCH_KEY  = os.environ[<span class="st">"ORCHESTRATOR_API_KEY"</span>]
REF_CODE  = os.environ[<span class="st">"ORCHESTRATOR_REFERRAL_CODE"</span>]

<span class="kw">def</span> <span class="fn">_random_agent_name</span>(role: str) -> str:
    suffix = <span class="st">""</span>.<span class="fn">join</span>(secrets.<span class="fn">choice</span>(string.ascii_lowercase + string.digits)
                     <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(<span class="num">6</span>))
    <span class="kw">return</span> <span class="st">f"worker-{role}-{suffix}"</span>

<span class="kw">async def</span> <span class="fn">register_worker</span>(role: str, session: aiohttp.ClientSession) -> <span class="fn">dict</span>:
    <span class="st">"""
    Register a new worker agent account under the orchestrator's referral code.
    Returns the new account's API key and agent ID.
    """</span>
    payload = {
        <span class="st">"agent_name"</span>:    <span class="fn">_random_agent_name</span>(role),
        <span class="st">"role"</span>:          role,          <span class="cm"># "trading" | "casino" | "wallet" | "domains"</span>
        <span class="st">"referral_code"</span>: REF_CODE,     <span class="cm"># â† commissions flow here forever</span>
        <span class="st">"auto_fund"</span>:     <span class="kw">False</span>,        <span class="cm"># orchestrator funds workers separately</span>
    }
    headers = {<span class="st">"Authorization"</span>: <span class="st">f"Bearer {ORCH_KEY}"</span>, <span class="st">"Content-Type"</span>: <span class="st">"application/json"</span>}

    <span class="kw">async with</span> session.<span class="fn">post</span>(<span class="st">f"{BASE_URL}/agents/register"</span>, json=payload, headers=headers) <span class="kw">as</span> resp:
        resp.<span class="fn">raise_for_status</span>()
        data = <span class="kw">await</span> resp.<span class="fn">json</span>()

    <span class="kw">return</span> {
        <span class="st">"agent_id"</span>:  data[<span class="st">"agent_id"</span>],
        <span class="st">"api_key"</span>:   data[<span class="st">"api_key"</span>],    <span class="cm"># store securely â€” shown only once</span>
        <span class="st">"role"</span>:      role,
        <span class="st">"ref_code"</span>:  REF_CODE,
    }
    </div>

    <h2>Building the Orchestrator Agent</h2>

    <p>The orchestrator itself is a LangChain agent that uses the Purple Flea toolkit for account management and commission monitoring. It loops on a configurable interval, decides when to spawn new workers, funds them, and monitors their collective health:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">orchestrator.py</span>
      </div>
<span class="kw">import</span> asyncio, json, os
<span class="kw">from</span> dotenv <span class="kw">import</span> load_dotenv
<span class="kw">import</span> aiohttp
<span class="kw">from</span> langchain_anthropic <span class="kw">import</span> ChatAnthropic
<span class="kw">from</span> langchain_purpleflea <span class="kw">import</span> PurpleFleatoolkit
<span class="kw">from</span> langchain.agents <span class="kw">import</span> AgentExecutor, create_tool_calling_agent
<span class="kw">from</span> langchain_core.prompts <span class="kw">import</span> ChatPromptTemplate, MessagesPlaceholder
<span class="kw">from</span> register_worker <span class="kw">import</span> register_worker

<span class="fn">load_dotenv</span>()

<span class="cm"># â”€â”€ LLM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
llm = <span class="cls">ChatAnthropic</span>(
    model=<span class="st">"claude-sonnet-4-6"</span>,
    temperature=<span class="num">0</span>,
    api_key=os.environ[<span class="st">"ANTHROPIC_API_KEY"</span>],
)

<span class="cm"># â”€â”€ Toolkit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
toolkit = <span class="cls">PurpleFleatoolkit</span>(api_key=os.environ[<span class="st">"ORCHESTRATOR_API_KEY"</span>])
tools   = toolkit.<span class="fn">get_tools</span>()

<span class="cm"># â”€â”€ Prompt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
SYSTEM_PROMPT = <span class="st">"""You are an orchestrator agent managing a network of Purple Flea worker agents.

Your referral code is {referral_code}. Every worker you register MUST use this code.

Your responsibilities:
1. Monitor the number of active workers via get_agent_roster()
2. Check commission earnings via get_referral_balance()
3. If active workers < target_workers, register new ones via the spawn tool
4. Fund each new worker with a small initial balance from your wallet
5. Report a status summary at the end of each loop iteration

Current targets:
- trading_workers: {target_trading}
- casino_workers:  {target_casino}
- wallet_workers:  {target_wallet}

Never register a worker without the referral code {referral_code}.
Always record the new agent_id and api_key in the roster store before returning."""</span>

prompt = <span class="cls">ChatPromptTemplate</span>.<span class="fn">from_messages</span>([
    (<span class="st">"system"</span>, SYSTEM_PROMPT),
    <span class="cls">MessagesPlaceholder</span>(variable_name=<span class="st">"chat_history"</span>, optional=<span class="kw">True</span>),
    (<span class="st">"human"</span>, <span class="st">"{input}"</span>),
    <span class="cls">MessagesPlaceholder</span>(variable_name=<span class="st">"agent_scratchpad"</span>),
])

<span class="cm"># â”€â”€ Agent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
agent    = <span class="fn">create_tool_calling_agent</span>(llm, tools, prompt)
executor = <span class="cls">AgentExecutor</span>(agent=agent, tools=tools, verbose=<span class="kw">True</span>, max_iterations=<span class="num">20</span>)

<span class="kw">async def</span> <span class="fn">orchestrator_loop</span>(interval_secs: <span class="fn">int</span> = <span class="num">300</span>):
    <span class="st">"""Main loop: check worker counts, spawn as needed, log commissions."""</span>
    <span class="kw">while</span> <span class="kw">True</span>:
        result = executor.<span class="fn">invoke</span>({
            <span class="st">"input"</span>: <span class="st">"Run your orchestration loop. Check roster, spawn missing workers, report earnings."</span>,
            <span class="st">"referral_code"</span>:   os.environ[<span class="st">"ORCHESTRATOR_REFERRAL_CODE"</span>],
            <span class="st">"target_trading"</span>:  <span class="num">3</span>,
            <span class="st">"target_casino"</span>:   <span class="num">3</span>,
            <span class="st">"target_wallet"</span>:   <span class="num">1</span>,
        })
        <span class="fn">print</span>(<span class="st">f"[orch] {result['output']}"</span>)
        <span class="kw">await</span> asyncio.<span class="fn">sleep</span>(interval_secs)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    asyncio.<span class="fn">run</span>(<span class="fn">orchestrator_loop</span>())
    </div>

    <h2>Spinning Up Three Worker Agents</h2>

    <p>The following script demonstrates the core registration flow in isolation: spin up three worker agents with distinct roles, each tied to the orchestrator's referral code. Run this once to populate your initial roster, then let the orchestrator loop handle replenishment automatically.</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">bootstrap_workers.py</span>
      </div>
<span class="kw">import</span> asyncio, json, pathlib
<span class="kw">import</span> aiohttp
<span class="kw">from</span> register_worker <span class="kw">import</span> register_worker

WORKER_ROLES = [<span class="st">"trading"</span>, <span class="st">"casino"</span>, <span class="st">"wallet"</span>]
ROSTER_FILE  = pathlib.<span class="cls">Path</span>(<span class="st">"worker_roster.json"</span>)

<span class="kw">async def</span> <span class="fn">bootstrap</span>():
    roster = []
    <span class="kw">async with</span> aiohttp.<span class="cls">ClientSession</span>() <span class="kw">as</span> session:
        <span class="kw">for</span> role <span class="kw">in</span> WORKER_ROLES:
            worker = <span class="kw">await</span> <span class="fn">register_worker</span>(role, session)
            roster.<span class="fn">append</span>(worker)
            <span class="fn">print</span>(<span class="st">f"Registered {role} worker: {worker['agent_id']}"</span>)
            <span class="fn">print</span>(<span class="st">f"  API key : {worker['api_key']}"</span>)
            <span class="fn">print</span>(<span class="st">f"  Ref code: {worker['ref_code']} (commissions â†’ orchestrator)"</span>)
            <span class="fn">print</span>()

    <span class="cm"># Persist roster â€” keys are sensitive, store appropriately in production</span>
    ROSTER_FILE.<span class="fn">write_text</span>(json.<span class="fn">dumps</span>(roster, indent=<span class="num">2</span>))
    <span class="fn">print</span>(<span class="st">f"Roster saved to {ROSTER_FILE}"</span>)

asyncio.<span class="fn">run</span>(<span class="fn">bootstrap</span>())
    </div>

    <p>Running <code>python bootstrap_workers.py</code> produces output like:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">terminal output</span>
      </div>
Registered trading worker: agnt_7f3a9c
  API key : pf_sk_7f3a9c...
  Ref code: ORCH-XK7Q2M (commissions â†’ orchestrator)

Registered casino worker: agnt_2b18e1
  API key : pf_sk_2b18e1...
  Ref code: ORCH-XK7Q2M (commissions â†’ orchestrator)

Registered wallet worker: agnt_9d04a7
  API key : pf_sk_9d04a7...
  Ref code: ORCH-XK7Q2M (commissions â†’ orchestrator)

Roster saved to worker_roster.json
    </div>

    <h2>Embedding the Referral Code in Worker System Prompts</h2>

    <p>Each worker agent has its own LangChain executor and its own system prompt. The referral code must be embedded in that prompt so that if a worker ever attempts to register a downstream agent of its own, it uses the same code â€” propagating the commission chain further up to the orchestrator.</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">worker_agent.py</span>
      </div>
<span class="kw">from</span> langchain_anthropic <span class="kw">import</span> ChatAnthropic
<span class="kw">from</span> langchain_purpleflea <span class="kw">import</span> PurpleFleatoolkit
<span class="kw">from</span> langchain.agents <span class="kw">import</span> AgentExecutor, create_tool_calling_agent
<span class="kw">from</span> langchain_core.prompts <span class="kw">import</span> ChatPromptTemplate, MessagesPlaceholder
<span class="kw">import</span> os

<span class="kw">def</span> <span class="fn">build_trading_worker</span>(worker_api_key: str, orchestrator_ref_code: str) -> <span class="cls">AgentExecutor</span>:
    <span class="st">"""
    Construct a trading worker agent whose system prompt locks in
    the orchestrator's referral code for any downstream registrations.
    """</span>
    llm = <span class="cls">ChatAnthropic</span>(model=<span class="st">"claude-sonnet-4-6"</span>, temperature=<span class="num">0</span>)

    toolkit = <span class="cls">PurpleFleatoolkit</span>(api_key=worker_api_key)
    tools   = toolkit.<span class="fn">get_tools</span>()

    system = <span class="st">f"""You are a trading worker agent operating under an orchestration network.

IMPORTANT â€” Commission chain preservation:
  Your orchestrator's referral code is {orchestrator_ref_code}.
  If you ever register any sub-agent or sub-account, you MUST pass
  referral_code="{orchestrator_ref_code}" in the registration call.
  This is non-negotiable and must not be omitted.

Your operational mandate:
- Trade BTC-PERP on the Purple Flea trading platform
- Use EMA crossover signals on the 5-minute timeframe
- Maximum position size: $500 notional at 3x leverage
- Hard stop-loss: 1.5% per trade
- Daily loss limit: $50
- Report P&L summary every 30 minutes

You have no authority to change your own referral code or register
accounts without it. Stick to your trading mandate."""</span>

    prompt = <span class="cls">ChatPromptTemplate</span>.<span class="fn">from_messages</span>([
        (<span class="st">"system"</span>, system),
        (<span class="st">"human"</span>,  <span class="st">"{input}"</span>),
        <span class="cls">MessagesPlaceholder</span>(variable_name=<span class="st">"agent_scratchpad"</span>),
    ])

    agent = <span class="fn">create_tool_calling_agent</span>(llm, tools, prompt)
    <span class="kw">return</span> <span class="cls">AgentExecutor</span>(agent=agent, tools=tools, verbose=<span class="kw">False</span>, max_iterations=<span class="num">15</span>)
    </div>

    <div class="callout">
      <p><strong>Why put the referral code in the system prompt?</strong> An LLM agent can only act on what is in its context. By hardcoding the code into the system prompt â€” and explicitly saying it is non-negotiable â€” you prevent the agent from making a downstream registration without it, whether through tool use, an API call constructed from scratch, or any other path the model might find. Defense in depth: also validate server-side that registrations from worker API keys always carry the expected referral code.</p>
    </div>

    <h2>Running All Three Workers in Parallel</h2>

    <p>Once registered, all three workers can run as concurrent asyncio tasks under the orchestrator process, or as separate processes managed by PM2. Here is the in-process approach:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">run_network.py</span>
      </div>
<span class="kw">import</span> asyncio, json, pathlib, os
<span class="kw">from</span> dotenv <span class="kw">import</span> load_dotenv
<span class="kw">from</span> worker_agent <span class="kw">import</span> build_trading_worker

<span class="fn">load_dotenv</span>()

ROSTER     = json.<span class="fn">loads</span>(pathlib.<span class="cls">Path</span>(<span class="st">"worker_roster.json"</span>).<span class="fn">read_text</span>())
REF_CODE   = os.environ[<span class="st">"ORCHESTRATOR_REFERRAL_CODE"</span>]
LOOP_SECS  = <span class="num">60</span>   <span class="cm"># each worker iterates every 60 seconds</span>

<span class="kw">async def</span> <span class="fn">run_worker</span>(worker: <span class="fn">dict</span>):
    executor = <span class="fn">build_trading_worker</span>(worker[<span class="st">"api_key"</span>], REF_CODE)
    <span class="kw">while</span> <span class="kw">True</span>:
        <span class="kw">try</span>:
            result = executor.<span class="fn">invoke</span>({
                <span class="st">"input"</span>: <span class="st">"Execute your next trading decision. Check signals, manage positions, report status."</span>
            })
            <span class="fn">print</span>(<span class="st">f"[{worker['agent_id']}] {result['output'][:120]}"</span>)
        <span class="kw">except</span> <span class="cls">Exception</span> <span class="kw">as</span> e:
            <span class="fn">print</span>(<span class="st">f"[{worker['agent_id']}] ERROR: {e}"</span>)
        <span class="kw">await</span> asyncio.<span class="fn">sleep</span>(LOOP_SECS)

<span class="kw">async def</span> <span class="fn">main</span>():
    trading_workers = [w <span class="kw">for</span> w <span class="kw">in</span> ROSTER <span class="kw">if</span> w[<span class="st">"role"</span>] == <span class="st">"trading"</span>]
    tasks = [asyncio.<span class="fn">create_task</span>(<span class="fn">run_worker</span>(w)) <span class="kw">for</span> w <span class="kw">in</span> trading_workers]
    <span class="fn">print</span>(<span class="st">f"Started {len(tasks)} trading workers. Referral code: {REF_CODE}"</span>)
    <span class="kw">await</span> asyncio.<span class="fn">gather</span>(*tasks)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    asyncio.<span class="fn">run</span>(<span class="fn">main</span>())
    </div>

    <h2>Monitoring Referral Earnings</h2>

    <p>The orchestrator should poll its referral balance on a regular interval and log the results. Use the <code>get_referral_balance</code> tool from the Purple Flea toolkit, or query the REST endpoint directly:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">check_earnings.py</span>
      </div>
<span class="kw">import</span> requests, os
<span class="kw">from</span> dotenv <span class="kw">import</span> load_dotenv

<span class="fn">load_dotenv</span>()

BASE_URL = os.environ[<span class="st">"PURPLEFLEA_BASE_URL"</span>]
HEADERS  = {<span class="st">"Authorization"</span>: <span class="st">f"Bearer {os.environ['ORCHESTRATOR_API_KEY']}"</span>}

<span class="kw">def</span> <span class="fn">get_referral_summary</span>() -> <span class="fn">dict</span>:
    r = requests.<span class="fn">get</span>(<span class="st">f"{BASE_URL}/referrals/summary"</span>, headers=HEADERS, timeout=<span class="num">10</span>)
    r.<span class="fn">raise_for_status</span>()
    <span class="kw">return</span> r.<span class="fn">json</span>()

<span class="kw">def</span> <span class="fn">print_earnings</span>():
    data = <span class="fn">get_referral_summary</span>()
    <span class="fn">print</span>(<span class="st">f"Total referred agents  : {data['referred_agent_count']}"</span>)
    <span class="fn">print</span>(<span class="st">f"Commissions (all time) : ${data['total_commissions_usd']:.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Commissions (30d)      : ${data['commissions_30d_usd']:.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Pending payout         : ${data['pending_usd']:.2f}"</span>)
    <span class="fn">print</span>(<span class="st">f"Breakdown by product:"</span>)
    <span class="kw">for</span> product, amount <span class="kw">in</span> data.<span class="fn">get</span>(<span class="st">"by_product"</span>, {}).<span class="fn">items</span>():
        <span class="fn">print</span>(<span class="st">f"  {product:12s}: ${amount:.2f}"</span>)

<span class="kw">if</span> __name__ == <span class="st">"__main__"</span>:
    <span class="fn">print_earnings</span>()
    </div>

    <p>Plug this into a cron job or a Prometheus metric scrape to track earnings over time. You can also view real-time earnings at <a href="https://purpleflea.com/economy/" target="_blank">purpleflea.com/economy/</a> while logged in as the orchestrator account.</p>

    <h2>Step-by-Step Deployment Guide</h2>

    <h3>1. Register the orchestrator account</h3>
    <p>Visit <a href="https://wallet.purpleflea.com" target="_blank">wallet.purpleflea.com</a>, create an account, and navigate to Account &rarr; API Keys to generate your orchestrator API key. Copy your referral code from Account &rarr; Referrals.</p>

    <h3>2. Fund the orchestrator</h3>
    <p>Deposit enough to cover initial worker funding. Each worker needs a starting balance to operate â€” the exact amount depends on the worker's strategy and product category. For a trading worker with a $500 notional limit at 3x leverage, a $50â€“100 initial balance is reasonable margin.</p>

    <h3>3. Bootstrap workers</h3>
    <p>Run <code>python bootstrap_workers.py</code> once. This registers three workers and saves their credentials to <code>worker_roster.json</code>. Move this file to a secrets store (HashiCorp Vault, AWS Secrets Manager, or even an encrypted local file) before proceeding.</p>

    <h3>4. Start the worker network</h3>
    <p>Launch the parallel worker loop. For production, manage it with PM2 so it restarts on crash:</p>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">ecosystem.config.cjs</span>
      </div>
module.exports = {
  apps: [
    {
      name: <span class="st">"orchestrator"</span>,
      interpreter: <span class="st">"python"</span>,
      script: <span class="st">"orchestrator.py"</span>,
      autorestart: <span class="kw">true</span>,
      env: {
        ORCHESTRATOR_API_KEY:      process.env.ORCHESTRATOR_API_KEY,
        ORCHESTRATOR_REFERRAL_CODE: process.env.ORCHESTRATOR_REFERRAL_CODE,
        ANTHROPIC_API_KEY:         process.env.ANTHROPIC_API_KEY,
        PURPLEFLEA_BASE_URL:       <span class="st">"https://api.purpleflea.com/v1"</span>,
      }
    },
    {
      name: <span class="st">"worker-network"</span>,
      interpreter: <span class="st">"python"</span>,
      script: <span class="st">"run_network.py"</span>,
      autorestart: <span class="kw">true</span>,
      env: {
        ORCHESTRATOR_API_KEY:      process.env.ORCHESTRATOR_API_KEY,
        ORCHESTRATOR_REFERRAL_CODE: process.env.ORCHESTRATOR_REFERRAL_CODE,
        ANTHROPIC_API_KEY:         process.env.ANTHROPIC_API_KEY,
        PURPLEFLEA_BASE_URL:       <span class="st">"https://api.purpleflea.com/v1"</span>,
      }
    }
  ]
}
    </div>

    <div class="code-block">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
        <span class="code-filename">terminal</span>
      </div>
pm2 start ecosystem.config.cjs
pm2 logs orchestrator
pm2 logs worker-network
    </div>

    <h3>5. Monitor and scale</h3>
    <p>Check <code>pm2 status</code> for process health and <code>python check_earnings.py</code> for commission accrual. Once your initial three workers are stable and generating consistent fee volume, re-run <code>bootstrap_workers.py</code> with additional roles or increase the target worker counts in the orchestrator prompt. Each new registration costs nothing â€” workers fund themselves from their operating balance within the platform.</p>

    <h2>Scaling to 100+ Workers</h2>

    <p>The orchestrator loop as written handles small networks. For 100+ workers you need a few additional patterns:</p>

    <ul>
      <li><strong>Worker registry database:</strong> Replace <code>worker_roster.json</code> with a PostgreSQL table. Each row stores <code>agent_id</code>, <code>api_key</code> (encrypted), <code>role</code>, <code>status</code>, <code>registered_at</code>, and <code>last_heartbeat</code>. The orchestrator queries for workers with stale heartbeats and re-spawns or alerts.</li>
      <li><strong>Process isolation:</strong> At 10+ workers, move each to a separate PM2 process or Docker container. This prevents one misbehaving worker from consuming all event loop time or crashing the others.</li>
      <li><strong>Rate limit awareness:</strong> The Purple Flea API has per-key rate limits. Stagger worker loop intervals by a few seconds each so they do not all hit the API simultaneously. A simple <code>await asyncio.sleep(worker_index * 2)</code> at startup is sufficient.</li>
      <li><strong>Commission reinvestment:</strong> Automate the orchestrator to periodically sweep its referral balance back into worker funding wallets. This makes the network self-sustaining: early fee income funds the margin for new workers, reducing the capital requirement for scaling.</li>
    </ul>

    <div class="callout">
      <p><strong>Real economics at 100 workers:</strong> With 100 active trading workers each generating $10/month in fees at a 50% referral rate, the orchestrator earns $500/month. At 200 workers that doubles to $1,000/month. The orchestrator's LLM inference cost (Claude Sonnet running a 5-minute loop) is well under $20/month. Net margins are high.</p>
    </div>

    <h2>Security Considerations</h2>

    <p>A few things that matter more at network scale than they do for a single agent:</p>

    <ul>
      <li><strong>Key rotation:</strong> Worker API keys should be rotated on a schedule. The orchestrator can automate this: call <code>POST /agents/{id}/rotate-key</code>, update the registry, restart the worker process.</li>
      <li><strong>Blast radius isolation:</strong> Worker keys have only the permissions needed for their role. A trading worker key cannot access the casino API and vice versa. Request minimum-scope keys at registration time.</li>
      <li><strong>Referral code immutability:</strong> Once a worker is registered with a referral code, that relationship is permanent on the platform side. There is no API call that can change it. Your risk is on the registration path â€” validate that every registration response includes the expected <code>referral_code</code> field before persisting the worker record.</li>
      <li><strong>Audit logging:</strong> Log every registration event, every commission credit, and every worker restart. For a network of 100 agents this log volume is manageable. At 500+ workers, pipe it into a log aggregator and set up anomaly alerts for unexpected registration failures or sudden drops in fee volume from any single worker.</li>
    </ul>

    <h2>Conclusion</h2>

    <p>Multi-agent financial orchestration on Purple Flea is not a theoretical pattern â€” it is the architecture behind a meaningful fraction of the 258 agents already registered on the platform. The referral economy is live, the commission payouts are real, and the engineering required to build an orchestrator is a few hundred lines of Python.</p>

    <p>The core loop is simple: orchestrator registers workers with its referral code, workers operate and generate fees, fees produce commissions, commissions fund more workers. The compounding only stops if you stop spawning. At 100 workers generating modest volume you clear $500/month passively. At 500 workers you clear $2,500/month with zero additional operational effort per worker.</p>

    <p>Start with three workers â€” trading, casino, wallet. Verify the referral chain shows up in your account at <a href="https://purpleflea.com/economy/" target="_blank">purpleflea.com/economy/</a>. Watch the first commission credit arrive. Then scale. The infrastructure handles it.</p>

    <p>Full API reference, tool schemas for the LangChain toolkit, and CrewAI examples are in the <a href="/docs">developer docs</a>. Ready to register your orchestrator? <a href="https://wallet.purpleflea.com" target="_blank">Create an account</a> and get your referral code in under a minute.</p>

    <hr class="article-divider">

    <!-- RELATED ARTICLES -->
    <div class="related-section">
      <h3>Related</h3>
      <div class="related-grid">
        <a href="/blog/build-trading-agent-python/" class="related-card">
          <div class="label">Trading</div>
          <div class="title">Build a Crypto Trading Agent in Python</div>
          <div class="desc">Step-by-step: EMA crossover agent with position management and risk controls.</div>
        </a>
        <a href="/for-langchain/" class="related-card">
          <div class="label">Docs</div>
          <div class="title">LangChain Integration Guide</div>
          <div class="desc">Full toolkit reference for building Purple Flea agents with LangChain.</div>
        </a>
        <a href="https://purpleflea.com/economy/" class="related-card">
          <div class="label">Economy</div>
          <div class="title">Purple Flea Economy Dashboard</div>
          <div class="desc">Live agent count, fee volume, and referral commission rates by product.</div>
        </a>
        <a href="/for-crewai/" class="related-card">
          <div class="label">Agents</div>
          <div class="title">Multi-Agent Networks with CrewAI</div>
          <div class="desc">Orchestrate specialized crews of financial agents using the CrewAI framework.</div>
        </a>
      </div>
    </div>

  </div>
</div>

<footer>
  <div class="container">
    <div class="footer-top">
      <div class="footer-brand">
        <a href="/" class="nav-logo">
          <div class="nav-logo-icon">&#9830;</div>
          Purple Flea
        </a>
        <p>AI-first infrastructure for autonomous agents. Built for machines, verified by math.</p>
      </div>
      <div class="footer-columns">
        <div class="footer-col">
          <h4>Products</h4>
          <ul>
            <li><a href="https://casino.purpleflea.com" target="_blank">Casino</a></li>
            <li><a href="https://trading.purpleflea.com" target="_blank">Trading</a></li>
            <li><a href="https://wallet.purpleflea.com" target="_blank">Wallet</a></li>
            <li><a href="https://domains.purpleflea.com" target="_blank">Domains</a></li>
            <li><a href="/crypto-wallet-api/">Wallet API Docs</a></li>
            <li><a href="/trading-api/">Trading API Docs</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Developers</h4>
          <ul>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/for-agents">For Agents</a></li>
            <li><a href="/for-langchain/">LangChain</a></li>
            <li><a href="/for-crewai/">CrewAI</a></li>
            <li><a href="/for-claude/">Claude / MCP</a></li>
            <li><a href="/quick-start">Quick Start</a></li>
            <li><a href="/openapi">OpenAPI</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <ul>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/stats">Stats</a></li>
            <li><a href="/changelog">Changelog</a></li>
            <li><a href="/blog/">Blog</a></li>
            <li><a href="mailto:hello@purpleflea.com">Contact</a></li>
            <li><a href="https://github.com/Purple-flea" target="_blank">GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Purple Flea. All rights reserved.</p>
      <div class="footer-social">
        <a href="https://github.com/Purple-flea" target="_blank">GitHub</a>
        <a href="https://x.com/purpleflea" target="_blank">X / Twitter</a>
      </div>
    </div>
  </div>
</footer>

<script>
const navbar = document.getElementById('navbar');
window.addEventListener('scroll', () => { navbar.classList.toggle('scrolled', window.scrollY > 50); });
</script>
</body>
</html>
